
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r));return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(s){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(a[a.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(a[a.length]=r);return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n)x.access(e,t,a,n[a],!0,o,s)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(u=t.nodeType)&&9!==u)return[];if(h&&!i){if(o=K.exec(e))if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode)return r;if(s.id===a)return r.push(s),r}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a)return r.push(s),r}else{if(o[2])return O.apply(r,t.getElementsByTagName(e)),r;if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName)return O.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--)f[l]=m+mt(f[l]);x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w)try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},S=f.compareDocumentPosition?function(e,r){if(e===r)return E=!0,0;var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n)return E=!0,0;if(!o||!s)return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0;if(o===s)return ct(e,n);r=e;while(r=r.parentNode)a.unshift(r);r=n;while(r=r.parentNode)u.unshift(r);while(a[i]===u[i])i++;return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g])if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}else if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w)f=l[1];else while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--)i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pt(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ft(t);function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter)!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,a))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--)(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}else y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return!s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++)if(n=i.relative[e[l].type])f=[yt(vt(f),n)];else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++)if(i.relative[e[r].type])break;return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++])if(m(d,l,c)){f.push(d);break}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++])m(b,y,l,c);if(a){if(v>0)while(x--)b[x]||y[x]||(y[x]=q.call(f));y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--)o=wt(t[n]),o[v]?r.push(o):i.push(o);o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return r;e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type])break;if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e)return O.apply(r,o),r;break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++)if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1)a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return!a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1)for(a=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i;return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(x.isEmptyObject(o))x.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined)this.cache[o]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++)r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]));q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--)n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--)r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set"in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--)u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c));s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)x.event.remove(e,h+t[l],n,r,!0);x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped())t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++)a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++)a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++)n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++)yt(o[r],s[r]);if(t)if(n)for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++)gt(o[r],s[r]);else gt(e,a);return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++)if(i=e[c],i||0===i)if("object"===x.type(i))x.merge(h,i.nodeType?[i]:i);else if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--)o=o.lastChild;x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else h.push(t.createTextNode(i));f.textContent="",c=0;while(i=h[c++])if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++])at.test(i.type||"")&&n.push(i)}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length)for(s=0;(i=r[s])!==undefined;s++)a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)x.event.add(t,i,l[i][n])}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++)r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++)o[t[s]]=x.css(e,t[s],!1,r);return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get"in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2)"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)));return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=o[r]||o[r-2]||o[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i))o[t[1].toLowerCase()]=t[2]}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)g[t]=[g[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v)return T;u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)T.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v))return T.abort();b="abort";for(l in{success:1,error:1,complete:1})T[l](c[l]);if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,x.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++)if(r=i[o].call(n,t,e))return r}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++)if(r=kn[o].call(l,e,c,l.opts))return r;return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;f=!0}c[r]=h&&h[r]||x.style(e,r)}if(!x.isEmptyObject(c)){h?"hidden"in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Cn.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s)return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);
;;;
(function(M,T,p){'use strict';function lc(){var b=M.angular;M.angular=mc;return b}function Xa(b){return!b||typeof b.length!=="number"?!1:typeof b.hasOwnProperty!="function"&&typeof b.constructor!="function"?!0:b instanceof R||ga&&b instanceof ga||Ea.call(b)!=="[object Object]"||typeof b.callee==="function"}function n(b,a,c){var d;if(b)if(H(b))for(d in b)d!="prototype"&&d!="length"&&d!="name"&&b.hasOwnProperty(d)&&a.call(c,b[d],d);else if(b.forEach&&b.forEach!==n)b.forEach(a,c);else if(Xa(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function qb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function nc(b,a,c){for(var d=qb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function rb(b){return function(a,c){b(c,a)}}function Fa(){for(var b=ba.length,a;b;){b--;a=ba[b].charCodeAt(0);if(a==57)return ba[b]="A",ba.join("");if(a==90)ba[b]="0";else return ba[b]=String.fromCharCode(a+1),ba.join("")}ba.unshift("0");return ba.join("")}function sb(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function t(b){var a=b.$$hashKey;n(arguments,function(a){a!==b&&n(a,function(a,c){b[c]=a})});sb(b,a);return b}function N(b){return parseInt(b,10)}function tb(b,a){return t(new(t(function(){},{prototype:b})),a)}function q(){}function qa(b){return b}function S(b){return function(){return b}}function C(b){return typeof b=="undefined"}function B(b){return typeof b!="undefined"}function L(b){return b!=null&&typeof b=="object"}function E(b){return typeof b=="string"}function Ya(b){return typeof b=="number"}function ra(b){return Ea.apply(b)=="[object Date]"}function F(b){return Ea.apply(b)=="[object Array]"}function H(b){return typeof b=="function"}function sa(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function U(b){return E(b)?b.replace(/^\s*/,"").replace(/\s*$/,""):b}function oc(b){return b&&(b.nodeName||b.bind&&b.find)}function Za(b,a,c){var d=[];n(b,function(b,g,i){d.push(a.call(c,b,g,i))});return d}function Ga(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function ta(b,a){var c=Ga(b,a);c>=0&&b.splice(c,1);return a}function V(b,a){if(sa(b)||b&&b.$evalAsync&&b.$watch)throw Error("Can't copy Window or Scope");if(a){if(b===a)throw Error("Can't copy equivalent objects or arrays");if(F(b))for(var c=a.length=0;c<b.length;c++)a.push(V(b[c]));else{c=a.$$hashKey;n(a,function(b,c){delete a[c]});for(var d in b)a[d]=V(b[d]);sb(a,c)}}else(a=b)&&(F(b)?a=V(b,[]):ra(b)?a=new Date(b.getTime()):L(b)&&(a=V(b,{})));return a}function pc(b,a){var a=a||{},c;for(c in b)b.hasOwnProperty(c)&&c.substr(0,2)!=="$$"&&(a[c]=b[c]);return a}function ia(b,a){if(b===a)return!0;if(b===null||a===null)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&c=="object")if(F(b)){if((c=b.length)==a.length){for(d=0;d<c;d++)if(!ia(b[d],a[d]))return!1;return!0}}else if(ra(b))return ra(a)&&b.getTime()==a.getTime();else{if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||sa(b)||sa(a))return!1;c={};for(d in b)if(!(d.charAt(0)==="$"||H(b[d]))){if(!ia(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c[d]&&d.charAt(0)!=="$"&&a[d]!==p&&!H(a[d]))return!1;return!0}return!1}function $a(b,a){var c=arguments.length>2?ka.call(arguments,2):[];return H(a)&&!(a instanceof RegExp)?c.length?function(){return arguments.length?a.apply(b,c.concat(ka.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}:a}function qc(b,a){var c=a;/^\$+/.test(b)?c=p:sa(a)?c="$WINDOW":a&&T===a?c="$DOCUMENT":a&&a.$evalAsync&&

a.$watch&&(c="$SCOPE");return c}function ha(b,a){return JSON.stringify(b,qc,a?"  ":null)}function ub(b){return E(b)?JSON.parse(b):b}function ua(b){b&&b.length!==0?(b=I(""+b),b=!(b=="f"||b=="0"||b=="false"||b=="no"||b=="n"||b=="[]")):b=!1;return b}function va(b){b=w(b).clone();try{b.html("")}catch(a){}var c=w("<div>").append(b).html();try{return b[0].nodeType===3?I(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+I(b)})}catch(d){return I(c)}}function vb(b){var a={},c,d;n((b||"").split("&"),function(b){b&&(c=b.split("="),d=decodeURIComponent(c[0]),a[d]=B(c[1])?decodeURIComponent(c[1]):!0)});return a}function wb(b){var a=[];n(b,function(b,d){a.push(wa(d,!0)+(b===!0?"":"="+wa(b,!0)))});return a.length?a.join("&"):""}function ab(b){return wa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function wa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function rc(b,a){function c(a){a&&d.push(a)}var d=[b],e,g,i=["ng:app","ng-app","x-ng-app","data-ng-app"],f=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;n(i,function(a){i[a]=!0;c(T.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(n(b.querySelectorAll("."+a),c),n(b.querySelectorAll("."+a+"\\:"),c),n(b.querySelectorAll("["+a+"]"),c))});n(d,function(a){if(!e){var b=f.exec(" "+a.className+" ");b?(e=a,g=(b[2]||"").replace(/\s+/g,",")):n(a.attributes,function(b){if(!e&&i[b.name])e=a,g=b.value})}});e&&a(e,g?[g]:[])}
function xb(b,a){var c=function(){b=w(b);a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);a.unshift("ng");var c=yb(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animator",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)});e.enabled(!0)}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(M&&!d.test(M.name))return c();M.name=M.name.replace(d,"");Ha.resumeBootstrap=function(b){n(b,function(b){a.push(b)});c()}}function bb(b,a){a=a||"_";return b.replace(sc,function(b,d){return(d?a:"")+b.toLowerCase()})}function cb(b,a,c){if(!b)throw Error("Argument '"+(a||"?")+"' is "+(c||"required"));return b}function xa(b,a,c){c&&F(b)&&(b=b[b.length-1]);cb(H(b),a,"not a function, got "+(b&&typeof b=="object"?b.constructor.name||"Object":typeof b));return b}function tc(b){function a(a,b,e){return a[b]||(a[b]=e())}return a(a(b,"angular",Object),"module",function(){var b={};return function(d,e,g){e&&b.hasOwnProperty(d)&&(b[d]=null);return a(b,d,function(){function a(c,d,e){return function(){b[e||"push"]([c,d,arguments]);return m}}if(!e)throw Error("No module: "+d);var b=[],c=[],j=a("$injector","invoke"),m={_invokeQueue:b,_runBlocks:c,requires:e,name:d,provider:a("$provide","provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animationProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:j,run:function(a){c.push(a);return this}};g&&j(g);return m})}})}function Ia(b){return b.replace(uc,function(a,b,d,e){return e?d.toUpperCase():d}).replace(vc,"Moz$1")}function db(b,a){function c(){var e;for(var b=[this],c=a,i,f,h,j,m,k;b.length;){i=b.shift();f=0;for(h=i.length;f<h;f++){j=w(i[f]);c?j.triggerHandler("$destroy"):c=!c;m=0;for(e=(k=j.children()).length,j=e;m<j;m++)b.push(ga(k[m]))}}return d.apply(this,arguments)}var d=ga.fn[b],d=d.$original||d;c.$original=d;ga.fn[b]=c}function R(b){if(b instanceof R)return b;if(!(this instanceof R)){if(E(b)&&b.charAt(0)!="<")throw Error("selectors not implemented");return new R(b)}if(E(b)){var a=T.createElement("div");a.innerHTML="<div>&#160;</div>"+b;a.removeChild(a.firstChild);eb(this,a.childNodes);this.remove()}else eb(this,b)}function fb(b){return b.cloneNode(!0)}function ya(b){zb(b);for(var a=0,b=b.childNodes||[];a<b.length;a++)ya(b[a])}function Ab(b,a,c){var d=ca(b,"events");ca(b,"handle")&&(C(a)?n(d,function(a,c){gb(b,c,a);delete d[c]}):C(c)?(gb(b,a,d[a]),delete d[a]):ta(d[a],c))}function zb(b){var a=b[Ja],c=Ka[a];c&&(c.handle&&(c.events.$destroy&&c.handle({},"$destroy"),Ab(b)),delete Ka[a],b[Ja]=p)}function ca(b,a,c){var d=b[Ja],d=Ka[d||-1];if(B(c))d||(b[Ja]=d=++wc,d=Ka[d]={}),d[a]=c;else return d&&d[a]}function Bb(b,a,c){var d=ca(b,"data"),e=B(c),g=!e&&B(a),i=g&&!L(a);!d&&!i&&ca(b,"data",d={});if(e)d[a]=c;else if(g)if(i)return d&&d[a];else t(d,a);else return d}function La(b,a){return(" "+b.className+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" ")>-1}function Cb(b,a){a&&n(a.split(" "),function(a){b.className=U((" "+b.className+" ").replace(/[\n\t]/g," ").replace(" "+U(a)+" "," "))})}function Db(b,a){a&&n(a.split(" "),function(a){if(!La(b,a))b.className=U(b.className+" "+U(a))})}function eb(b,a){if(a)for(var a=!a.nodeName&&B(a.length)&&!sa(a)?a:[a],c=0;c<a.length;c++)b.push(a[c])}function Eb(b,a){return Ma(b,"$"+(a||"ngController")+"Controller")}function Ma(b,a,c){b=w(b);for(b[0].nodeType==9&&(b=b.find("html"));b.length;){if(c=b.data(a))return c;b=b.parent()}}function Fb(b,a){var c=Na[a.toLowerCase()];return c&&Gb[b.nodeName]&&c}function xc(b,a){var c=function(c,e){if(!c.preventDefault)c.preventDefault=function(){c.returnValue=!1};if(!c.stopPropagation)c.stopPropagation=function(){c.cancelBubble=!0};if(!c.target)c.target=c.srcElement||T;if(C(c.defaultPrevented)){var g=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0;g.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||c.returnValue==!1};n(a[e||c.type],function(a){a.call(b,c)});Z<=8?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function la(b){var a=typeof b,c;if(a=="object"&&b!==null)if(typeof(c=b.$$hashKey)=="function")c=b.$$hashKey();else{if(c===p)c=b.$$hashKey=Fa()}else c=b;return a+":"+c}function za(b){n(b,this.put,this)}function Hb(b){var a,c;if(typeof b=="function"){if(!(a=b.$inject))a=[],c=b.toString().replace(yc,""),c=c.match(zc),n(c[1].split(Ac),function(b){b.replace(Bc,function(b,c,d){a.push(d)})}),b.$inject=a}else F(b)?(c=b.length-1,xa(b[c],"fn"),a=b.slice(0,c)):xa(b,"fn",!0);return a}function yb(b){function a(a){return function(b,c){if(L(b))n(b,rb(a));else return a(b,c)}}function c(a,b){if(H(b)||F(b))b=k.instantiate(b);if(!b.$get)throw Error("Provider "+a+" must define $get factory method.");return m[a+f]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[];n(a,function(a){if(!j.get(a))if(j.put(a,!0),E(a)){var c=Aa(a);b=b.concat(e(c.requires)).concat(c._runBlocks);try{for(var d=c._invokeQueue,c=0,f=d.length;c<f;c++){var g=d[c],o=k.get(g[0]);o[g[1]].apply(o,g[2])}}catch(h){throw h.message&&(h.message+=" from "+a),h;}}else if(H(a))try{b.push(k.invoke(a))}catch(l){throw l.message&&(l.message+=" from "+a),l;}else if(F(a))try{b.push(k.invoke(a))}catch(i){throw i.message&&(i.message+=" from "+String(a[a.length-1])),i;}else xa(a,"module")});return b}function g(a,b){function c(d){if(typeof d!=="string")throw Error("Service name expected");if(a.hasOwnProperty(d)){if(a[d]===i)throw Error("Circular dependency: "+h.join(" <- "));return a[d]}else try{return h.unshift(d),a[d]=i,a[d]=b(d)}finally{h.shift()}}function d(a,b,e){var f=[],j=Hb(a),g,o,h;o=0;for(g=j.length;o<g;o++)h=j[o],f.push(e&&e.hasOwnProperty(h)?e[h]:c(h));a.$inject||(a=a[g]);switch(b?-1:f.length){case 0:return a();case 1:return a(f[0]);case 2:return a(f[0],f[1]);case 3:return a(f[0],f[1],f[2]);case 4:return a(f[0],f[1],f[2],f[3]);case 5:return a(f[0],f[1],f[2],f[3],f[4]);case 6:return a(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6]);case 8:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7]);case 9:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8]);case 10:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9]);default:return a.apply(b,f)}}return{invoke:d,instantiate:function(a,b){var c=function(){},e;c.prototype=(F(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return L(e)?e:c},get:c,annotate:Hb,has:function(b){return m.hasOwnProperty(b+
f)||a.hasOwnProperty(b)}}}var i={},f="Provider",h=[],j=new za,m={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,S(b))}),constant:a(function(a,b){m[a]=b;l[a]=b}),decorator:function(a,b){var c=k.get(a+f),d=c.$get;c.$get=function(){var a=u.invoke(d,c);return u.invoke(b,null,{$delegate:a})}}}},k=m.$injector=g(m,function(){throw Error("Unknown provider: "+h.join(" <- "));}),l={},u=l.$injector=g(l,function(a){a=k.get(a+f);return u.invoke(a.$get,a)});n(e(b),function(a){u.invoke(a||q)});return u}function Cc(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;n(a,function(a){!b&&I(a.nodeName)==="a"&&(b=a)});return b}function g(){var b=c.hash(),d;b?(d=i.getElementById(b))?d.scrollIntoView():(d=e(i.getElementsByName(b)))?d.scrollIntoView():b==="top"&&a.scrollTo(0,0):a.scrollTo(0,0)}var i=a.document;b&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(g)});return g}]}function Ib(b){this.register=function(a,c){b.factory(Ia(a)+"Animation",c)};this.$get=["$injector",function(a){return function(b){if(b&&(b=Ia(b)+"Animation",a.has(b)))return a.get(b)}}]}function Dc(b,a,c,d){function e(a){try{a.apply(null,ka.call(arguments,1))}finally{if(o--,o===0)for(;z.length;)try{z.pop()()}catch(b){c.error(b)}}}function g(a,b){(function s(){n(r,function(a){a()});y=b(s,a)})()}function i(){x!=f.url()&&(x=f.url(),n(v,function(a){a(f.url())}))}
var f=this,h=a[0],j=b.location,m=b.history,k=b.setTimeout,l=b.clearTimeout,u={};f.isMock=!1;var o=0,z=[];f.$$completeOutstandingRequest=e;f.$$incOutstandingRequestCount=function(){o++};f.notifyWhenNoOutstandingRequests=function(a){n(r,function(a){a()});o===0?a():z.push(a)};var r=[],y;f.addPollFn=function(a){C(y)&&g(100,k);r.push(a);return a};var x=j.href,W=a.find("base");f.url=function(a,b){if(a){if(x!=a)return x=a,d.history?b?m.replaceState(null,"",a):(m.pushState(null,"",a),W.attr("href",W.attr("href"))):b?j.replace(a):j.href=a,f}else return j.href.replace(/%27/g,"'")};var v=[],A=!1;f.onUrlChange=function(a){A||(d.history&&w(b).bind("popstate",i),d.hashchange?w(b).bind("hashchange",i):f.addPollFn(i),A=!0);v.push(a);return a};f.baseHref=function(){var a=W.attr("href");return a?a.replace(/^https?\:\/\/[^\/]*/,""):""};var G={},D="",$=f.baseHref();f.cookies=function(a,b){var d,e,f,j;if(a)if(b===p)h.cookie=escape(a)+"=;path="+$+";expires=Thu, 01 Jan 1970 00:00:00 GMT";else{if(E(b))d=(h.cookie=escape(a)+"="+escape(b)+";path="+$).length+1,d>4096&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!")}else{if(h.cookie!==D){D=h.cookie;d=D.split("; ");G={};for(f=0;f<d.length;f++)e=d[f],j=e.indexOf("="),j>0&&(a=unescape(e.substring(0,j)),G[a]===p&&(G[a]=unescape(e.substring(j+1))))}return G}};f.defer=function(a,b){var c;o++;c=k(function(){delete u[c];e(a)},b||0);u[c]=!0;return c};f.defer.cancel=function(a){return u[a]?(delete u[a],l(a),e(q),!0):!1}}function Ec(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new Dc(b,d,a,c)}]}function Fc(){this.$get=function(){function b(b,d){function e(a){if(a!=k){if(l){if(l==a)l=a.n}else l=a;g(a.n,a.p);g(a,k);k=a;k.n=null}}function g(a,b){if(a!=b){if(a)a.p=b;if(b)b.n=a}}if(b in a)throw Error("cacheId "+b+" taken");var i=0,f=t({},d,{id:b}),h={},j=d&&d.capacity||Number.MAX_VALUE,m={},k=null,l=null;return a[b]={put:function(a,b){var c=m[a]||(m[a]={key:a});e(c);if(!C(b))return a in h||i++,h[a]=b,i>j&&this.remove(l.key),b},get:function(a){var b=m[a];if(b)return e(b),h[a]},remove:function(a){var b=m[a];if(b){if(b==k)k=b.p;if(b==l)l=b.n;g(b.n,b.p);delete m[a];delete h[a];i--}},removeAll:function(){h={};i=0;m={};k=l=null},destroy:function(){m=f=h=null;delete a[b]},info:function(){return t({},f,{size:i})}}}var a={};b.info=function(){var b={};n(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function Gc(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function Jb(b){var a={},c="Directive",d=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,e=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,g="Template must have exactly one root element. was: ",i=/^\s*(https?|ftp|mailto|file):/;this.directive=function h(d,e){E(d)?(cb(e,"directive"),a.hasOwnProperty(d)||(a[d]=[],b.factory(d+c,["$injector","$exceptionHandler",function(b,c){var e=[];n(a[d],function(a){try{var g=b.invoke(a);if(H(g))g={compile:S(g)};else if(!g.compile&&g.link)g.compile=S(g.link);g.priority=g.priority||0;g.name=g.name||d;g.require=g.require||g.controller&&g.name;g.restrict=g.restrict||"A";e.push(g)}catch(h){c(h)}});return e}])),a[d].push(e)):n(d,rb(h));return this};this.urlSanitizationWhitelist=function(a){return B(a)?(i=a,this):i};this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document",function(b,j,m,k,l,u,o,z,r){function y(a,b,c){a instanceof w||(a=w(a));n(a,function(b,c){b.nodeType==3&&b.nodeValue.match(/\S+/)&&(a[c]=w(b).wrap("<span></span>").parent()[0])});var d=W(a,b,a,c);return function(b,c){cb(b,"scope");for(var e=c?Ba.clone.call(a):a,j=0,g=e.length;j<g;j++){var h=e[j];(h.nodeType==1||h.nodeType==9)&&e.eq(j).data("$scope",b)}x(e,"ng-scope");c&&c(e,b);d&&d(b,e,e);return e}}function x(a,b){try{a.addClass(b)}catch(c){}}function W(a,b,c,d){function e(a,c,d,g){var h,i,k,l,o,m,u,z=[];o=0;for(m=c.length;o<m;o++)z.push(c[o]);u=o=0;for(m=j.length;o<m;u++)i=z[u],c=j[o++],h=j[o++],c?(c.scope?(k=a.$new(L(c.scope)),w(i).data("$scope",k)):k=a,(l=c.transclude)||!g&&b?c(h,k,i,d,function(b){return function(c){var d=a.$new();d.$$transcluded=!0;return b(d,c).bind("$destroy",$a(d,d.$destroy))}}(l||b)):c(h,k,i,p,g)):h&&h(a,i.childNodes,p,g)}for(var j=[],g,h,k,i=0;i<a.length;i++)h=new ma,g=v(a[i],[],h,d),h=(g=g.length?A(g,a[i],h,b,c):null)&&g.terminal||!a[i].childNodes||!a[i].childNodes.length?null:W(a[i].childNodes,g?g.transclude:b),j.push(g),j.push(h),k=k||g||h;return k?e:null}function v(a,b,c,j){var g=c.$attr,h;switch(a.nodeType){case 1:G(b,da(hb(a).toLowerCase()),"E",j);var i,k,l;h=a.attributes;for(var o=0,m=h&&h.length;o<m;o++)if(i=h[o],i.specified)k=i.name,l=da(k),Y.test(l)&&(k=l.substr(6).toLowerCase()),l=da(k.toLowerCase()),g[l]=k,c[l]=i=U(Z&&k=="href"?decodeURIComponent(a.getAttribute(k,2)):i.value),Fb(a,l)&&(c[l]=!0),s(a,b,i,l),G(b,l,"A",j);a=a.className;if(E(a)&&a!=="")for(;h=e.exec(a);)l=da(h[2]),G(b,l,"C",j)&&(c[l]=U(h[3])),a=a.substr(h.index+h[0].length);break;case 3:P(b,a.nodeValue);break;case 8:try{if(h=d.exec(a.nodeValue))l=da(h[1]),G(b,l,"M",j)&&(c[l]=U(h[2]))}catch(u){}}b.sort(K);return b}function A(a,b,c,d,e){function h(a,b){if(a)a.require=s.require,z.push(a);if(b)b.require=s.require,ea.push(b)}function i(a,b){var c,d="data",e=!1;if(E(a)){for(;(c=a.charAt(0))=="^"||c=="?";)a=a.substr(1),c=="^"&&(d="inheritedData"),e=e||c=="?";c=b[d]("$"+a+"Controller");if(!c&&!e)throw Error("No controller: "+a);}else F(a)&&(c=[],n(a,function(a){c.push(i(a,b))}));return c}function k(a,d,e,g,h){var l,v,r,D,x;l=b===e?c:pc(c,new ma(w(e),c.$attr));v=l.$$element;if(K){var y=/^\s*([@=&])(\??)\s*(\w*)\s*$/,s=d.$parent||d;n(K.scope,function(a,b){var c=a.match(y)||[],e=c[3]||b,g=c[2]=="?",c=c[1],h,k,i;d.$$isolateBindings[b]=c+e;switch(c){case"@":l.$observe(e,function(a){d[b]=a});l.$$observers[e].$$scope=s;l[e]&&(d[b]=j(l[e])(s));break;case"=":if(g&&!l[e])break;k=u(l[e]);i=k.assign||function(){h=d[b]=k(s);throw Error(Kb+l[e]+" (directive: "+K.name+")");};h=d[b]=k(s);d.$watch(function(){var a=k(s);a!==d[b]&&(a!==h?h=d[b]=a:i(s,a=h=d[b]));return a});break;case"&":k=u(l[e]);d[b]=function(a){return k(s,a)};break;default:throw Error("Invalid isolate scope definition for directive "+K.name+": "+a);}})}q&&n(q,function(a){var b={$scope:d,$element:v,$attrs:l,$transclude:h};x=a.controller;x=="@"&&(x=l[a.name]);v.data("$"+a.name+"Controller",o(x,b))});g=0;for(r=z.length;g<r;g++)try{D=z[g],D(d,v,l,D.require&&i(D.require,v))}catch(Hc){m(Hc,va(v))}a&&a(d,e.childNodes,p,h);g=0;for(r=ea.length;g<r;g++)try{D=ea[g],D(d,v,l,D.require&&i(D.require,v))}catch(J){m(J,va(v))}}for(var l=-Number.MAX_VALUE,z=[],ea=[],r=null,K=null,W=null,J=c.$$element=w(b),s,A,Y,G,P=d,q,na,t,B=0,C=a.length;B<C;B++){s=a[B];Y=p;if(l>s.priority)break;if(t=s.scope)O("isolated scope",K,s,J),L(t)&&(x(J,"ng-isolate-scope"),K=s),x(J,"ng-scope"),r=r||s;A=s.name;if(t=s.controller)q=q||{},O("'"+A+"' controller",q[A],s,J),q[A]=s;if(t=s.transclude)O("transclusion",G,s,J),G=s,l=s.priority,t=="element"?(Y=w(b),J=c.$$element=w(T.createComment(" "+A+": "+c[A]+" ")),b=J[0],ja(e,w(Y[0]),b),P=y(Y,d,l)):(Y=w(fb(b)).contents(),J.html(""),P=y(Y,d));if(s.template)if(O("template",W,s,J),W=s,t=H(s.template)?s.template(J,c):s.template,t=Lb(t),s.replace){Y=w("<div>"+U(t)+"</div>").contents();b=Y[0];if(Y.length!=1||b.nodeType!==1)throw Error(g+t);ja(e,J,b);A={$attr:{}};a=a.concat(v(b,a.splice(B+1,a.length-(B+1)),A));D(c,A);C=a.length}else J.html(t);if(s.templateUrl)O("template",W,s,J),W=s,k=$(a.splice(B,a.length-B),k,J,c,e,s.replace,P),C=a.length;else if(s.compile)try{na=s.compile(J,c,P),H(na)?h(null,na):na&&h(na.pre,na.post)}catch(I){m(I,va(J))}if(s.terminal)k.terminal=!0,l=Math.max(l,s.priority)}k.scope=r&&r.scope;k.transclude=G&&P;return k}function G(d,e,j,g){var l=!1;if(a.hasOwnProperty(e))for(var k,e=b.get(e+c),i=0,o=e.length;i<o;i++)try{if(k=e[i],(g===p||g>k.priority)&&k.restrict.indexOf(j)!=-1)d.push(k),l=!0}catch(u){m(u)}return l}function D(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;n(a,function(d,e){e.charAt(0)!="$"&&(b[e]&&(d+=(e==="style"?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});n(b,function(b,j){j=="class"?(x(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):j=="style"?e.attr("style",e.attr("style")+";"+b):j.charAt(0)!="$"&&!a.hasOwnProperty(j)&&(a[j]=b,d[j]=c[j])})}function $(a,b,c,d,e,j,h){var i=[],o,m,u=c[0],z=a.shift(),r=t({},z,{controller:null,templateUrl:null,transclude:null,scope:null}),z=H(z.templateUrl)?z.templateUrl(c,d):z.templateUrl;c.html("");k.get(z,{cache:l}).success(function(l){var k,z,l=Lb(l);if(j){z=w("<div>"+U(l)+"</div>").contents();k=z[0];if(z.length!=1||k.nodeType!==1)throw Error(g+l);l={$attr:{}};ja(e,c,k);v(k,a,l);D(d,l)}else k=u,c.html(l);a.unshift(r);o=A(a,k,d,h);for(m=W(c[0].childNodes,h);i.length;){var ea=i.shift(),l=i.shift();z=i.shift();var x=i.shift(),y=k;l!==u&&(y=fb(k),ja(z,w(l),y));o(function(){b(m,ea,y,e,x)},ea,y,e,x)}i=null}).error(function(a,b,c,d){throw Error("Failed to load template: "+d.url);});return function(a,c,d,e,j){i?(i.push(c),i.push(d),i.push(e),i.push(j)):o(function(){b(m,c,d,e,j)},c,d,e,j)}}function K(a,b){return b.priority-a.priority}function O(a,b,c,d){if(b)throw Error("Multiple directives ["+
b.name+", "+c.name+"] asking for "+a+" on: "+va(d));}function P(a,b){var c=j(b,!0);c&&a.push({priority:0,compile:S(function(a,b){var d=b.parent(),e=d.data("$binding")||[];e.push(c);x(d.data("$binding",e),"ng-binding");a.$watch(c,function(a){b[0].nodeValue=a})})})}function s(a,b,c,d){var e=j(c,!0);e&&b.push({priority:100,compile:S(function(a,b,c){b=c.$$observers||(c.$$observers={});if(e=j(c[d],!0))c[d]=e(a),(b[d]||(b[d]=[])).$$inter=!0,(c.$$observers&&c.$$observers[d].$$scope||a).$watch(e,function(a){c.$set(d,a)})})})}function ja(a,b,c){var d=b[0],e=d.parentNode,j,g;if(a){j=0;for(g=a.length;j<g;j++)if(a[j]==d){a[j]=c;break}}e&&e.replaceChild(c,d);c[w.expando]=d[w.expando];b[0]=c}var ma=function(a,b){this.$$element=a;this.$attr=b||{}};ma.prototype={$normalize:da,$set:function(a,b,c,d){var e=Fb(this.$$element[0],a),j=this.$$observers;e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=d:(d=this.$attr[a])||(this.$attr[a]=d=bb(a,"-"));if(hb(this.$$element[0])==="A"&&a==="href")q.setAttribute("href",b),e=q.href,e.match(i)||(this[a]=b="unsafe:"+e);c!==!1&&(b===null||b===p?this.$$element.removeAttr(d):this.$$element.attr(d,b));j&&n(j[a],function(a){try{a(b)}catch(c){m(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);e.push(b);z.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var q=r[0].createElement("a"),ea=j.startSymbol(),J=j.endSymbol(),Lb=ea=="{{"||J=="}}"?qa:function(a){return a.replace(/\{\{/g,ea).replace(/}}/g,J)},Y=/^ngAttr[A-Z]/;return y}]}
function da(b){return Ia(b.replace(Ic,""))}function Jc(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){L(a)?t(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,g){var i,f;E(e)&&(f=e.match(a),i=f[1],f=f[3],e=b.hasOwnProperty(i)?b[i]:ib(g.$scope,i,!0)||ib(d,i,!0),xa(e,i,!0));i=c.instantiate(e,g);if(f){if(typeof g.$scope!=="object")throw Error('Can not export controller as "'+f+'". No scope object provided!');g.$scope[f]=i}return i}}]}function Kc(){this.$get=["$window",function(b){return w(b.document)}]}function Lc(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function Mc(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler",function(c,d){function e(e,h){for(var j,m,k=0,l=[],u=e.length,o=!1,z=[];k<u;)(j=e.indexOf(b,k))!=-1&&(m=e.indexOf(a,j+g))!=-1?(k!=j&&l.push(e.substring(k,j)),l.push(k=c(o=e.substring(j+g,m))),k.exp=o,k=m+i,o=!0):(k!=u&&l.push(e.substring(k)),k=u);if(!(u=l.length))l.push(""),u=1;if(!h||o)return z.length=u,k=function(a){try{for(var b=0,c=u,j;b<c;b++){if(typeof(j=l[b])=="function")j=j(a),j==null||j==p?j="":typeof j!="string"&&(j=ha(j));z[b]=j}return z.join("")}catch(g){d(Error("Error while interpolating: "+e+"\n"+g.toString()))}},k.exp=e,k.parts=l,k}var g=b.length,i=a.length;e.startSymbol=function(){return b};e.endSymbol=function(){return a};return e}]}function Mb(b){for(var b=b.split("/"),a=b.length;a--;)b[a]=ab(b[a]);return b.join("/")}function Nb(b,a){var c=jb.exec(b);a.$$protocol=c[1];a.$$host=c[3];a.$$port=N(c[5])||Oa[c[1]]||null}function Ob(b,a){var c=Pb.exec(b);a.$$path=decodeURIComponent(c[1]);a.$$search=vb(c[3]);a.$$hash=decodeURIComponent(c[5]||"");if(a.$$path&&a.$$path.charAt(0)!="/")a.$$path="/"+a.$$path}function fa(b,a,c){return a.indexOf(b)==0?a.substr(b.length):c}function Ca(b){var a=b.indexOf("#");return a==-1?b:b.substr(0,a)}function kb(b){return b.substr(0,Ca(b).lastIndexOf("/")+
1)}function Qb(b,a){var a=a||"",c=kb(b);this.$$parse=function(a){var b={};Nb(a,b);var g=fa(c,a);if(!E(g))throw Error('Invalid url "'+a+'", missing path prefix "'+c+'".');Ob(g,b);t(this,b);if(!this.$$path)this.$$path="/";this.$$compose()};this.$$compose=function(){var a=wb(this.$$search),b=this.$$hash?"#"+ab(this.$$hash):"";this.$$url=Mb(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;if((e=fa(b,d))!==p)return d=e,(e=fa(a,e))!==p?c+(fa("/",e)||e):b+d;else if((e=fa(c,d))!==p)return c+e;else if(c==d+"/")return c}}function lb(b,a){var c=kb(b);this.$$parse=function(d){Nb(d,this);var e=fa(b,d)||fa(c,d);if(!E(e))throw Error('Invalid url "'+d+'", does not start with "'+b+'".');e=e.charAt(0)=="#"?fa(a,e):e;if(!E(e))throw Error('Invalid url "'+d+'", missing hash prefix "'+a+'".');Ob(e,this);this.$$compose()};this.$$compose=function(){var c=wb(this.$$search),e=this.$$hash?"#"+ab(this.$$hash):"";this.$$url=Mb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(Ca(b)==Ca(a))return a}}function Rb(b,a){lb.apply(this,arguments);var c=kb(b);this.$$rewrite=function(d){var e;if(b==Ca(d))return d;else if(e=fa(c,d))return b+a+e;else if(c===d+"/")return c}}function Pa(b){return function(){return this[b]}}function Sb(b,a){return function(c){if(C(c))return this[b];this[b]=a(c);this.$$compose();return this}}function Nc(){var b="",a=!1;this.hashPrefix=function(a){return B(a)?(b=a,this):b};this.html5Mode=function(b){return B(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,g){function i(a){c.$broadcast("$locationChangeSuccess",f.absUrl(),a)}var f,h=d.baseHref(),j=d.url();a?(h=h?j.substring(0,j.indexOf("/",j.indexOf("//")+2))+h:j,e=e.history?Qb:Rb):(h=Ca(j),e=lb);f=new e(h,"#"+b);f.$$parse(f.$$rewrite(j));g.bind("click",function(a){if(!a.ctrlKey&&!(a.metaKey||a.which==2)){for(var b=w(a.target);I(b[0].nodeName)!=="a";)if(b[0]===g[0]||!(b=b.parent())[0])return;var e=b.prop("href"),j=f.$$rewrite(e);e&&!b.attr("target")&&j&&!a.isDefaultPrevented()&&(a.preventDefault(),j!=d.url()&&(f.$$parse(j),c.$apply(),M.angular["ff-684208-preventDefault"]=!0))}});f.absUrl()!=j&&d.url(f.absUrl(),!0);d.onUrlChange(function(a){f.absUrl()!=a&&(c.$broadcast("$locationChangeStart",a,f.absUrl()).defaultPrevented?d.url(f.absUrl()):(c.$evalAsync(function(){var b=f.absUrl();f.$$parse(a);i(b)}),c.$$phase||c.$digest()))});var m=0;c.$watch(function(){var a=d.url(),b=f.$$replace;if(!m||a!=f.absUrl())m++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",f.absUrl(),a).defaultPrevented?f.$$parse(a):(d.url(f.absUrl(),b),i(a))});f.$$replace=!1;return m});return f}]}function Oc(){var b=!0,a=this;this.debugEnabled=function(a){return B(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&a.stack.indexOf(a.message)===-1?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||q;return e.apply?function(){var a=[];n(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,b)}}return{log:e("log"),warn:e("warn"),info:e("info"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function Pc(b,a){function c(a){return a.indexOf(r)!=-1}function d(a){a=a||1;return o+a<b.length?b.charAt(o+a):!1}function e(a){return"0"<=a&&a<="9"}function g(a){return a==" "||a=="\r"||a=="\t"||a=="\n"||a=="\u000b"||a=="\u00a0"}function i(a){return"a"<=a&&a<="z"||"A"<=a&&a<="Z"||"_"==a||a=="$"}function f(a){return a=="-"||a=="+"||e(a)}function h(a,c,d){d=d||o;throw Error("Lexer Error: "+a+" at column"+(B(c)?"s "+c+"-"+o+" ["+b.substring(c,d)+"]":" "+d)+" in expression ["+b+"].");}function j(){for(var a="",c=o;o<b.length;){var j=I(b.charAt(o));if(j=="."||e(j))a+=j;else{var g=d();if(j=="e"&&f(g))a+=j;else if(f(j)&&g&&e(g)&&a.charAt(a.length-1)=="e")a+=j;else if(f(j)&&(!g||!e(g))&&a.charAt(a.length-
1)=="e")h("Invalid exponent");else break}o++}a*=1;l.push({index:c,text:a,json:!0,fn:function(){return a}})}function m(){for(var c="",d=o,f,j,h,k;o<b.length;){k=b.charAt(o);if(k=="."||i(k)||e(k))k=="."&&(f=o),c+=k;else break;o++}if(f)for(j=o;j<b.length;){k=b.charAt(j);if(k=="("){h=c.substr(f-d+1);c=c.substr(0,f-d);o=j;break}if(g(k))j++;else break}d={index:d,text:c};if(Da.hasOwnProperty(c))d.fn=d.json=Da[c];else{var m=Tb(c,a);d.fn=t(function(a,b){return m(a,b)},{assign:function(a,b){return Ub(a,c,b)}})}l.push(d);h&&(l.push({index:f,text:".",json:!1}),l.push({index:f+1,text:h,json:!1}))}function k(a){var c=o;o++;for(var d="",e=a,f=!1;o<b.length;){var j=b.charAt(o);e+=j;if(f)j=="u"?(j=b.substring(o+1,o+5),j.match(/[\da-f]{4}/i)||h("Invalid unicode escape [\\u"+j+"]"),o+=4,d+=String.fromCharCode(parseInt(j,16))):(f=Qc[j],d+=f?f:j),f=!1;else if(j=="\\")f=!0;else if(j==a){o++;l.push({index:c,text:e,string:d,json:!0,fn:function(){return d}});return}else d+=j;o++}h("Unterminated quote",c)}for(var l=[],u,o=0,z=[],r,y=":";o<b.length;){r=b.charAt(o);if(c("\"'"))k(r);else if(e(r)||c(".")&&e(d()))j();else if(i(r)){if(m(),"{,".indexOf(y)!=-1&&z[0]=="{"&&(u=l[l.length-1]))u.json=u.text.indexOf(".")==-1}else if(c("(){}[].,;:?"))l.push({index:o,text:r,json:":[,".indexOf(y)!=-1&&c("{[")||c("}]:,")}),c("{[")&&z.unshift(r),c("}]")&&z.shift(),o++;else if(g(r)){o++;continue}else{var x=r+d(),n=x+d(2),v=Da[r],A=Da[x],G=Da[n];G?(l.push({index:o,text:n,fn:G}),o+=3):A?(l.push({index:o,text:x,fn:A}),o+=2):v?(l.push({index:o,text:r,fn:v,json:"[,:".indexOf(y)!=-1&&c("+-")}),o+=1):h("Unexpected next character ",o,o+1)}y=r}return l}function Rc(b,a,c,d){function e(a,c){throw Error("Syntax Error: Token '"+c.text+"' "+a+" at column "+(c.index+1)+" of the expression ["+b+"] starting at ["+b.substring(c.index)+"].");}function g(){if(O.length===0)throw Error("Unexpected end of expression: "+b);return O[0]}function i(a,b,c,d){if(O.length>0){var e=O[0],f=e.text;if(f==a||f==b||f==c||f==d||!a&&!b&&!c&&!d)return e}return!1}function f(b,c,d,f){return(b=i(b,c,d,f))?(a&&!b.json&&e("is not valid json",b),O.shift(),b):!1}function h(a){f(a)||e("is unexpected, expecting ["+a+"]",i())}function j(a,b){return t(function(c,d){return a(c,d,b)},{constant:b.constant})}function m(a,b,c){return t(function(d,e){return a(d,e)?b(d,e):c(d,e)},{constant:a.constant&&b.constant&&c.constant})}function k(a,b,c){return t(function(d,e){return b(d,e,a,c)},{constant:a.constant&&c.constant})}function l(){for(var a=[];;)if(O.length>0&&!i("}",")",";","]")&&a.push(w()),!f(";"))return a.length==1?a[0]:function(b,c){for(var d,e=0;e<a.length;e++){var f=a[e];f&&(d=f(b,c))}return d}}function u(){for(var a=f(),b=c(a.text),d=[];;)if(a=f(":"))d.push(P());else{var e=function(a,c,e){for(var e=[e],f=0;f<d.length;f++)e.push(d[f](a,c));return b.apply(a,e)};return function(){return e}}}function o(){var a=z(),b,c;if(f("?"))if(b=o(),c=f(":"))return m(a,b,o());else e("expected :",c);else return a}function z(){for(var a=r(),b;;)if(b=f("||"))a=k(a,b.fn,r());else return a}function r(){var a=y(),b;if(b=f("&&"))a=k(a,b.fn,r());return a}function y(){var a=x(),b;if(b=f("==","!=","===","!=="))a=k(a,b.fn,y());return a}function x(){var a;a=n();for(var b;b=f("+","-");)a=k(a,b.fn,n());if(b=f("<",">","<=",">="))a=k(a,b.fn,x());return a}function n(){for(var a=v(),b;b=f("*","/","%");)a=k(a,b.fn,v());return a}function v(){var a;return f("+")?A():(a=f("-"))?k($,a.fn,v()):(a=f("!"))?j(a.fn,v()):A()}function A(){var a;if(f("("))a=w(),h(")");else if(f("["))a=G();else if(f("{"))a=D();else{var b=f();(a=b.fn)||e("not a primary expression",b);if(b.json)a.constant=a.literal=!0}for(var c;b=f("(","[",".");)b.text==="("?(a=s(a,c),c=null):b.text==="["?(c=a,a=ma(a)):b.text==="."?(c=a,a=ja(a)):e("IMPOSSIBLE");return a}function G(){var a=[],b=!0;if(g().text!="]"){do{var c=P();a.push(c);c.constant||(b=!1)}while(f(","))}h("]");return t(function(b,c){for(var d=[],e=0;e<a.length;e++)d.push(a[e](b,c));return d},{literal:!0,constant:b})}function D(){var a=[],b=!0;if(g().text!="}"){do{var c=f(),c=c.string||c.text;h(":");var d=P();a.push({key:c,value:d});d.constant||(b=!1)}while(f(","))}h("}");return t(function(b,c){for(var d={},e=0;e<a.length;e++){var f=a[e];d[f.key]=f.value(b,c)}return d},{literal:!0,constant:b})}var $=S(0),K,O=Pc(b,d),P=function(){var a=o(),c,d;return(d=f("="))?(a.assign||e("implies assignment but ["+b.substring(0,d.index)+"] can not be assigned to",d),c=o(),function(b,d){return a.assign(b,c(b,d),d)}):a},s=function(a,b){var c=[];if(g().text!=")"){do c.push(P());while(f(","))}h(")");return function(d,e){for(var f=[],j=b?b(d,e):d,g=0;g<c.length;g++)f.push(c[g](d,e));g=a(d,e,j)||q;return g.apply?g.apply(j,f):g(f[0],f[1],f[2],f[3],f[4])}},ja=function(a){var b=f().text,c=Tb(b,d);return t(function(b,d,e){return c(e||a(b,d),d)},{assign:function(c,d,e){return Ub(a(c,e),b,d)}})},ma=function(a){var b=P();h("]");return t(function(c,d){var e=a(c,d),f=b(c,d),j;if(!e)return p;if((e=e[f])&&e.then){j=e;if(!("$$v"in e))j.$$v=p,j.then(function(a){j.$$v=a});e=e.$$v}return e},{assign:function(c,d,e){return a(c,e)[b(c,e)]=d}})},w=function(){for(var a=P(),b;;)if(b=f("|"))a=k(a,b.fn,u());else return a};a?(P=z,s=ja=ma=w=function(){e("is not valid json",{text:b,index:0})},K=A()):K=l();O.length!==0&&e("is an unexpected token",O[0]);K.literal=!!K.literal;K.constant=!!K.constant;return K}function Ub(b,a,c){for(var a=a.split("."),d=0;a.length>1;d++){var e=a.shift(),g=b[e];g||(g={},b[e]=g);b=g}return b[a.shift()]=c}function ib(b,a,c){if(!a)return b;for(var a=a.split("."),d,e=b,g=a.length,i=0;i<g;i++)d=a[i],b&&(b=(e=b)[d]);return!c&&H(b)?$a(e,b):b}function Vb(b,a,c,d,e){return function(g,i){var f=i&&i.hasOwnProperty(b)?i:g,h;if(f===null||f===p)return f;if((f=f[b])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!a||f===null||f===p)return f;if((f=f[a])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!c||f===null||f===p)return f;if((f=f[c])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!d||f===null||f===p)return f;if((f=f[d])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!e||f===null||f===p)return f;if((f=f[e])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}return f}}function Tb(b,a){if(mb.hasOwnProperty(b))return mb[b];var c=b.split("."),d=c.length,e;if(a)e=d<6?Vb(c[0],c[1],c[2],c[3],c[4]):function(a,b){var e=0,j;do j=Vb(c[e++],c[e++],c[e++],c[e++],c[e++])(a,b),b=p,a=j;while(e<d);return j};else{var g="var l, fn, p;\n";n(c,function(a,b){g+="if(s === null || s === undefined) return s;\nl=s;\ns="+
(b?"s":'((k&&k.hasOwnProperty("'+a+'"))?k:s)')+'["'+a+'"];\nif (s && s.then) {\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n'});g+="return s;";e=Function("s","k",g);e.toString=function(){return g}}return mb[b]=e}function Sc(){var b={};this.$get=["$filter","$sniffer",function(a,c){return function(d){switch(typeof d){case"string":return b.hasOwnProperty(d)?b[d]:b[d]=Rc(d,!1,a,c.csp);case"function":return d;default:return q}}}]}function Tc(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return Uc(function(a){b.$evalAsync(a)},a)}]}function Uc(b,a){function c(a){return a}function d(a){return i(a)}var e=function(){var f=[],h,j;return j={resolve:function(a){if(f){var c=f;f=p;h=g(a);c.length&&b(function(){for(var a,b=0,d=c.length;b<d;b++)a=c[b],h.then(a[0],a[1])})}},reject:function(a){j.resolve(i(a))},promise:{then:function(b,j){var g=e(),i=function(d){try{g.resolve((b||c)(d))}catch(e){a(e),g.reject(e)}},o=function(b){try{g.resolve((j||d)(b))}catch(c){a(c),g.reject(c)}};f?f.push([i,o]):h.then(i,o);return g.promise},always:function(a){function b(a,c){var d=e();c?d.resolve(a):d.reject(a);return d.promise}function d(e,f){var j=null;try{j=(a||c)()}catch(g){return b(g,!1)}return j&&j.then?j.then(function(){return b(e,f)},function(a){return b(a,!1)}):b(e,f)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},g=function(a){return a&&a.then?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},i=function(a){return{then:function(c,j){var g=e();b(function(){g.resolve((j||d)(a))});return g.promise}}};return{defer:e,reject:i,when:function(f,h,j){var m=e(),k,l=function(b){try{return(h||c)(b)}catch(d){return a(d),i(d)}},u=function(b){try{return(j||d)(b)}catch(c){return a(c),i(c)}};b(function(){g(f).then(function(a){k||(k=!0,m.resolve(g(a).then(l,u)))},function(a){k||(k=!0,m.resolve(u(a)))})});return m.promise},all:function(a){var b=e(),c=0,d=F(a)?[]:{};n(a,function(a,e){c++;g(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});c===0&&b.resolve(d);return b.promise}}}function Vc(){var b={};this.when=function(a,c){b[a]=t({reloadOnSearch:!0,caseInsensitiveMatch:!1},c);if(a){var d=a[a.length-1]=="/"?a.substr(0,a.length-1):a+"/";b[d]={redirectTo:a}}return this};this.otherwise=function(a){this.when(null,a);return this};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache",function(a,c,d,e,g,i,f){function h(a,b,c){for(var b="^"+b.replace(/[-\/\\^$:*+?.()|[\]{}]/g,"\\$&")+"$",d="",e=[],f={},j=/\\([:*])(\w+)/g,g,i=0;(g=j.exec(b))!==null;){d+=b.slice(i,g.index);switch(g[1]){case":":d+="([^\\/]*)";break;case"*":d+="(.*)"}e.push(g[2]);i=j.lastIndex}d+=b.substr(i);var h=a.match(RegExp(d,c.caseInsensitiveMatch?"i":""));h&&n(e,function(a,b){f[a]=h[b+1]});return h?f:null}function j(){var b=m(),j=u.current;if(b&&j&&b.$$route===j.$$route&&ia(b.pathParams,j.pathParams)&&!b.reloadOnSearch&&!l)j.params=b.params,V(j.params,d),a.$broadcast("$routeUpdate",j);else if(b||j)l=!1,a.$broadcast("$routeChangeStart",b,j),(u.current=b)&&b.redirectTo&&(E(b.redirectTo)?c.path(k(b.redirectTo,b.params)).search(b.params).replace():c.url(b.redirectTo(b.pathParams,c.path(),c.search())).replace()),e.when(b).then(function(){if(b){var a=t({},b.resolve),c;n(a,function(b,c){a[c]=E(b)?g.get(b):g.invoke(b)});if(B(c=b.template))H(c)&&(c=c(b.params));else if(B(c=b.templateUrl))if(H(c)&&(c=c(b.params)),B(c))b.loadedTemplateUrl=c,c=i.get(c,{cache:f}).then(function(a){return a.data});B(c)&&(a.$template=c);return e.all(a)}}).then(function(c){if(b==u.current){if(b)b.locals=c,V(b.params,d);a.$broadcast("$routeChangeSuccess",b,j)}},function(c){b==u.current&&a.$broadcast("$routeChangeError",b,j,c)})}function m(){var a,d;n(b,function(b,e){if(!d&&(a=h(c.path(),e,b)))d=tb(b,{params:t({},c.search(),a),pathParams:a}),d.$$route=b});return d||b[null]&&tb(b[null],{params:{},pathParams:{}})}function k(a,b){var c=[];n((a||"").split(":"),function(a,d){if(d==0)c.push(a);else{var e=a.match(/(\w+)(.*)/),f=e[1];c.push(b[f]);c.push(e[2]||"");delete b[f]}});return c.join("")}var l=!1,u={routes:b,reload:function(){l=!0;a.$evalAsync(j)}};a.$on("$locationChangeSuccess",j);return u}]}function Wc(){this.$get=S({})}function Xc(){var b=10;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse",function(a,c,d){function e(){this.$id=Fa();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;this.$$destroyed=!1;this.$$asyncQueue=[];this.$$listeners={};this.$$isolateBindings={}}function g(a){if(h.$$phase)throw Error(h.$$phase+" already in progress");h.$$phase=a}function i(a,b){var c=d(a);xa(c,b);return c}function f(){}e.prototype={$new:function(a){if(H(a))throw Error("API-CHANGE: Use $controller to instantiate controllers.");a?(a=new e,a.$root=this.$root):(a=function(){},a.prototype=this,a=new a,a.$id=Fa());a["this"]=a;a.$$listeners={};a.$parent=this;a.$$watchers=a.$$nextSibling=a.$$childHead=a.$$childTail=null;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,c){var d=i(a,"watch"),e=this.$$watchers,g={fn:b,last:f,get:d,exp:a,eq:!!c};if(!H(b)){var h=i(b||q,"listener");g.fn=function(a,b,c){h(c)}}if(typeof a=="string"&&d.constant){var r=g.fn;g.fn=function(a,b,c){r.call(this,a,b,c);ta(e,g)}}if(!e)e=this.$$watchers=[];e.unshift(g);return function(){ta(e,g)}},$watchCollection:function(a,b){var c=this,e,f,g=0,i=d(a),h=[],n={},x=0;return this.$watch(function(){f=i(c);var a,b;if(L(f))if(Xa(f)){if(e!==h)e=h,x=e.length=0,g++;a=f.length;if(x!==a)g++,e.length=x=a;for(b=0;b<a;b++)e[b]!==f[b]&&(g++,e[b]=f[b])}else{e!==n&&(e=n={},x=0,g++);a=0;for(b in f)f.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?e[b]!==f[b]&&(g++,e[b]=f[b]):(x++,e[b]=f[b],g++));if(x>a)for(b in g++,e)e.hasOwnProperty(b)&&!f.hasOwnProperty(b)&&(x--,delete e[b])}else e!==f&&(e=f,g++);return g},function(){b(f,e,c)})},$digest:function(){var a,d,e,i,u=this.$$asyncQueue,o,z,r=b,n,x=[],p,v;g("$digest");do{z=!1;for(n=this;u.length;)try{n.$eval(u.shift())}catch(A){c(A)}do{if(i=n.$$watchers)for(o=i.length;o--;)try{if(a=i[o],(d=a.get(n))!==(e=a.last)&&!(a.eq?ia(d,e):typeof d=="number"&&typeof e=="number"&&isNaN(d)&&isNaN(e)))z=!0,a.last=a.eq?V(d):d,a.fn(d,e===f?d:e,n),r<5&&(p=4-r,x[p]||(x[p]=[]),v=H(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,v+="; newVal: "+ha(d)+"; oldVal: "+ha(e),x[p].push(v))}catch(G){c(G)}if(!(i=n.$$childHead||n!==this&&n.$$nextSibling))for(;n!==this&&!(i=n.$$nextSibling);)n=n.$parent}while(n=i);if(z&&!r--)throw h.$$phase=null,Error(b+" $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: "+ha(x));}while(z||u.length);h.$$phase=null},$destroy:function(){if(!(h==this||this.$$destroyed)){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;if(a.$$childHead==this)a.$$childHead=this.$$nextSibling;if(a.$$childTail==this)a.$$childTail=this.$$prevSibling;if(this.$$prevSibling)this.$$prevSibling.$$nextSibling=this.$$nextSibling;if(this.$$nextSibling)this.$$nextSibling.$$prevSibling=this.$$prevSibling;this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null}},$eval:function(a,b){return d(a)(this,b)},$evalAsync:function(a){this.$$asyncQueue.push(a)},$apply:function(a){try{return g("$apply"),this.$eval(a)}catch(b){c(b)}finally{h.$$phase=null;try{h.$digest()}catch(d){throw c(d),d;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);return function(){c[Ga(c,b)]=null}},$emit:function(a,b){var d=[],e,f=this,g=!1,i={name:a,targetScope:f,stopPropagation:function(){g=!0},preventDefault:function(){i.defaultPrevented=!0},defaultPrevented:!1},h=[i].concat(ka.call(arguments,1)),n,x;do{e=f.$$listeners[a]||d;i.currentScope=f;n=0;for(x=e.length;n<x;n++)if(e[n])try{if(e[n].apply(null,h),g)return i}catch(p){c(p)}else e.splice(n,1),n--,x--;f=f.$parent}while(f);return i},$broadcast:function(a,b){var d=this,e=this,f={name:a,targetScope:this,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1},g=[f].concat(ka.call(arguments,1)),i,h;do{d=e;f.currentScope=d;e=d.$$listeners[a]||[];i=0;for(h=e.length;i<h;i++)if(e[i])try{e[i].apply(null,g)}catch(n){c(n)}else e.splice(i,1),i--,h--;if(!(e=d.$$childHead||d!==this&&d.$$nextSibling))for(;d!==this&&!(e=d.$$nextSibling);)d=d.$parent}while(d=e);return f}};var h=new e;return h}]}function Yc(){this.$get=["$window","$document",function(b,a){var c={},d=N((/android (\d+)/.exec(I((b.navigator||{}).userAgent))||[])[1]),e=a[0]||{},g,i=/^(Moz|webkit|O|ms)(?=[A-Z])/,f=e.body&&e.body.style,h=!1,j=!1;if(f){for(var m in f)if(h=i.exec(m)){g=h[0];g=g.substr(0,1).toUpperCase()+g.substr(1);break}h=!!("transition"in f||g+"Transition"in f);j=!!("animation"in f||g+"Animation"in f)}return{history:!(!b.history||!b.history.pushState||d<4),hashchange:"onhashchange"in b&&(!e.documentMode||e.documentMode>7),hasEvent:function(a){if(a=="input"&&Z==9)return!1;if(C(c[a])){var b=e.createElement("div");c[a]="on"+a in b}return c[a]},csp:e.securityPolicy?e.securityPolicy.isActive:!1,vendorPrefix:g,transitions:h,animations:j}}]}function Zc(){this.$get=S(M)}function Wb(b){var a={},c,d,e;if(!b)return a;n(b.split("\n"),function(b){e=b.indexOf(":");c=I(U(b.substr(0,e)));d=U(b.substr(e+1));c&&(a[c]?a[c]+=", "+d:a[c]=d)});return a}function $c(b,a){var c=ad.exec(b);if(c==null)return!0;var d={protocol:c[2],host:c[4],port:N(c[6])||Oa[c[2]]||null,relativeProtocol:c[2]===p||c[2]===""},c=jb.exec(a),c={protocol:c[1],host:c[3],port:N(c[5])||Oa[c[1]]||null};return(d.protocol==c.protocol||d.relativeProtocol)&&d.host==c.host&&(d.port==c.port||d.relativeProtocol&&c.port==Oa[c.protocol])}function Xb(b){var a=L(b)?b:p;return function(c){a||(a=Wb(b));return c?a[I(c)]||null:a}}function Yb(b,a,c){if(H(c))return c(b,a);n(c,function(c){b=c(b,a)});return b}function bd(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){E(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=ub(d,!0)));return d}],transformRequest:[function(a){return L(a)&&Ea.apply(a)!=="[object File]"?ha(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:d,put:d,patch:d},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},g=this.interceptors=[],i=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,k,l){function u(a){function c(a){var b=t({},a,{data:Yb(a.data,a.headers,d.transformResponse)});return 200<=a.status&&a.status<300?b:k.reject(b)}var d={transformRequest:e.transformRequest,transformResponse:e.transformResponse},f={};t(d,a);d.headers=f;d.method=oa(d.method);t(f,e.headers.common,e.headers[I(d.method)],a.headers);(a=$c(d.url,b.url())?b.cookies()[d.xsrfCookieName||e.xsrfCookieName]:p)&&(f[d.xsrfHeaderName||e.xsrfHeaderName]=a);var g=[function(a){var b=Yb(a.data,Xb(f),a.transformRequest);C(a.data)&&delete f["Content-Type"];if(C(a.withCredentials)&&!C(e.withCredentials))a.withCredentials=e.withCredentials;return o(a,b,f).then(c,c)},p],j=k.when(d);for(n(y,function(a){(a.request||a.requestError)&&g.unshift(a.request,a.requestError);(a.response||a.responseError)&&g.push(a.response,a.responseError)});g.length;)var a=g.shift(),i=g.shift(),j=j.then(a,i);j.success=function(a){j.then(function(b){a(b.data,b.status,b.headers,d)});return j};j.error=function(a){j.then(null,function(b){a(b.data,b.status,b.headers,d)});return j};return j}function o(b,c,g){function j(a,b,c){n&&(200<=a&&a<300?n.put(s,[a,b,Wb(c)]):n.remove(s));i(b,a,c);d.$$phase||d.$apply()}function i(a,c,d){c=Math.max(c,0);(200<=c&&c<300?l.resolve:l.reject)({data:a,status:c,headers:Xb(d),config:b})}function h(){var a=Ga(u.pendingRequests,b);a!==-1&&u.pendingRequests.splice(a,1)}var l=k.defer(),o=l.promise,n,p,s=z(b.url,b.params);u.pendingRequests.push(b);o.then(h,h);if((b.cache||e.cache)&&b.cache!==!1&&b.method=="GET")n=L(b.cache)?b.cache:L(e.cache)?e.cache:r;if(n)if(p=n.get(s))if(p.then)return p.then(h,h),p;else F(p)?i(p[1],p[0],V(p[2])):i(p,200,{});else n.put(s,o);p||a(b.method,s,c,j,g,b.timeout,b.withCredentials,b.responseType);return o}function z(a,b){if(!b)return a;var c=[];nc(b,function(a,b){a==null||a==p||(F(a)||(a=[a]),n(a,function(a){L(a)&&(a=ha(a));c.push(wa(b)+"="+wa(a))}))});return a+(a.indexOf("?")==-1?"?":"&")+c.join("&")}var r=c("$http"),y=[];n(g,function(a){y.unshift(E(a)?l.get(a):l.invoke(a))});n(i,function(a,b){var c=E(a)?l.get(a):l.invoke(a);y.splice(b,0,{response:function(a){return c(k.when(a))},responseError:function(a){return c(k.reject(a))}})});u.pendingRequests=[];(function(a){n(arguments,function(a){u[a]=function(b,c){return u(t(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){n(arguments,function(a){u[a]=function(b,c,d){return u(t(d||{},{method:a,url:b,data:c}))}})})("post","put");u.defaults=e;return u}]}function cd(){this.$get=["$browser","$window","$document",function(b,a,c){return dd(b,ed,b.defer,a.angular.callbacks,c[0],a.location.protocol.replace(":",""))}]}
function dd(b,a,c,d,e,g){function i(a,b){var c=e.createElement("script"),d=function(){e.body.removeChild(c);b&&b()};c.type="text/javascript";c.src=a;Z?c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&d()}:c.onload=c.onerror=d;e.body.appendChild(c);return d}return function(e,h,j,m,k,l,u,o){function z(){p=-1;t&&t();v&&v.abort()}function r(a,d,e,f){var j=(h.match(jb)||["",g])[1];A&&c.cancel(A);t=v=null;d=j=="file"?e?200:404:d;a(d==1223?204:d,e,f);b.$$completeOutstandingRequest(q)}
var p;b.$$incOutstandingRequestCount();h=h||b.url();if(I(e)=="jsonp"){var x="_"+(d.counter++).toString(36);d[x]=function(a){d[x].data=a};var t=i(h.replace("JSON_CALLBACK","angular.callbacks."+x),function(){d[x].data?r(m,200,d[x].data):r(m,p||-2);delete d[x]})}else{var v=new a;v.open(e,h,!0);n(k,function(a,b){a&&v.setRequestHeader(b,a)});v.onreadystatechange=function(){if(v.readyState==4){var a=v.getAllResponseHeaders(),b=["Cache-Control","Content-Language","Content-Type","Expires","Last-Modified","Pragma"];a||(a="",n(b,function(b){var c=v.getResponseHeader(b);c&&(a+=b+": "+c+"\n")}));r(m,p||v.status,v.responseType?v.response:v.responseText,a)}};if(u)v.withCredentials=!0;if(o)v.responseType=o;v.send(j||"")}if(l>0)var A=c(z,l);else l&&l.then&&l.then(z)}}function fd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return b===1?"one":"other"}}}}function gd(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,f,h){var j=c.defer(),m=j.promise,k=B(h)&&!h,f=a.defer(function(){try{j.resolve(e())}catch(a){j.reject(a),d(a)}k||b.$apply()},f),h=function(){delete g[m.$$timeoutId]};m.$$timeoutId=f;g[f]=j;m.then(h,h);return m}var g={};e.cancel=function(b){return b&&b.$$timeoutId in
g?(g[b.$$timeoutId].reject("canceled"),a.defer.cancel(b.$$timeoutId)):!1};return e}]}function Zb(b){function a(a,e){return b.factory(a+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",$b);a("date",ac);a("filter",hd);a("json",id);a("limitTo",jd);a("lowercase",kd);a("number",bc);a("orderBy",cc);a("uppercase",ld)}function hd(){return function(b,a,c){if(!F(b))return b;var d=[];d.check=function(a){for(var b=0;b<d.length;b++)if(!d[b](a))return!1;return!0};switch(typeof c){case"function":break;case"boolean":if(c==!0){c=function(a,b){return Ha.equals(a,b)};break}default:c=function(a,b){b=(""+b).toLowerCase();return(""+a).toLowerCase().indexOf(b)>-1}}var e=function(a,b){if(typeof b=="string"&&b.charAt(0)==="!")return!e(a,b.substr(1));switch(typeof a){case"boolean":case"number":case"string":return c(a,b);case"object":switch(typeof b){case"object":return c(a,b);default:for(var d in a)if(d.charAt(0)!=="$"&&e(a[d],b))return!0}return!1;case"array":for(d=0;d<a.length;d++)if(e(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case"boolean":case"number":case"string":a={$:a};case"object":for(var g in a)g=="$"?function(){if(a[g]){var b=g;d.push(function(c){return e(c,a[b])})}}():function(){if(a[g]){var b=g;d.push(function(c){return e(ib(c,b),a[b])})}}();break;case"function":d.push(a);break;default:return b}for(var i=[],f=0;f<b.length;f++){var h=b[f];d.check(h)&&i.push(h)}return i}}function $b(b){var a=b.NUMBER_FORMATS;return function(b,d){if(C(d))d=a.CURRENCY_SYM;return dc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function bc(b){var a=b.NUMBER_FORMATS;return function(b,d){return dc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function dc(b,a,c,d,e){if(isNaN(b)||!isFinite(b))return"";var g=b<0,b=Math.abs(b),i=b+"",f="",h=[],j=!1;if(i.indexOf("e")!==-1){var m=i.match(/([\d\.]+)e(-?)(\d+)/);m&&m[2]=="-"&&m[3]>e+1?i="0":(f=i,j=!0)}if(!j){i=(i.split(ec)[1]||"").length;C(e)&&(e=Math.min(Math.max(a.minFrac,i),a.maxFrac));var i=Math.pow(10,e),b=Math.round(b*i)/i,b=(""+b).split(ec),i=b[0],b=b[1]||"",j=0,m=a.lgSize,k=a.gSize;if(i.length>=m+k)for(var j=i.length-m,l=0;l<j;l++)(j-l)%k===0&&l!==0&&(f+=c),f+=i.charAt(l);for(l=j;l<i.length;l++)(i.length-l)%m===0&&l!==0&&(f+=c),f+=i.charAt(l);for(;b.length<e;)b+="0";e&&e!=="0"&&(f+=d+b.substr(0,e))}h.push(g?a.negPre:a.posPre);h.push(f);h.push(g?a.negSuf:a.posSuf);return h.join("")}function nb(b,a,c){var d="";b<0&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function Q(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(c>0||e>-c)e+=c;e===0&&c==-12&&(e=12);return nb(e,a,d)}}function Qa(b,a){return function(c,d){var e=c["get"+b](),g=oa(a?"SHORT"+b:b);return d[g][e]}}function ac(b){function a(a){var b;if(b=a.match(c)){var a=new Date(0),g=0,i=0,f=b[8]?a.setUTCFullYear:a.setFullYear,h=b[8]?a.setUTCHours:a.setHours;b[9]&&(g=N(b[9]+b[10]),i=N(b[9]+b[11]));f.call(a,N(b[1]),N(b[2])-1,N(b[3]));g=N(b[4]||0)-g;i=N(b[5]||0)-i;f=N(b[6]||0);b=Math.round(parseFloat("0."+(b[7]||0))*1E3);h.call(a,g,i,f,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var g="",i=[],f,h,e=e||"mediumDate",e=b.DATETIME_FORMATS[e]||e;E(c)&&(c=md.test(c)?N(c):a(c));Ya(c)&&(c=new Date(c));if(!ra(c))return c;for(;e;)(h=nd.exec(e))?(i=i.concat(ka.call(h,1)),e=i.pop()):(i.push(e),e=null);n(i,function(a){f=od[a];g+=f?f(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function id(){return function(b){return ha(b,!0)}}function jd(){return function(b,a){if(!F(b)&&!E(b))return b;a=N(a);if(E(b))return a?a>=0?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);a>0?(d=0,e=a):(d=b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function cc(b){return function(a,c,d){function e(a,b){return ua(b)?function(b,c){return a(c,b)}:a}if(!F(a))return a;if(!c)return a;for(var c=F(c)?c:[c],c=Za(c,function(a){var c=!1,d=a||qa;if(E(a)){if(a.charAt(0)=="+"||a.charAt(0)=="-")c=a.charAt(0)=="-",a=a.substring(1);d=b(a)}return e(function(a,b){var c;c=d(a);var e=d(b),f=typeof c,g=typeof e;f==g?(f=="string"&&(c=c.toLowerCase()),f=="string"&&(e=e.toLowerCase()),c=c===e?0:c<e?-1:1):c=f<g?-1:1;return c},c)}),g=[],i=0;i<a.length;i++)g.push(a[i]);return g.sort(e(function(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(e!==0)return e}return 0},d))}}function aa(b){H(b)&&(b={link:b});b.restrict=b.restrict||"AC";return S(b)}function fc(b,a){function c(a,c){c=c?"-"+bb(c,"-"):"";b.removeClass((a?Ra:Sa)+c).addClass((a?Sa:Ra)+c)}var d=this,e=b.parent().controller("form")||Ta,g=0,i=d.$error={},f=[];d.$name=a.name;d.$dirty=!1;d.$pristine=!0;d.$valid=!0;d.$invalid=!1;e.$addControl(d);b.addClass(pa);c(!0);d.$addControl=function(a){f.push(a);a.$name&&!d.hasOwnProperty(a.$name)&&(d[a.$name]=a)};d.$removeControl=function(a){a.$name&&d[a.$name]===a&&delete d[a.$name];n(i,function(b,c){d.$setValidity(c,!0,a)});ta(f,a)};d.$setValidity=function(a,b,f){var k=i[a];if(b){if(k&&(ta(k,f),!k.length)){g--;if(!g)c(b),d.$valid=!0,d.$invalid=!1;i[a]=!1;c(!0,a);e.$setValidity(a,!0,d)}}else{g||c(b);if(k){if(Ga(k,f)!=-1)return}else i[a]=k=[],g++,c(!1,a),e.$setValidity(a,!1,d);k.push(f);d.$valid=!1;d.$invalid=!0}};d.$setDirty=function(){b.removeClass(pa).addClass(Ua);d.$dirty=!0;d.$pristine=!1;e.$setDirty()};d.$setPristine=function(){b.removeClass(Ua).addClass(pa);d.$dirty=!1;d.$pristine=!0;n(f,function(a){a.$setPristine()})}}
function X(b){return C(b)||b===""||b===null||b!==b}function Va(b,a,c,d,e,g){var i=function(){var e=a.val();if(ua(c.ngTrim||"T"))e=U(e);d.$viewValue!==e&&b.$apply(function(){d.$setViewValue(e)})};if(e.hasEvent("input"))a.bind("input",i);else{var f,h=function(){f||(f=g.defer(function(){i();f=null}))};a.bind("keydown",function(a){a=a.keyCode;a===91||15<a&&a<19||37<=a&&a<=40||h()});a.bind("change",i);e.hasEvent("paste")&&a.bind("paste cut",h)}d.$render=function(){a.val(X(d.$viewValue)?"":d.$viewValue)};var j=c.ngPattern,m=function(a,b){return X(b)||a.test(b)?(d.$setValidity("pattern",!0),b):(d.$setValidity("pattern",!1),p)};j&&((e=j.match(/^\/(.*)\/([gim]*)$/))?(j=RegExp(e[1],e[2]),e=function(a){return m(j,a)}):e=function(a){var c=b.$eval(j);if(!c||!c.test)throw Error("Expected "+j+" to be a RegExp but was "+c);return m(c,a)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var k=N(c.ngMinlength),e=function(a){return!X(a)&&a.length<k?(d.$setValidity("minlength",!1),p):(d.$setValidity("minlength",!0),a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var l=N(c.ngMaxlength),e=function(a){return!X(a)&&a.length>l?(d.$setValidity("maxlength",!1),p):(d.$setValidity("maxlength",!0),a)};d.$parsers.push(e);d.$formatters.push(e)}}function ob(b,a){b="ngClass"+b;return aa(function(c,d,e){function g(b){if(a===!0||c.$index%2===a)h&&!ia(b,h)&&i(h),f(b);h=V(b)}function i(a){L(a)&&!F(a)&&(a=Za(a,function(a,b){if(a)return b}));d.removeClass(F(a)?a.join(" "):a)}function f(a){L(a)&&!F(a)&&(a=Za(a,function(a,b){if(a)return b}));a&&d.addClass(F(a)?a.join(" "):a)}var h=p;c.$watch(e[b],g,!0);e.$observe("class",function(){var a=c.$eval(e[b]);g(a,a)});b!=="ngClass"&&c.$watch("$index",function(d,g){var h=d&1;h!==g&1&&(h===a?f(c.$eval(e[b])):i(c.$eval(e[b])))})})}var I=function(b){return E(b)?b.toLowerCase():b},oa=function(b){return E(b)?b.toUpperCase():b},Z=N((/msie (\d+)/.exec(I(navigator.userAgent))||[])[1]),w,ga,ka=[].slice,Wa=[].push,Ea=Object.prototype.toString,mc=M.angular,Ha=M.angular||(M.angular={}),Aa,hb,ba=["0","0","0"];q.$inject=[];qa.$inject=[];hb=Z<9?function(b){b=b.nodeName?b:b[0];return b.scopeName&&b.scopeName!="HTML"?oa(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var sc=/[A-Z]/g,pd={full:"1.1.5",major:1,minor:1,dot:5,codeName:"triangle-squarification"},Ka=R.cache={},Ja=R.expando="ng-"+(new Date).getTime(),wc=1,gc=M.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},gb=M.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)},uc=/([\:\-\_]+(.))/g,vc=/^moz([A-Z])/,Ba=R.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;T.readyState==="complete"?setTimeout(a):(this.bind("DOMContentLoaded",a),R(M).bind("load",a))},toString:function(){var b=[];n(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return b>=0?w(this[b]):w(this[this.length+b])},length:0,push:Wa,sort:[].sort,splice:[].splice},Na={};n("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(b){Na[I(b)]=b});var Gb={};n("input,select,option,textarea,button,form,details".split(","),function(b){Gb[oa(b)]=!0});n({data:Bb,inheritedData:Ma,scope:function(b){return Ma(b,"$scope")},controller:Eb,injector:function(b){return Ma(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:La,css:function(b,a,c){a=Ia(a);if(B(c))b.style[a]=c;else{var d;Z<=8&&(d=b.currentStyle&&b.currentStyle[a],d===""&&(d="auto"));d=d||b.style[a];Z<=8&&(d=d===""?p:d);return d}},attr:function(b,a,c){var d=I(a);if(Na[d])if(B(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||q).specified?d:p;else if(B(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),b===null?p:b},prop:function(b,a,c){if(B(c))b[a]=c;else return b[a]},text:t(Z<9?function(b,a){if(b.nodeType==1){if(C(a))return b.innerText;b.innerText=a}else{if(C(a))return b.nodeValue;b.nodeValue=a}}:function(b,a){if(C(a))return b.textContent;b.textContent=a},{$dv:""}),val:function(b,a){if(C(a))return b.value;b.value=a},html:function(b,a){if(C(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)ya(d[c]);b.innerHTML=a}},function(b,a){R.prototype[a]=function(a,d){var e,g;if((b.length==2&&b!==La&&b!==Eb?a:d)===p)if(L(a)){for(e=0;e<this.length;e++)if(b===Bb)b(this[e],a);else for(g in a)b(this[e],g,a[g]);return this}else{if(this.length)return b(this[0],a,d)}else{for(e=0;e<this.length;e++)b(this[e],a,d);return this}return b.$dv}});n({removeData:zb,dealoc:ya,bind:function a(c,d,e){var g=ca(c,"events"),i=ca(c,"handle");g||ca(c,"events",g={});i||ca(c,"handle",i=xc(c,g));n(d.split(" "),function(d){var h=g[d];if(!h){if(d=="mouseenter"||d=="mouseleave"){var j=T.body.contains||T.body.compareDocumentPosition?function(a,c){var d=a.nodeType===9?a.documentElement:a,e=c&&c.parentNode;return a===e||!(!e||!(e.nodeType===1&&(d.contains?d.contains(e):a.compareDocumentPosition&&a.compareDocumentPosition(e)&16)))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};g[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;(!c||c!==this&&!j(this,c))&&i(a,d)})}else gc(c,d,i),g[d]=[];h=g[d]}h.push(e)})},unbind:Ab,replaceWith:function(a,c){var d,e=a.parentNode;ya(a);n(new R(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];n(a.childNodes,function(a){a.nodeType===1&&c.push(a)});return c},contents:function(a){return a.childNodes||[]},append:function(a,c){n(new R(c),function(c){(a.nodeType===1||a.nodeType===11)&&a.appendChild(c)})},prepend:function(a,c){if(a.nodeType===1){var d=a.firstChild;n(new R(c),function(c){d?a.insertBefore(c,d):(a.appendChild(c),d=c)})}},wrap:function(a,c){var c=w(c)[0],d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){ya(a);var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;n(new R(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:Db,removeClass:Cb,toggleClass:function(a,c,d){C(d)&&(d=!La(a,c));(d?Db:Cb)(a,c)},parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;a!=null&&a.nodeType!==1;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName(c)},clone:fb,triggerHandler:function(a,c){var d=(ca(a,"events")||{})[c];n(d,function(c){c.call(a,{preventDefault:q})})}},function(a,c){R.prototype[c]=function(c,e){for(var g,i=0;i<this.length;i++)g==p?(g=a(this[i],c,e),g!==p&&(g=w(g))):eb(g,a(this[i],c,e));return g==p?this:g}});za.prototype={put:function(a,c){this[la(a)]=c},get:function(a){return this[la(a)]},remove:function(a){var c=this[a=la(a)];delete this[a];return c}};var zc=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,Ac=/,/,Bc=/^\s*(_?)(\S+?)\1\s*$/,yc=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;Ib.$inject=["$provide"];var qd=function(){var a="$ngAnimateController",c={running:!0};this.$get=["$animation","$window","$sniffer","$rootElement","$rootScope",function(d,e,g,i){i.data(a,c);i=function(c,i){function j(j,k,o){return function(m,r,p){function x(a){var c=0,a=E(a)?a.split(/\s*,\s*/):[];n(a,function(a){c=Math.max(parseFloat(a)||0,c)});return c}function t(){m.addClass(K);if($)$(m,v,P);else if(H(e.getComputedStyle)){var a=g.vendorPrefix+"Animation",c=g.vendorPrefix+"Transition",d=0;n(m,function(f){if(f.nodeType==1){var g="transition",i=c,j=1,h=e.getComputedStyle(f)||{};if(parseFloat(h.animationDuration)>0||parseFloat(h[a+"Duration"])>0)g="animation",i=a,j=Math.max(parseInt(h[g+"IterationCount"])||0,parseInt(h[i+"IterationCount"])||0,j);f=Math.max(x(h[g+"Delay"]),x(h[i+"Delay"]));g=Math.max(x(h[g+"Duration"]),x(h[i+"Duration"]));d=Math.max(f+j*g,d)}});e.setTimeout(v,d*1E3)}else v()}function v(){if(!v.run)v.run=!0,o(m,r,p),m.removeClass(w),m.removeClass(K),m.removeData(a)}var A=c.$eval(i.ngAnimate),w=A?L(A)?A[j]:A+"-"+j:"",D=d(w),A=D&&D.setup,$=D&&D.start,D=D&&D.cancel;if(w){var K=w+"-active";r||(r=p?p.parent():m.parent());if(!g.transitions&&!A&&!$||(r.inheritedData(a)||q).running)k(m,r,p),o(m,r,p);else{var O=m.data(a)||{};O.running&&((D||q)(m),O.done());m.data(a,{running:!0,done:v});m.addClass(w);k(m,r,p);if(m.length==0)return v();var P=(A||q)(m);e.setTimeout(t,1)}}else k(m,r,p),o(m,r,p)}}function m(a,c,d){d?d.after(a):c.append(a)}var k={};k.enter=j("enter",m,q);k.leave=j("leave",q,function(a){a.remove()});k.move=j("move",function(a,c,d){m(a,c,d)},q);k.show=j("show",function(a){a.css("display","")},q);k.hide=j("hide",q,function(a){a.css("display","none")});k.animate=function(a,c){j(a,q,q)(c)};return k};i.enabled=function(a){if(arguments.length)c.running=!a;return!c.running};return i}]},Kb="Non-assignable model expression: ";Jb.$inject=["$provide"];var Ic=/^(x[\:\-_]|data[\:\-_])/i,jb=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,Pb=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Oa={http:80,https:443,ftp:21};Rb.prototype=lb.prototype=Qb.prototype={$$replace:!1,absUrl:Pa("$$absUrl"),url:function(a,c){if(C(a))return this.$$url;var d=Pb.exec(a);d[1]&&this.path(decodeURIComponent(d[1]));if(d[2]||d[1])this.search(d[3]||"");this.hash(d[5]||"",c);return this},protocol:Pa("$$protocol"),host:Pa("$$host"),port:Pa("$$port"),path:Sb("$$path",function(a){return a.charAt(0)=="/"?a:"/"+a}),search:function(a,c){if(C(a))return this.$$search;B(c)?c===null?delete this.$$search[a]:this.$$search[a]=c:this.$$search=E(a)?vb(a):a;this.$$compose();return this},hash:Sb("$$hash",qa),replace:function(){this.$$replace=!0;return this}};var Da={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:q,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return B(d)?B(e)?d+e:d:B(e)?e:p},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);return(B(d)?d:0)-(B(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":q,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Qc={n:"\n",f:"\u000c",r:"\r",t:"\t",v:"\u000b","'":"'",'"':'"'},mb={},ad=/^(([^:]+):)?\/\/(\w+:{0,1}\w*@)?([\w\.-]*)?(:([0-9]+))?(.*)$/,ed=M.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(d){}throw Error("This browser does not support XMLHttpRequest.");};Zb.$inject=["$provide"];$b.$inject=["$locale"];bc.$inject=["$locale"];var ec=".",od={yyyy:Q("FullYear",4),yy:Q("FullYear",2,0,!0),y:Q("FullYear",1),MMMM:Qa("Month"),MMM:Qa("Month",!0),MM:Q("Month",2,1),M:Q("Month",1,1),dd:Q("Date",2),d:Q("Date",1),HH:Q("Hours",2),H:Q("Hours",1),hh:Q("Hours",2,-12),h:Q("Hours",1,-12),mm:Q("Minutes",2),m:Q("Minutes",1),ss:Q("Seconds",2),s:Q("Seconds",1),sss:Q("Milliseconds",3),EEEE:Qa("Day"),EEE:Qa("Day",!0),a:function(a,c){return a.getHours()<12?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){var a=-1*a.getTimezoneOffset(),c=a>=0?"+":"";c+=nb(Math[a>0?"floor":"ceil"](a/60),2)+nb(Math.abs(a%60),2);return c}},nd=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,md=/^\d+$/;ac.$inject=["$locale"];var kd=S(I),ld=S(oa);cc.$inject=["$parse"];var rd=S({restrict:"E",compile:function(a,c){Z<=8&&(!c.href&&!c.name&&c.$set("href",""),a.append(T.createComment("IE fix")));return function(a,c){c.bind("click",function(a){c.attr("href")||a.preventDefault()})}}}),pb={};n(Na,function(a,c){var d=da("ng-"+c);pb[d]=function(){return{priority:100,compile:function(){return function(a,g,i){a.$watch(i[d],function(a){i.$set(c,!!a)})}}}}});n(["src","srcset","href"],function(a){var c=da("ng-"+a);pb[c]=function(){return{priority:99,link:function(d,e,g){g.$observe(c,function(c){c&&(g.$set(a,c),Z&&e.prop(a,g[a]))})}}}});var Ta={$addControl:q,$removeControl:q,$setValidity:q,$setDirty:q,$setPristine:q};fc.$inject=["$element","$attrs","$scope"];var Wa=function(a){return["$timeout",function(c){var d={name:"form",restrict:"E",controller:fc,compile:function(){return{pre:function(a,d,i,f){if(!i.action){var h=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};gc(d[0],"submit",h);d.bind("$destroy",function(){c(function(){gb(d[0],"submit",h)},0,!1)})}var j=d.parent().controller("form"),m=i.name||i.ngForm;m&&(a[m]=f);j&&d.bind("$destroy",function(){j.$removeControl(f);m&&(a[m]=p);t(f,Ta)})}}}};return a?t(V(d),{restrict:"EAC"}):d}]},sd=Wa(),td=Wa(!0),ud=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,vd=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,wd=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,hc={text:Va,number:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);e.$parsers.push(function(a){var c=X(a);return c||wd.test(a)?(e.$setValidity("number",!0),a===""?null:c?a:parseFloat(a)):(e.$setValidity("number",!1),p)});e.$formatters.push(function(a){return X(a)?"":""+a});if(d.min){var f=parseFloat(d.min),a=function(a){return!X(a)&&a<f?(e.$setValidity("min",!1),p):(e.$setValidity("min",!0),a)};e.$parsers.push(a);e.$formatters.push(a)}if(d.max){var h=parseFloat(d.max),d=function(a){return!X(a)&&a>h?(e.$setValidity("max",!1),p):(e.$setValidity("max",!0),a)};e.$parsers.push(d);e.$formatters.push(d)}e.$formatters.push(function(a){return X(a)||Ya(a)?(e.$setValidity("number",!0),a):(e.$setValidity("number",!1),p)})},url:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);a=function(a){return X(a)||ud.test(a)?(e.$setValidity("url",!0),a):(e.$setValidity("url",!1),p)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);a=function(a){return X(a)||vd.test(a)?(e.$setValidity("email",!0),a):(e.$setValidity("email",!1),p)};e.$formatters.push(a);e.$parsers.push(a)},radio:function(a,c,d,e){C(d.name)&&c.attr("name",Fa());c.bind("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var g=d.ngTrueValue,i=d.ngFalseValue;E(g)||(g=!0);E(i)||(i=!1);c.bind("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=e.$viewValue};e.$formatters.push(function(a){return a===g});e.$parsers.push(function(a){return a?g:i})},hidden:q,button:q,submit:q,reset:q},ic=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,g,i){i&&(hc[I(g.type)]||hc.text)(d,e,g,i,c,a)}}}],Sa="ng-valid",Ra="ng-invalid",pa="ng-pristine",Ua="ng-dirty",xd=["$scope","$exceptionHandler","$attrs","$element","$parse",function(a,c,d,e,g){function i(a,c){c=c?"-"+bb(c,"-"):"";e.removeClass((a?Ra:Sa)+c).addClass((a?Sa:Ra)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=d.name;var f=g(d.ngModel),h=f.assign;if(!h)throw Error(Kb+d.ngModel+" ("+va(e)+")");this.$render=q;var j=e.inheritedData("$formController")||Ta,m=0,k=this.$error={};e.addClass(pa);i(!0);this.$setValidity=function(a,c){if(k[a]!==!c){if(c){if(k[a]&&m--,!m)i(!0),this.$valid=!0,this.$invalid=!1}else i(!1),this.$invalid=!0,this.$valid=!1,m++;k[a]=!c;i(c,a);j.$setValidity(a,c,this)}};this.$setPristine=function(){this.$dirty=!1;this.$pristine=!0;e.removeClass(Ua).addClass(pa)};this.$setViewValue=function(d){this.$viewValue=d;if(this.$pristine)this.$dirty=!0,this.$pristine=!1,e.removeClass(pa).addClass(Ua),j.$setDirty();n(this.$parsers,function(a){d=a(d)});if(this.$modelValue!==d)this.$modelValue=d,h(a,d),n(this.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}})};var l=this;a.$watch(function(){var c=f(a);if(l.$modelValue!==c){var d=l.$formatters,e=d.length;for(l.$modelValue=c;e--;)c=d[e](c);if(l.$viewValue!==c)l.$viewValue=c,l.$render()}})}],yd=function(){return{require:["ngModel","^?form"],controller:xd,link:function(a,c,d,e){var g=e[0],i=e[1]||Ta;i.$addControl(g);c.bind("$destroy",function(){i.$removeControl(g)})}}},zd=S({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),jc=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var g=function(a){if(d.required&&(X(a)||a===!1))e.$setValidity("required",!1);else return e.$setValidity("required",!0),a};e.$formatters.push(g);e.$parsers.unshift(g);d.$observe("required",function(){g(e.$viewValue)})}}}},Ad=function(){return{require:"ngModel",link:function(a,c,d,e){var g=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){var c=[];a&&n(a.split(g),function(a){a&&c.push(U(a))});return c});e.$formatters.push(function(a){return F(a)?a.join(", "):p})}}},Bd=/^(true|false|\d+)$/,Cd=function(){return{priority:100,compile:function(a,c){return Bd.test(c.ngValue)?function(a,c,g){g.$set("value",a.$eval(g.ngValue))}:function(a,c,g){a.$watch(g.ngValue,function(a){g.$set("value",a,!1)})}}}},Dd=aa(function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBind);a.$watch(d.ngBind,function(a){c.text(a==p?"":a)})}),Ed=["$interpolate",function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],Fd=[function(){return function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBindHtmlUnsafe);a.$watch(d.ngBindHtmlUnsafe,function(a){c.html(a||"")})}}],Gd=ob("",!0),Hd=ob("Odd",0),Id=ob("Even",1),Jd=aa({compile:function(a,c){c.$set("ngCloak",p);a.removeClass("ng-cloak")}}),Kd=[function(){return{scope:!0,controller:"@"}}],Ld=["$sniffer",function(a){return{priority:1E3,compile:function(){a.csp=!0}}}],kc={};n("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress".split(" "),function(a){var c=da("ng-"+a);kc[c]=["$parse",function(d){return function(e,g,i){var f=d(i[c]);g.bind(I(a),function(a){e.$apply(function(){f(e,{$event:a})})})}}]});var Md=aa(function(a,c,d){c.bind("submit",function(){a.$apply(d.ngSubmit)})}),Nd=["$animator",function(a){return{transclude:"element",priority:1E3,terminal:!0,restrict:"A",compile:function(c,d,e){return function(c,d,f){var h=a(c,f),j,m;c.$watch(f.ngIf,function(a){j&&(h.leave(j),j=p);m&&(m.$destroy(),m=p);ua(a)&&(m=c.$new(),e(m,function(a){j=a;h.enter(a,d.parent(),d)}))})}}}}],Od=["$http","$templateCache","$anchorScroll","$compile","$animator",function(a,c,d,e,g){return{restrict:"ECA",terminal:!0,compile:function(i,f){var h=f.ngInclude||f.src,j=f.onload||"",m=f.autoscroll;return function(f,i,n){var o=g(f,n),p=0,r,t=function(){r&&(r.$destroy(),r=null);o.leave(i.contents(),i)};f.$watch(h,function(g){var h=++p;g?(a.get(g,{cache:c}).success(function(a){h===p&&(r&&r.$destroy(),r=f.$new(),o.leave(i.contents(),i),a=w("<div/>").html(a).contents(),o.enter(a,i),e(a)(r),B(m)&&(!m||f.$eval(m))&&d(),r.$emit("$includeContentLoaded"),f.$eval(j))}).error(function(){h===p&&t()}),f.$emit("$includeContentRequested")):t()})}}}}],Pd=aa({compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),Qd=aa({terminal:!0,priority:1E3}),Rd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,g,i){var f=i.count,h=g.attr(i.$attr.when),j=i.offset||0,m=e.$eval(h),k={},l=c.startSymbol(),p=c.endSymbol();n(m,function(a,e){k[e]=c(a.replace(d,l+f+"-"+j+p))});e.$watch(function(){var c=parseFloat(e.$eval(f));return isNaN(c)?"":(c in m||(c=a.pluralCat(c-j)),k[c](e,g,!0))},function(a){g.text(a)})}}}],Sd=["$parse","$animator",function(a,c){return{transclude:"element",priority:1E3,terminal:!0,compile:function(d,e,g){return function(d,e,h){var j=c(d,h),m=h.ngRepeat,k=m.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),l,p,o,z,r,t={$id:la};if(!k)throw Error("Expected ngRepeat in form of '_item_ in _collection_[ track by _id_]' but got '"+
m+"'.");h=k[1];o=k[2];(k=k[4])?(l=a(k),p=function(a,c,e){r&&(t[r]=a);t[z]=c;t.$index=e;return l(d,t)}):p=function(a,c){return la(c)};k=h.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!k)throw Error("'item' in 'item in collection' should be identifier or (key, value) but got '"+h+"'.");z=k[3]||k[1];r=k[2];var x={};d.$watchCollection(o,function(a){var c,h,k=e,l,o={},t,q,w,s,B,y,C=[];if(Xa(a))B=a;else{B=[];for(w in a)a.hasOwnProperty(w)&&w.charAt(0)!="$"&&B.push(w);B.sort()}t=B.length;h=C.length=B.length;for(c=0;c<h;c++)if(w=a===B?c:B[c],s=a[w],l=p(w,s,c),x.hasOwnProperty(l))y=x[l],delete x[l],o[l]=y,C[c]=y;else if(o.hasOwnProperty(l))throw n(C,function(a){a&&a.element&&(x[a.id]=a)}),Error("Duplicates in a repeater are not allowed. Repeater: "+m+" key: "+l);else C[c]={id:l},o[l]=!1;for(w in x)if(x.hasOwnProperty(w))y=x[w],j.leave(y.element),y.element[0].$$NG_REMOVED=!0,y.scope.$destroy();c=0;for(h=B.length;c<h;c++){w=a===B?c:B[c];s=a[w];y=C[c];if(y.element){q=y.scope;l=k[0];do l=l.nextSibling;while(l&&l.$$NG_REMOVED);y.element[0]!=l&&j.move(y.element,null,k);k=y.element}else q=d.$new();q[z]=s;r&&(q[r]=w);q.$index=c;q.$first=c===0;q.$last=c===t-1;q.$middle=!(q.$first||q.$last);y.element||g(q,function(a){j.enter(a,null,k);k=a;y.scope=q;y.element=a;o[y.id]=y})}x=o})}}}}],Td=["$animator",function(a){return function(c,d,e){var g=a(c,e);c.$watch(e.ngShow,function(a){g[ua(a)?"show":"hide"](d)})}}],Ud=["$animator",function(a){return function(c,d,e){var g=a(c,e);c.$watch(e.ngHide,function(a){g[ua(a)?"hide":"show"](d)})}}],Vd=aa(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&n(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Wd=["$animator",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,g){var i=a(c,e),f,h,j=[];c.$watch(e.ngSwitch||e.on,function(a){for(var d=0,l=j.length;d<l;d++)j[d].$destroy(),i.leave(h[d]);h=[];j=[];if(f=g.cases["!"+a]||g.cases["?"])c.$eval(e.change),n(f,function(a){var d=c.$new();j.push(d);a.transclude(d,function(c){var d=a.element;h.push(c);i.enter(c,d.parent(),d)})})})}}}],Xd=aa({transclude:"element",priority:500,require:"^ngSwitch",compile:function(a,c,d){return function(a,g,i,f){f.cases["!"+c.ngSwitchWhen]=f.cases["!"+c.ngSwitchWhen]||[];f.cases["!"+c.ngSwitchWhen].push({transclude:d,element:g})}}}),Yd=aa({transclude:"element",priority:500,require:"^ngSwitch",compile:function(a,c,d){return function(a,c,i,f){f.cases["?"]=f.cases["?"]||[];f.cases["?"].push({transclude:d,element:c})}}}),Zd=aa({controller:["$transclude","$element",function(a,c){a(function(a){c.append(a)})}]}),$d=["$http","$templateCache","$route","$anchorScroll","$compile","$controller","$animator",function(a,c,d,e,g,i,f){return{restrict:"ECA",terminal:!0,link:function(a,c,m){function k(){var f=d.current&&d.current.locals,k=f&&f.$template;if(k){o.leave(c.contents(),c);l&&(l.$destroy(),l=null);k=w("<div></div>").html(k).contents();o.enter(k,c);var k=g(k),m=d.current;l=m.scope=a.$new();if(m.controller)f.$scope=l,f=i(m.controller,f),m.controllerAs&&(l[m.controllerAs]=f),c.children().data("$ngControllerController",f);k(l);l.$emit("$viewContentLoaded");l.$eval(n);e()}else o.leave(c.contents(),c),l&&(l.$destroy(),l=null)}var l,n=m.onload||"",o=f(a,m);a.$on("$routeChangeSuccess",k);k()}}}],ae=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){d.type=="text/ng-template"&&a.put(d.id,c[0].text)}}}],be=S({terminal:!0}),ce=["$compile","$parse",function(a,c){var d=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/,e={$setViewValue:q};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var h=this,j={},m=e,k;h.databound=d.ngModel;h.init=function(a,c,d){m=a;k=d};h.addOption=function(c){j[c]=!0;m.$viewValue==c&&(a.val(c),k.parent()&&k.remove())};h.removeOption=function(a){this.hasOption(a)&&(delete j[a],m.$viewValue==a&&this.renderUnknownOption(a))};h.renderUnknownOption=function(c){c="? "+la(c)+" ?";k.val(c);a.prepend(k);a.val(c);k.prop("selected",!0)};h.hasOption=function(a){return j.hasOwnProperty(a)};c.$on("$destroy",function(){h.renderUnknownOption=q})}],link:function(e,i,f,h){function j(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(v.parent()&&v.remove(),c.val(a),a===""&&t.prop("selected",!0)):C(a)&&t?c.val(""):e.renderUnknownOption(a)};c.bind("change",function(){a.$apply(function(){v.parent()&&v.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;d.$render=function(){var a=new za(d.$viewValue);n(c.find("option"),function(c){c.selected=B(a.get(c.value))})};a.$watch(function(){ia(e,d.$viewValue)||(e=V(d.$viewValue),d.$render())});c.bind("change",function(){a.$apply(function(){var a=[];n(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function k(e,f,g){function i(){var a={"":[]},c=[""],d,h,q,v,s;q=g.$modelValue;v=u(e)||[];var z=l?qb(v):v,B,y,A;y={};s=!1;var C,D;if(o)if(t&&F(q)){s=new za([]);for(h=0;h<q.length;h++)y[k]=q[h],s.put(t(e,y),q[h])}else s=new za(q);for(A=0;B=z.length,A<B;A++){y[k]=v[l?y[l]=z[A]:A];d=m(e,y)||"";if(!(h=a[d]))h=a[d]=[],c.push(d);o?d=s.remove(t?t(e,y):n(e,y))!=p:(t?(d={},d[k]=q,d=t(e,d)===t(e,y)):d=q===n(e,y),s=s||d);C=j(e,y);C=C===p?"":C;h.push({id:t?t(e,y):l?z[A]:A,label:C,selected:d})}o||(r||q===null?a[""].unshift({id:"",label:"",selected:!s}):s||a[""].unshift({id:"?",label:"",selected:!0}));y=0;for(z=c.length;y<z;y++){d=c[y];h=a[d];if(w.length<=y)q={element:E.clone().attr("label",d),label:h.label},v=[q],w.push(v),f.append(q.element);else if(v=w[y],q=v[0],q.label!=d)q.element.attr("label",q.label=d);C=null;A=0;for(B=h.length;A<B;A++)if(d=h[A],s=v[A+1]){C=s.element;if(s.label!==d.label)C.text(s.label=d.label);if(s.id!==d.id)C.val(s.id=d.id);if(C[0].selected!==d.selected)C.prop("selected",s.selected=d.selected)}else d.id===""&&r?D=r:(D=x.clone()).val(d.id).attr("selected",d.selected).text(d.label),v.push({element:D,label:d.label,id:d.id,selected:d.selected}),C?C.after(D):q.element.append(D),C=D;for(A++;v.length>A;)v.pop().element.remove()}for(;w.length>y;)w.pop()[0].element.remove()}
var h;if(!(h=q.match(d)))throw Error("Expected ngOptions in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_ (track by _expr_)?' but got '"+q+"'.");var j=c(h[2]||h[1]),k=h[4]||h[6],l=h[5],m=c(h[3]||""),n=c(h[2]?h[1]:k),u=c(h[7]),t=h[8]?c(h[8]):null,w=[[{element:f,label:""}]];r&&(a(r)(e),r.removeClass("ng-scope"),r.remove());f.html("");f.bind("change",function(){e.$apply(function(){var a,c=u(e)||[],d={},h,i,j,m,q,r;if(o){i=[];m=0;for(r=w.length;m<r;m++){a=w[m];j=1;for(q=a.length;j<q;j++)if((h=a[j].element)[0].selected){h=h.val();l&&(d[l]=h);if(t)for(var s=0;s<c.length;s++){if(d[k]=c[s],t(e,d)==h)break}else d[k]=c[h];i.push(n(e,d))}}}else if(h=f.val(),h=="?")i=p;else if(h=="")i=null;else if(t)for(s=0;s<c.length;s++){if(d[k]=c[s],t(e,d)==h){i=n(e,d);break}}else d[k]=c[h],l&&(d[l]=h),i=n(e,d);g.$setViewValue(i)})});g.$render=i;e.$watch(i)}if(h[1]){for(var l=h[0],u=h[1],o=f.multiple,q=f.ngOptions,r=!1,t,x=w(T.createElement("option")),E=w(T.createElement("optgroup")),v=x.clone(),h=0,A=i.children(),G=A.length;h<G;h++)if(A[h].value==""){t=r=A.eq(h);break}l.init(u,r,v);if(o&&(f.required||f.ngRequired)){var D=function(a){u.$setValidity("required",!f.required||a&&a.length);return a};u.$parsers.push(D);u.$formatters.unshift(D);f.$observe("required",function(){D(u.$viewValue)})}q?k(e,i,u):o?m(e,i,u):j(e,i,u,l)}}}}],de=["$interpolate",function(a){var c={addOption:q,removeOption:q};return{restrict:"E",priority:100,compile:function(d,e){if(C(e.value)){var g=a(d.text(),!0);g||e.$set("value",d.text())}return function(a,d,e){var j=d.parent(),m=j.data("$selectController")||j.parent().data("$selectController");m&&m.databound?d.prop("selected",!1):m=c;g?a.$watch(g,function(a,c){e.$set("value",a);a!==c&&m.removeOption(c);m.addOption(a)}):m.addOption(e.value);d.bind("$destroy",function(){m.removeOption(e.value)})}}}}],ee=S({restrict:"E",terminal:!0});(ga=M.jQuery)?(w=ga,t(ga.fn,{scope:Ba.scope,controller:Ba.controller,injector:Ba.injector,inheritedData:Ba.inheritedData}),db("remove",!0),db("empty"),db("html")):w=R;Ha.element=w;(function(a){t(a,{bootstrap:xb,copy:V,extend:t,equals:ia,element:w,forEach:n,injector:yb,noop:q,bind:$a,toJson:ha,fromJson:ub,identity:qa,isUndefined:C,isDefined:B,isString:E,isFunction:H,isObject:L,isNumber:Ya,isElement:oc,isArray:F,version:pd,isDate:ra,lowercase:I,uppercase:oa,callbacks:{counter:0},noConflict:lc});Aa=tc(M);try{Aa("ngLocale")}catch(c){Aa("ngLocale",[]).provider("$locale",fd)}Aa("ng",["ngLocale"],["$provide",function(a){a.provider("$compile",Jb).directive({a:rd,input:ic,textarea:ic,form:sd,script:ae,select:ce,style:ee,option:de,ngBind:Dd,ngBindHtmlUnsafe:Fd,ngBindTemplate:Ed,ngClass:Gd,ngClassEven:Id,ngClassOdd:Hd,ngCsp:Ld,ngCloak:Jd,ngController:Kd,ngForm:td,ngHide:Ud,ngIf:Nd,ngInclude:Od,ngInit:Pd,ngNonBindable:Qd,ngPluralize:Rd,ngRepeat:Sd,ngShow:Td,ngSubmit:Md,ngStyle:Vd,ngSwitch:Wd,ngSwitchWhen:Xd,ngSwitchDefault:Yd,ngOptions:be,ngView:$d,ngTransclude:Zd,ngModel:yd,ngList:Ad,ngChange:zd,required:jc,ngRequired:jc,ngValue:Cd}).directive(pb).directive(kc);a.provider({$anchorScroll:Cc,$animation:Ib,$animator:qd,$browser:Ec,$cacheFactory:Fc,$controller:Jc,$document:Kc,$exceptionHandler:Lc,$filter:Zb,$interpolate:Mc,$http:bd,$httpBackend:cd,$location:Nc,$log:Oc,$parse:Sc,$route:Vc,$routeParams:Wc,$rootScope:Xc,$q:Tc,$sniffer:Yc,$templateCache:Gc,$timeout:gd,$window:Zc})}])})(Ha);w(T).ready(function(){rc(T,xb)})})(window,document);angular.element(document).find("head").append('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak{display:none;}ng\\:form{display:block;}</style>');
;;;
(function(){var n=this,t=n._,r=Array.prototype,e=Object.prototype,u=Function.prototype,i=r.push,a=r.slice,o=r.concat,l=e.toString,c=e.hasOwnProperty,f=Array.isArray,s=Object.keys,p=u.bind,h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):n._=h,h.VERSION="1.7.0";var g=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}};h.iteratee=function(n,t,r){return null==n?h.identity:h.isFunction(n)?g(n,t,r):h.isObject(n)?h.matches(n):h.property(n)},h.each=h.forEach=function(n,t,r){if(null==n)return n;t=g(t,r);var e,u=n.length;if(u===+u)for(e=0;u>e;e++)t(n[e],e,n);else{var i=h.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},h.map=h.collect=function(n,t,r){if(null==n)return[];t=h.iteratee(t,r);for(var e,u=n.length!==+n.length&&h.keys(n),i=(u||n).length,a=Array(i),o=0;i>o;o++)e=u?u[o]:o,a[o]=t(n[e],e,n);return a};var v="Reduce of empty array with no initial value";h.reduce=h.foldl=h.inject=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length,o=0;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[o++]:o++]}for(;a>o;o++)u=i?i[o]:o,r=t(r,n[u],u,n);return r},h.reduceRight=h.foldr=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[--a]:--a]}for(;a--;)u=i?i[a]:a,r=t(r,n[u],u,n);return r},h.find=h.detect=function(n,t,r){var e;return t=h.iteratee(t,r),h.some(n,function(n,r,u){return t(n,r,u)?(e=n,!0):void 0}),e},h.filter=h.select=function(n,t,r){var e=[];return null==n?e:(t=h.iteratee(t,r),h.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e)},h.reject=function(n,t,r){return h.filter(n,h.negate(h.iteratee(t)),r)},h.every=h.all=function(n,t,r){if(null==n)return!0;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,!t(n[u],u,n))return!1;return!0},h.some=h.any=function(n,t,r){if(null==n)return!1;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,t(n[u],u,n))return!0;return!1},h.contains=h.include=function(n,t){return null==n?!1:(n.length!==+n.length&&(n=h.values(n)),h.indexOf(n,t)>=0)},h.invoke=function(n,t){var r=a.call(arguments,2),e=h.isFunction(t);return h.map(n,function(n){return(e?t:n[t]).apply(n,r)})},h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matches(t))},h.findWhere=function(n,t){return h.find(n,h.matches(t))},h.max=function(n,t,r){var e,u,i=-1/0,a=-1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],e>i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u>a||u===-1/0&&i===-1/0)&&(i=n,a=u)});return i},h.min=function(n,t,r){var e,u,i=1/0,a=1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],i>e&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(a>u||1/0===u&&1/0===i)&&(i=n,a=u)});return i},h.shuffle=function(n){for(var t,r=n&&n.length===+n.length?n:h.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=h.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},h.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=h.values(n)),n[h.random(n.length-1)]):h.shuffle(n).slice(0,Math.max(0,t))},h.sortBy=function(n,t,r){return t=h.iteratee(t,r),h.pluck(h.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var m=function(n){return function(t,r,e){var u={};return r=h.iteratee(r,e),h.each(t,function(e,i){var a=r(e,i,t);n(u,e,a)}),u}};h.groupBy=m(function(n,t,r){h.has(n,r)?n[r].push(t):n[r]=[t]}),h.indexBy=m(function(n,t,r){n[r]=t}),h.countBy=m(function(n,t,r){h.has(n,r)?n[r]++:n[r]=1}),h.sortedIndex=function(n,t,r,e){r=h.iteratee(r,e,1);for(var u=r(t),i=0,a=n.length;a>i;){var o=i+a>>>1;r(n[o])<u?i=o+1:a=o}return i},h.toArray=function(n){return n?h.isArray(n)?a.call(n):n.length===+n.length?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:n.length===+n.length?n.length:h.keys(n).length},h.partition=function(n,t,r){t=h.iteratee(t,r);var e=[],u=[];return h.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},h.first=h.head=h.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:a.call(n,0,t)},h.initial=function(n,t,r){return a.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},h.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:a.call(n,Math.max(n.length-t,0))},h.rest=h.tail=h.drop=function(n,t,r){return a.call(n,null==t||r?1:t)},h.compact=function(n){return h.filter(n,h.identity)};var y=function(n,t,r,e){if(t&&h.every(n,h.isArray))return o.apply(e,n);for(var u=0,a=n.length;a>u;u++){var l=n[u];h.isArray(l)||h.isArguments(l)?t?i.apply(e,l):y(l,t,r,e):r||e.push(l)}return e};h.flatten=function(n,t){return y(n,t,!1,[])},h.without=function(n){return h.difference(n,a.call(arguments,1))},h.uniq=h.unique=function(n,t,r,e){if(null==n)return[];h.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=h.iteratee(r,e));for(var u=[],i=[],a=0,o=n.length;o>a;a++){var l=n[a];if(t)a&&i===l||u.push(l),i=l;else if(r){var c=r(l,a,n);h.indexOf(i,c)<0&&(i.push(c),u.push(l))}else h.indexOf(u,l)<0&&u.push(l)}return u},h.union=function(){return h.uniq(y(arguments,!0,!0,[]))},h.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;u>e;e++){var i=n[e];if(!h.contains(t,i)){for(var a=1;r>a&&h.contains(arguments[a],i);a++);a===r&&t.push(i)}}return t},h.difference=function(n){var t=y(a.call(arguments,1),!0,!0,[]);return h.filter(n,function(n){return!h.contains(t,n)})},h.zip=function(n){if(null==n)return[];for(var t=h.max(arguments,"length").length,r=Array(t),e=0;t>e;e++)r[e]=h.pluck(arguments,e);return r},h.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},h.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=h.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}for(;u>e;e++)if(n[e]===t)return e;return-1},h.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=n.length;for("number"==typeof r&&(e=0>r?e+r+1:Math.min(e,r+1));--e>=0;)if(n[e]===t)return e;return-1},h.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var d=function(){};h.bind=function(n,t){var r,e;if(p&&n.bind===p)return p.apply(n,a.call(arguments,1));if(!h.isFunction(n))throw new TypeError("Bind must be called on a function");return r=a.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(a.call(arguments)));d.prototype=n.prototype;var u=new d;d.prototype=null;var i=n.apply(u,r.concat(a.call(arguments)));return h.isObject(i)?i:u}},h.partial=function(n){var t=a.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===h&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},h.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=h.bind(n[r],n);return n},h.memoize=function(n,t){var r=function(e){var u=r.cache,i=t?t.apply(this,arguments):e;return h.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},h.delay=function(n,t){var r=a.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},h.defer=function(n){return h.delay.apply(h,[n,1].concat(a.call(arguments,1)))},h.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var l=function(){o=r.leading===!1?0:h.now(),a=null,i=n.apply(e,u),a||(e=u=null)};return function(){var c=h.now();o||r.leading!==!1||(o=c);var f=t-(c-o);return e=this,u=arguments,0>=f||f>t?(clearTimeout(a),a=null,o=c,i=n.apply(e,u),a||(e=u=null)):a||r.trailing===!1||(a=setTimeout(l,f)),i}},h.debounce=function(n,t,r){var e,u,i,a,o,l=function(){var c=h.now()-a;t>c&&c>0?e=setTimeout(l,t-c):(e=null,r||(o=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,a=h.now();var c=r&&!e;return e||(e=setTimeout(l,t)),c&&(o=n.apply(i,u),i=u=null),o}},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},h.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},h.before=function(n,t){var r;return function(){return--n>0?r=t.apply(this,arguments):t=null,r}},h.once=h.partial(h.before,2),h.keys=function(n){if(!h.isObject(n))return[];if(s)return s(n);var t=[];for(var r in n)h.has(n,r)&&t.push(r);return t},h.values=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},h.pairs=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},h.invert=function(n){for(var t={},r=h.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},h.functions=h.methods=function(n){var t=[];for(var r in n)h.isFunction(n[r])&&t.push(r);return t.sort()},h.extend=function(n){if(!h.isObject(n))return n;for(var t,r,e=1,u=arguments.length;u>e;e++){t=arguments[e];for(r in t)c.call(t,r)&&(n[r]=t[r])}return n},h.pick=function(n,t,r){var e,u={};if(null==n)return u;if(h.isFunction(t)){t=g(t,r);for(e in n){var i=n[e];t(i,e,n)&&(u[e]=i)}}else{var l=o.apply([],a.call(arguments,1));n=new Object(n);for(var c=0,f=l.length;f>c;c++)e=l[c],e in n&&(u[e]=n[e])}return u},h.omit=function(n,t,r){if(h.isFunction(t))t=h.negate(t);else{var e=h.map(o.apply([],a.call(arguments,1)),String);t=function(n,t){return!h.contains(e,t)}}return h.pick(n,t,r)},h.defaults=function(n){if(!h.isObject(n))return n;for(var t=1,r=arguments.length;r>t;t++){var e=arguments[t];for(var u in e)n[u]===void 0&&(n[u]=e[u])}return n},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n};var b=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var u=l.call(n);if(u!==l.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]===n)return e[i]===t;var a=n.constructor,o=t.constructor;if(a!==o&&"constructor"in n&&"constructor"in t&&!(h.isFunction(a)&&a instanceof a&&h.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c,f;if("[object Array]"===u){if(c=n.length,f=c===t.length)for(;c--&&(f=b(n[c],t[c],r,e)););}else{var s,p=h.keys(n);if(c=p.length,f=h.keys(t).length===c)for(;c--&&(s=p[c],f=h.has(t,s)&&b(n[s],t[s],r,e)););}return r.pop(),e.pop(),f};h.isEqual=function(n,t){return b(n,t,[],[])},h.isEmpty=function(n){if(null==n)return!0;if(h.isArray(n)||h.isString(n)||h.isArguments(n))return 0===n.length;for(var t in n)if(h.has(n,t))return!1;return!0},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=f||function(n){return"[object Array]"===l.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){h["is"+n]=function(t){return l.call(t)==="[object "+n+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return h.has(n,"callee")}),"function"!=typeof/./&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&n!==+n},h.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===l.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return n===void 0},h.has=function(n,t){return null!=n&&c.call(n,t)},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(n){return function(t){return t[n]}},h.matches=function(n){var t=h.pairs(n),r=t.length;return function(n){if(null==n)return!r;n=new Object(n);for(var e=0;r>e;e++){var u=t[e],i=u[0];if(u[1]!==n[i]||!(i in n))return!1}return!0}},h.times=function(n,t,r){var e=Array(Math.max(0,n));t=g(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=h.invert(_),j=function(n){var t=function(t){return n[t]},r="(?:"+h.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};h.escape=j(_),h.unescape=j(w),h.result=function(n,t){if(null==n)return void 0;var r=n[t];return h.isFunction(r)?n[t]():r};var x=0;h.uniqueId=function(n){var t=++x+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,F=function(n){return"\\"+k[n]};h.template=function(n,t,r){!t&&r&&(t=r),t=h.defaults({},t,h.templateSettings);var e=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,a,o){return i+=n.slice(u,o).replace(O,F),u=o+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(t.variable||"obj","_",i)}catch(o){throw o.source=i,o}var l=function(n){return a.call(this,n,h)},c=t.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},h.chain=function(n){var t=h(n);return t._chain=!0,t};var E=function(n){return this._chain?h(n).chain():n};h.mixin=function(n){h.each(h.functions(n),function(t){var r=h[t]=n[t];h.prototype[t]=function(){var n=[this._wrapped];return i.apply(n,arguments),E.call(this,r.apply(h,n))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],E.call(this,r)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}).call(this);
;;;
(function(t,e){function i(e,i){var n,o,a,r=e.nodeName.toLowerCase();return"area"===r?(n=e.parentNode,o=n.name,e.href&&o&&"map"===n.nodeName.toLowerCase()?(a=t("img[usemap=#"+o+"]")[0],!!a&&s(a)):!1):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r?e.href||i:i)&&s(e)}function s(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var n=0,o=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,s){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),s&&s.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var s,n,o=t(this[0]);o.length&&o[0]!==document;){if(s=o.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var s=t.attr(e,"tabindex"),n=isNaN(s);return(n||s>=0)&&i(e,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,s){function n(e,i,s,n){return t.each(o,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),n&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var o="Width"===s?["Left","Right"]:["Top","Bottom"],a=s.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+s]=function(i){return i===e?r["inner"+s].call(this):this.each(function(){t(this).css(a,n(this,i)+"px")})},t.fn["outer"+s]=function(e,i){return"number"!=typeof e?r["outer"+s].call(this,e):this.each(function(){t(this).css(a,n(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i){var s,n=t.plugins[e];if(n&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(s=0;n.length>s;s++)t.options[n[s][0]]&&n[s][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)}})})(jQuery),function(t,e){var i=0,s=Array.prototype.slice,n=t.cleanData;t.cleanData=function(e){for(var i,s=0;null!=(i=e[s]);s++)try{t(i).triggerHandler("remove")}catch(o){}n(e)},t.widget=function(i,s,n){var o,a,r,h,l={},c=i.split(".")[0];i=i.split(".")[1],o=c+"-"+i,n||(n=s,s=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[c]=t[c]||{},a=t[c][i],r=t[c][i]=function(t,i){return this._createWidget?(arguments.length&&this._createWidget(t,i),e):new r(t,i)},t.extend(r,a,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),h=new s,h.options=t.widget.extend({},h.options),t.each(n,function(i,n){return t.isFunction(n)?(l[i]=function(){var t=function(){return s.prototype[i].apply(this,arguments)},e=function(t){return s.prototype[i].apply(this,t)};return function(){var i,s=this._super,o=this._superApply;return this._super=t,this._superApply=e,i=n.apply(this,arguments),this._super=s,this._superApply=o,i}}(),e):(l[i]=n,e)}),r.prototype=t.widget.extend(h,{widgetEventPrefix:a?h.widgetEventPrefix:i},l,{constructor:r,namespace:c,widgetName:i,widgetFullName:o}),a?(t.each(a._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,r,i._proto)}),delete a._childConstructors):s._childConstructors.push(r),t.widget.bridge(i,r)},t.widget.extend=function(i){for(var n,o,a=s.call(arguments,1),r=0,h=a.length;h>r;r++)for(n in a[r])o=a[r][n],a[r].hasOwnProperty(n)&&o!==e&&(i[n]=t.isPlainObject(o)?t.isPlainObject(i[n])?t.widget.extend({},i[n],o):t.widget.extend({},o):o);return i},t.widget.bridge=function(i,n){var o=n.prototype.widgetFullName||i;t.fn[i]=function(a){var r="string"==typeof a,h=s.call(arguments,1),l=this;return a=!r&&h.length?t.widget.extend.apply(null,[a].concat(h)):a,r?this.each(function(){var s,n=t.data(this,o);return n?t.isFunction(n[a])&&"_"!==a.charAt(0)?(s=n[a].apply(n,h),s!==n&&s!==e?(l=s&&s.jquery?l.pushStack(s.get()):s,!1):e):t.error("no such method '"+a+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+a+"'")}):this.each(function(){var e=t.data(this,o);e?e.option(a||{})._init():t.data(this,o,new n(a,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,s){var n,o,a,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},n=i.split("."),i=n.shift(),n.length){for(o=r[i]=t.widget.extend({},this.options[i]),a=0;n.length-1>a;a++)o[n[a]]=o[n[a]]||{},o=o[n[a]];if(i=n.pop(),s===e)return o[i]===e?null:o[i];o[i]=s}else{if(s===e)return this.options[i]===e?null:this.options[i];r[i]=s}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,s,n){var o,a=this;"boolean"!=typeof i&&(n=s,s=i,i=!1),n?(s=o=t(s),this.bindings=this.bindings.add(s)):(n=s,s=this.element,o=this.widget()),t.each(n,function(n,r){function h(){return i||a.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof r?a[r]:r).apply(a,arguments):e}"string"!=typeof r&&(h.guid=r.guid=r.guid||h.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+a.eventNamespace,u=l[2];u?o.delegate(u,c,h):s.bind(c,h)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}})}(jQuery),function(t){var e=!1;t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return s._mouseMove(t)},this._mouseUpDelegate=function(t){return s._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;return n.containment?"window"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):"document"===n.containment?(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):n.containment.constructor===Array?(this.containment=n.containment,undefined):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i),undefined):(this.containment=null,undefined)},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*s}},_generatePosition:function(e){var i,s,n,o,a=this.options,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=e.pageX,l=e.pageY;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(s=this.relative_container.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,h=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var s=t(this).data("ui-draggable"),n=s.options,o=t.extend({},i,{item:s.element});s.sortables=[],t(n.connectToSortable).each(function(){var i=t.data(this,"ui-sortable");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,o))})},stop:function(e,i){var s=t(this).data("ui-draggable"),n=t.extend({},i,{item:s.element});t.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(e,i){var s=t(this).data("ui-draggable"),n=this;t.each(s.sortables,function(){var o=!1,a=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,t.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",e),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",e),s.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("ui-draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var s=t(i.helper),n=t(this).data("ui-draggable").options;s.css("opacity")&&(n._opacity=s.css("opacity")),s.css("opacity",n.opacity)},stop:function(e,i){var s=t(this).data("ui-draggable").options;s._opacity&&t(i.helper).css("opacity",s._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("ui-draggable"),s=i.options,n=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(s.axis&&"x"===s.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-i.overflowOffset.top<s.scrollSensitivity&&(i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-i.overflowOffset.left<s.scrollSensitivity&&(i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(e.pageY-t(document).scrollTop()<s.scrollSensitivity?n=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(n=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(e.pageX-t(document).scrollLeft()<s.scrollSensitivity?n=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(n=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed)))),n!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=t(this),s=i.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:s.top,left:s.left})})},drag:function(e,i){var s,n,o,a,r,h,l,c,u,d,p=t(this).data("ui-draggable"),f=p.options,g=f.snapTolerance,m=i.offset.left,v=m+p.helperProportions.width,_=i.offset.top,b=_+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)r=p.snapElements[u].left,h=r+p.snapElements[u].width,l=p.snapElements[u].top,c=l+p.snapElements[u].height,r-g>v||m>h+g||l-g>b||_>c+g||!t.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(s=g>=Math.abs(l-b),n=g>=Math.abs(c-_),o=g>=Math.abs(r-v),a=g>=Math.abs(h-m),s&&(i.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r-p.helperProportions.width}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h}).left-p.margins.left)),d=s||n||o||a,"outer"!==f.snapMode&&(s=g>=Math.abs(l-_),n=g>=Math.abs(c-b),o=g>=Math.abs(r-m),a=g>=Math.abs(h-v),s&&(i.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(s||n||o||a||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=s||n||o||a||d)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,i=this.data("ui-draggable").options,s=t.makeArray(t(i.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});s.length&&(e=parseInt(t(s[0]).css("zIndex"),10)||0,t(s).each(function(i){t(this).css("zIndex",e+i)}),this.css("zIndex",e+s.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var s=t(i.helper),n=t(this).data("ui-draggable").options;s.css("zIndex")&&(n._zIndex=s.css("zIndex")),s.css("zIndex",n.zIndex)},stop:function(e,i){var s=t(this).data("ui-draggable").options;s._zIndex&&t(i.helper).css("zIndex",s._zIndex)}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}t.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},t.ui.ddmanager.droppables[e.scope]=t.ui.ddmanager.droppables[e.scope]||[],t.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,i=t.ui.ddmanager.droppables[this.options.scope];i.length>e;e++)i[e]===this&&i.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){"accept"===e&&(this.accept=t.isFunction(i)?i:function(t){return t.is(i)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===s.options.scope&&e.accept.call(e.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(n=!0,!1):undefined}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(t,i,s){if(!i.offset)return!1;var n,o,a=(t.positionAbs||t.position.absolute).left,r=a+t.helperProportions.width,h=(t.positionAbs||t.position.absolute).top,l=h+t.helperProportions.height,c=i.offset.left,u=c+i.proportions.width,d=i.offset.top,p=d+i.proportions.height;switch(s){case"fit":return a>=c&&u>=r&&h>=d&&p>=l;case"intersect":return a+t.helperProportions.width/2>c&&u>r-t.helperProportions.width/2&&h+t.helperProportions.height/2>d&&p>l-t.helperProportions.height/2;case"pointer":return n=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,o=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(o,d,i.proportions.height)&&e(n,c,i.proportions.width);case"touch":return(h>=d&&p>=h||l>=d&&p>=l||d>h&&l>p)&&(a>=c&&u>=a||r>=c&&u>=r||c>a&&r>u);default:return!1}},t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;o.length>s;s++)if(!(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===o[s].element[0]){o[s].proportions.height=0;continue t}o[s].visible="none"!==o[s].element.css("display"),o[s].visible&&("mousedown"===a&&o[s]._activate.call(o[s],i),o[s].offset=o[s].element.offset(),o[s].proportions={width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight})}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,o,a=t.ui.intersect(e,this,this.options.tolerance),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t.data(this,"ui-droppable").options.scope===n}),o.length&&(s=t.data(o[0],"ui-droppable"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}}}(jQuery),function(t){function e(t){return parseInt(t,10)||0}function i(t){return!isNaN(parseInt(t,10))}t.widget("ui.resizable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,i,s,n,o,a=this,r=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;e.length>i;i++)s=t.trim(e[i]),o="ui-resizable-"+s,n=t("<div class='ui-resizable-handle "+o+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(e){var i,s,n,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),t(this.handles[i]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(t(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){r.disabled||a.resizing||(t(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(i){var s,n,o,a=this.options,r=this.element.position(),h=this.element;return this.resizing=!0,/absolute/.test(h.css("position"))?h.css({position:"absolute",top:h.css("top"),left:h.css("left")}):h.is(".ui-draggable")&&h.css({position:"absolute",top:r.top,left:r.left}),this._renderProxy(),s=e(this.helper.css("left")),n=e(this.helper.css("top")),a.containment&&(s+=t(a.containment).scrollLeft()||0,n+=t(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:s,top:n},this.size=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),height:h.height()},this.originalSize=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),height:h.height()},this.originalPosition={left:s,top:n},this.sizeDiff={width:h.outerWidth()-h.width(),height:h.outerHeight()-h.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===o?this.axis+"-resize":o),h.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var i,s=this.helper,n={},o=this.originalMousePosition,a=this.axis,r=this.position.top,h=this.position.left,l=this.size.width,c=this.size.height,u=e.pageX-o.left||0,d=e.pageY-o.top||0,p=this._change[a];return p?(i=p.apply(this,[e,u,d]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),this.position.top!==r&&(n.top=this.position.top+"px"),this.position.left!==h&&(n.left=this.position.left+"px"),this.size.width!==l&&(n.width=this.size.width+"px"),this.size.height!==c&&(n.height=this.size.height+"px"),s.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,o,a,r,h,l=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&t.ui.hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},r=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,h=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(t.extend(a,{top:h,left:r})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,s,n,o,a,r=this.options;a={minWidth:i(r.minWidth)?r.minWidth:0,maxWidth:i(r.maxWidth)?r.maxWidth:1/0,minHeight:i(r.minHeight)?r.minHeight:0,maxHeight:i(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||t)&&(e=a.minHeight*this.aspectRatio,n=a.minWidth/this.aspectRatio,s=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,e>a.minWidth&&(a.minWidth=e),n>a.minHeight&&(a.minHeight=n),a.maxWidth>s&&(a.maxWidth=s),a.maxHeight>o&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(t){this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,s=this.size,n=this.axis;return i(t.height)?t.width=t.height*this.aspectRatio:i(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(s.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(s.height-t.height),t.left=e.left+(s.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,s=this.axis,n=i(t.width)&&e.maxWidth&&e.maxWidth<t.width,o=i(t.height)&&e.maxHeight&&e.maxHeight<t.height,a=i(t.width)&&e.minWidth&&e.minWidth>t.width,r=i(t.height)&&e.minHeight&&e.minHeight>t.height,h=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(s),u=/nw|ne|n/.test(s);return a&&(t.width=e.minWidth),r&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),o&&(t.height=e.maxHeight),a&&c&&(t.left=h-e.minWidth),n&&c&&(t.left=h-e.maxWidth),r&&u&&(t.top=l-e.minHeight),o&&u&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var t,e,i,s,n,o=this.helper||this.element;for(t=0;this._proportionallyResizeElements.length>t;t++){if(n=this._proportionallyResizeElements[t],!this.borderDif)for(this.borderDif=[],i=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],s=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")],e=0;i.length>e;e++)this.borderDif[e]=(parseInt(i[e],10)||0)+(parseInt(s[e],10)||0);n.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).data("ui-resizable"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&t.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-a},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,c&&l?{top:c,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,s,n,o,a,r,h,l=t(this).data("ui-resizable"),c=l.options,u=l.element,d=c.containment,p=d instanceof t?d.get(0):/parent/.test(d)?u.parent().get(0):d;p&&(l.containerElement=t(p),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(p),s=[],t(["Top","Right","Left","Bottom"]).each(function(t,n){s[t]=e(i.css("padding"+n))}),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-s[3],width:i.innerWidth()-s[1]},n=l.containerOffset,o=l.containerSize.height,a=l.containerSize.width,r=t.ui.hasScroll(p,"left")?p.scrollWidth:a,h=t.ui.hasScroll(p)?p.scrollHeight:o,l.parentData={element:p,left:n.left,top:n.top,width:r,height:h}))},resize:function(e){var i,s,n,o,a=t(this).data("ui-resizable"),r=a.options,h=a.containerOffset,l=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(u=h),l.left<(a._helper?h.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-h.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=r.helper?h.left:0),l.top<(a._helper?h.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-h.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?h.top:0),a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top,i=Math.abs((a._helper?a.offset.left-u.left:a.offset.left-u.left)+a.sizeDiff.width),s=Math.abs((a._helper?a.offset.top-u.top:a.offset.top-h.top)+a.sizeDiff.height),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o&&(i-=a.parentData.left),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio)),s+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-s,c&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var e=t(this).data("ui-resizable"),i=e.options,s=e.containerOffset,n=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),h=a.outerWidth()-e.sizeDiff.width,l=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,s=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):t.each(i.alsoResize,function(t){s(t)})},resize:function(e,i){var s=t(this).data("ui-resizable"),n=s.options,o=s.originalSize,a=s.originalPosition,r={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-a.top||0,left:s.position.left-a.left||0},h=function(e,s){t(e).each(function(){var e=t(this),n=t(this).data("ui-resizable-alsoresize"),o={},a=s&&s.length?s:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(a,function(t,e){var i=(n[e]||0)+(r[e]||0);i&&i>=0&&(o[e]=i||null)}),e.css(o)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):t.each(n.alsoResize,function(t,e){h(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,s=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e=t(this).data("ui-resizable"),i=e.options,s=e.size,n=e.originalSize,o=e.originalPosition,a=e.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,h=r[0]||1,l=r[1]||1,c=Math.round((s.width-n.width)/h)*h,u=Math.round((s.height-n.height)/l)*l,d=n.width+c,p=n.height+u,f=i.maxWidth&&d>i.maxWidth,g=i.maxHeight&&p>i.maxHeight,m=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=r,m&&(d+=h),v&&(p+=l),f&&(d-=h),g&&(p-=l),/^(se|s|e)$/.test(a)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(a)?(e.size.width=d,e.size.height=p,e.position.top=o.top-u):/^(sw)$/.test(a)?(e.size.width=d,e.size.height=p,e.position.left=o.left-c):(e.size.width=d,e.size.height=p,e.position.top=o.top-u,e.position.left=o.left-c)}})}(jQuery),function(t){t.widget("ui.selectable",t.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,s=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(s.filter,this.element[0]),this._trigger("start",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=t.data(this,"selectable-item");s.startselected=!0,e.metaKey||e.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",e,{unselecting:s.element}))}),t(e.target).parents().addBack().each(function(){var s,n=t.data(this,"selectable-item");return n?(s=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",e,{selecting:n.element}):i._trigger("unselecting",e,{unselecting:n.element}),!1):undefined}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,o=this.opos[0],a=this.opos[1],r=e.pageX,h=e.pageY;return o>r&&(i=r,r=o,o=i),a>h&&(i=h,h=a,a=i),this.helper.css({left:o,top:a,width:r-o,height:h-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||o>i.right||i.top>h||a>i.bottom):"fit"===n.tolerance&&(l=i.left>o&&r>i.right&&i.top>a&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",e,{unselected:s.element})}),t(".ui-selecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",e,{selected:s.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):undefined}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-t(document).scrollTop()<a.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-a.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<a.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+a.scrollSpeed)),e.pageX-t(document).scrollLeft()<a.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-a.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<a.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),s="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=i&&s,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return n?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),s=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&s||"left"===o&&!s:n&&("down"===n&&i||"up"===n&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,s,n,o,a=[],r=[],h=this._connectWith();if(h&&e)for(i=h.length-1;i>=0;i--)for(n=t(h[i]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&r.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(r.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=r.length-1;i>=0;i--)r[i][0].each(function(){a.push(this)});return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",a),c.push({item:h,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_contactContainers:function(s){var n,o,a,r,h,l,c,u,d,p,f=null,g=null;for(n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(f&&t.contains(this.containers[n].element[0],f.element[0]))continue;f=this.containers[n],g=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",s,this._uiHash(this)),this.containers[n].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",s,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(a=1e4,r=null,p=f.floating||i(this.currentItem),h=p?"left":"top",l=p?"width":"height",c=this.positionAbs[h]+this.offset.click[h],o=this.items.length-1;o>=0;o--)t.contains(this.containers[g].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!p||e(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(u=this.items[o].item.offset()[h],d=!1,Math.abs(u-c)>Math.abs(u+this.items[o][l]-c)&&(d=!0,u+=this.items[o][l]),a>Math.abs(u-c)&&(a=Math.abs(u-c),r=this.items[o],this.direction=d?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return;r?this._rearrange(s,r,null,!0):this._rearrange(s,null,this.containers[g].element,!0),this._trigger("change",s,this._uiHash()),this.containers[g]._trigger("change",s,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[g]._trigger("over",s,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){this.reverting=!1;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||s.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(s.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),i=0;s.length>i;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(i=0;s.length>i;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(t,e){var i="ui-effects-";t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(t,o){var a,r=o.re.exec(i),h=r&&o.parse(r),l=o.space||"rgba";return h?(a=s[l](h),s[c[l].cache]=a[c[l].cache],n=s._rgba=a._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,o.transparent),s):o[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(n,a,r,h){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(a),a=e);var u=this,d=t.type(n),p=this._rgba=[];return a!==e&&(n=[n,a,r,h],d="array"),"string"===d?this.parse(s(n)||o._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof l?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var o=s.cache;f(s.props,function(t,e){if(!u[o]&&s.to){if("alpha"===t||null==n[t])return;u[o]=s.to(u._rgba)}u[o][e.idx]=i(n[t],e,!0)}),u[o]&&0>t.inArray(null,u[o].slice(0,3))&&(u[o][3]=1,s.from&&(u._rgba=s.from(u[o])))}),this):e},is:function(t){var i=l(t),s=!0,n=this;return f(c,function(t,o){var a,r=i[o.cache];return r&&(a=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===a[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=l(t),n=s._space(),o=c[n],a=0===this.alpha()?l("transparent"):this,r=a[o.cache]||o.to(a._rgba),h=r.slice();return s=s[o.cache],f(o.props,function(t,n){var o=n.idx,a=r[o],l=s[o],c=u[n.type]||{};null!==l&&(null===a?h[o]=l:(c.mod&&(l-a>c.mod/2?a+=c.mod:a-l>c.mod/2&&(a-=c.mod)),h[o]=i((l-a)*e+a,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(e)._rgba;return l(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,o=t[2]/255,a=t[3],r=Math.max(s,n,o),h=Math.min(s,n,o),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-o)/l+360:n===r?60*(o-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==a?1:a]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],o=t[3],a=.5>=s?s*(1+i):s+i-s*i,r=2*s-a;return[Math.round(255*n(r,a,e+1/3)),Math.round(255*n(r,a,e)),Math.round(255*n(r,a,e-1/3)),o]},f(c,function(s,n){var o=n.props,a=n.cache,h=n.to,c=n.from;l.fn[s]=function(s){if(h&&!this[a]&&(this[a]=h(this._rgba)),s===e)return this[a].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[a].slice();return f(o,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=l(c(d)),n[a]=d,n):l(d)},f(o,function(e,i){l.fn[e]||(l.fn[e]=function(n){var o,a=t.type(n),h="alpha"===e?this._hsla?"hsla":"rgba":s,l=this[h](),c=l[i.idx];return"undefined"===a?c:("function"===a&&(n=n.call(this,c),a=t.type(n)),null==n&&i.empty?this:("string"===a&&(o=r.exec(n),o&&(n=c+parseFloat(o[2])*("+"===o[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var o,a,r="";if("transparent"!==n&&("string"!==t.type(n)||(o=s(n)))){if(n=l(o||n),!d.rgba&&1!==n._rgba[3]){for(a="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&a&&a.style;)try{r=t.css(a,"backgroundColor"),a=a.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(h){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(a),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(o[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(o[i]=n[i]);return o}function s(e,i){var s,n,a={};for(s in i)n=i[s],e[s]!==n&&(o[s]||(t.fx.step[s]||!isNaN(parseFloat(n)))&&(a[s]=n));return a}var n=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,o,a,r){var h=t.speed(o,a,r);return this.queue(function(){var o,a=t(this),r=a.attr("class")||"",l=h.children?a.find("*").addBack():a;l=l.map(function(){var e=t(this);return{el:e,start:i(this)}}),o=function(){t.each(n,function(t,i){e[i]&&a[i+"Class"](e[i])})},o(),l=l.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),a.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){o(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(a[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,o){return s?t.effects.animateClass.call(this,{add:i},s,n,o):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(i){return function(s,n,o,a,r){return"boolean"==typeof n||n===e?o?t.effects.animateClass.call(this,n?{add:s}:{remove:s},o,a,r):i.apply(this,arguments):t.effects.animateClass.call(this,{toggle:s},n,o,a)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,o){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,o)}})}(),function(){function s(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function n(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.3",save:function(t,e){for(var s=0;e.length>s;s++)null!==e[s]&&t.data(i+e[s],t[0].style[e[s]])},restore:function(t,s){var n,o;for(o=0;s.length>o;o++)null!==s[o]&&(n=t.data(i+s[o]),n===e&&(n=""),t.css(s[o],n))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}return e.wrap(s),(e[0]===o||t.contains(e[0],o))&&t(o).focus(),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var o=e.cssUnit(i);o[0]>0&&(n[i]=o[0]*s+o[1])}),n}}),t.fn.extend({effect:function(){function e(e){function s(){t.isFunction(o)&&o.call(n[0]),t.isFunction(e)&&e()}var n=t(this),o=i.complete,r=i.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),s()):a.call(n[0],i,s)}var i=s.apply(this,arguments),n=i.mode,o=i.queue,a=t.effects.effect[i.effect];return t.fx.off||!a?n?this[n](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):o===!1?this.each(e):this.queue(o||"fx",e)},show:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(e){if(n(e)||"boolean"==typeof e)return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}()}(jQuery),function(t){var e=0,i={},s={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",s.height=s.paddingTop=s.paddingBottom=s.borderTopWidth=s.borderBottomWidth="show",t.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t(),content:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?(this._activate(e),undefined):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e),undefined)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),o=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:o=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[s-1]}o&&(t(e.target).attr("tabIndex",-1),t(o).attr("tabIndex",0),o.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,s=this.options,n=s.heightStyle,o=this.element.parent(),a=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e);this.active=this._findActive(s.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(e){var i=t(this),s=i.attr("id"),n=i.next(),o=n.attr("id");s||(s=a+"-header-"+e,i.attr("id",s)),o||(o=a+"-panel-"+e,n.attr("id",o)),i.attr("aria-controls",o),n.attr("aria-labelledby",s)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(s.event),"fill"===n?(i=o.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.headers.each(function(){i-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===n&&(i=0,this.headers.next().each(function(){i=Math.max(i,t(this).css("height","").height())}).height(i))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n[0]===s[0],a=o&&i.collapsible,r=a?t():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:a?t():n,newPanel:r};e.preventDefault(),o&&!i.collapsible||this._trigger("beforeActivate",e,l)===!1||(i.active=a?!1:this.headers.index(n),this.active=o?t():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),o||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-expanded":"false","aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr("tabIndex",-1):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(t,e,n){var o,a,r,h=this,l=0,c=t.length&&(!e.length||t.index()<e.index()),u=this.options.animate||{},d=c&&u.down||u,p=function(){h._toggleComplete(n)};return"number"==typeof d&&(r=d),"string"==typeof d&&(a=d),a=a||d.easing||u.easing,r=r||d.duration||u.duration,e.length?t.length?(o=t.show().outerHeight(),e.animate(i,{duration:r,easing:a,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(s,{duration:r,easing:a,complete:p,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?l+=i.now:"content"!==h.options.heightStyle&&(i.now=Math.round(o-e.outerHeight()-l),l=0)}}),undefined):e.animate(i,r,a,p):t.animate(s,r,a,p)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}})}(jQuery),function(t){var e=0;t.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o?!0:a?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,undefined;e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:case o.NUMPAD_ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),undefined;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),undefined):(this._searchTimeout(t),undefined)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,undefined):(clearTimeout(this.searching),this.close(t),this._change(t),undefined)}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(s){s.target===e.element[0]||s.target===i||t.contains(i,s.target)||e.close()})})},menufocus:function(e,i){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),undefined;var s=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:s})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):undefined},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var t=this,i=++e;return function(s){i===e&&t.__response(s),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<a>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),this.menu.blur(),undefined):(this.menu[t](e),undefined):(this.search(null,e),undefined)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})}(jQuery),function(t){var e,i,s,n,o="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",r="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",h=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},l=function(e){var i=e.name,s=e.form,n=t([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?t(s).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),n};t.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,h),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var a=this,r=this.options,c="checkbox"===this.type||"radio"===this.type,u=c?"":"ui-state-active",d="ui-state-focus";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===e&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||t(this).removeClass(u)}).bind("click"+this.eventNamespace,function(t){r.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){a.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){a.buttonElement.removeClass(d)}),c&&(this.element.bind("change"+this.eventNamespace,function(){n||a.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){r.disabled||(n=!1,i=t.pageX,s=t.pageY)}).bind("mouseup"+this.eventNamespace,function(t){r.disabled||(i!==t.pageX||s!==t.pageY)&&(n=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled||n?!1:undefined}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled||n)return!1;t(this).addClass("ui-state-active"),a.buttonElement.attr("aria-pressed","true");var e=a.element[0];l(e).not(e).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(t(this).addClass("ui-state-active"),e=this,a.document.one("mouseup",function(){e=null}),undefined)}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:(t(this).removeClass("ui-state-active"),undefined)}).bind("keydown"+this.eventNamespace,function(e){return r.disabled?!1:((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"),undefined)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+a+" "+r).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1),undefined):(this._resetButton(),undefined)},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?l(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),undefined;var e=this.buttonElement.removeClass(r),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,o=[];s.primary||s.secondary?(this.options.text&&o.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(o.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):o.push("ui-button-text-only"),e.addClass(o.join(" "))}}),t.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=s(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(o.inline?e.parent()[0]:o.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))})}function n(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}t.extend(t.ui,{datepicker:{version:"1.10.3"}});var o,a="datepicker";t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return n(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var n=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,a,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[r?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,a,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,o,r){var h,l,c,u,d,p=this._dialogInst;return p||(this.uuid+=1,h="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+h+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},t.data(this._dialogInput[0],a,p)),n(p.settings,o||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+u,c/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],a,p),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,a);s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,a),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,a);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,a);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,a)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,s,o){var a,r,h,l,c=this._getInst(i);return 2===arguments.length&&"string"==typeof s?"defaults"===s?t.extend({},t.datepicker._defaults):c?"all"===s?t.extend({},c.settings):this._get(c,s):null:(a=s||{},"string"==typeof s&&(a={},a[s]=o),c&&(this._curInst===c&&this._hideDatepicker(),r=this._getDateDatepicker(i,!0),h=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),n(c.settings,a),null!==h&&a.dateFormat!==e&&a.minDate===e&&(c.settings.minDate=this._formatDate(c,h)),null!==l&&a.dateFormat!==e&&a.maxDate===e&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in a&&(a.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),c),this._autoSize(c),this._setDate(c,r),this._updateAlternate(c),this._updateDatepicker(c)),e)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(i){var s,n,o=t.datepicker._getInst(i.target);return t.datepicker._get(o,"constrainInput")?(s=t.datepicker._possibleChars(t.datepicker._get(o,"dateFormat")),n=String.fromCharCode(null==i.charCode?i.keyCode:i.charCode),i.ctrlKey||i.metaKey||" ">n||!s||s.indexOf(n)>-1):e},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,s,o,a,r,h,l;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),s=t.datepicker._get(i,"beforeShow"),o=s?s.apply(e,[e,i]):{},o!==!1&&(n(i.settings,o),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),a=!1,t(e).parents().each(function(){return a|="fixed"===t(this).css("position"),!a}),r={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),r=t.datepicker._checkOffset(i,r,a),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":a?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(h=t.datepicker._get(i,"showAnim"),l=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[h]?i.dpDiv.show(h,t.datepicker._get(i,"showOptions"),l):i.dpDiv[h||"show"](h?l:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,o=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,s=this._getNumberOfMonths(e),n=s[1],a=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-a:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+o>l&&l>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,r=this._curInst;!r||e&&r!==t.data(e,a)||this._datepickerShowing&&(i=this._get(r,"showAnim"),s=this._get(r,"duration"),n=function(){t.datepicker._tidyDialog(r)},t.effects&&(t.effects.effect[i]||t.effects[i])?r.dpDiv.hide(i,t.datepicker._get(r,"showOptions"),s,n):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(r,"onClose"),o&&o.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,a=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).each(function(){t(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,s,n){if(null==i||null==s)throw"Invalid arguments";if(s="object"==typeof s?""+s:s+"",""===s)return null;var o,a,r,h,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,p=(n?n.dayNames:null)||this._defaults.dayNames,f=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,g=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,v=-1,_=-1,b=-1,y=!1,w=function(t){var e=i.length>o+1&&i.charAt(o+1)===t;return e&&o++,e},k=function(t){var e=w(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n=RegExp("^\\d{1,"+i+"}"),o=s.substring(l).match(n);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},x=function(i,n,o){var a=-1,r=t.map(w(i)?o:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(r,function(t,i){var n=i[1];return s.substr(l,n.length).toLowerCase()===n.toLowerCase()?(a=i[0],l+=n.length,!1):e}),-1!==a)return a+1;throw"Unknown name at position "+l},D=function(){if(s.charAt(l)!==i.charAt(o))throw"Unexpected literal at position "+l;l++};for(o=0;i.length>o;o++)if(y)"'"!==i.charAt(o)||w("'")?D():y=!1;else switch(i.charAt(o)){case"d":_=k("d");break;case"D":x("D",d,p);break;case"o":b=k("o");break;case"m":v=k("m");break;case"M":v=x("M",f,g);break;case"y":m=k("y");break;case"@":h=new Date(k("@")),m=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"!":h=new Date((k("!")-this._ticksTo1970)/1e4),m=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"'":w("'")?D():y=!0;break;default:D()}if(s.length>l&&(r=s.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),b>-1)for(v=1,_=b;;){if(a=this._getDaysInMonth(m,v-1),a>=_)break;v++,_-=a}if(h=this._daylightSavingAdjust(new Date(m,v-1,_)),h.getFullYear()!==m||h.getMonth()+1!==v||h.getDate()!==_)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},l=function(t,e,i){var s=""+e;if(h(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return h(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||h("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=l("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,o);break;case"o":u+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),a,r);break;case"y":u+=h("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":h("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(r){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":a+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}l=h.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,a,r,h,l,c,u,d,p,f,g,m,v,_,b,y,w,k,x,D,C,I,P,T,M,S,z,A,H,E,N,W,O,F,R,L=new Date,j=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(t,"isRTL"),B=this._get(t,"showButtonPanel"),V=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),q=this._get(t,"showCurrentAtPos"),Q=this._get(t,"stepMonths"),X=1!==U[0]||1!==U[1],$=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-q,te=t.drawYear;if(0>Z&&(Z+=12,te--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-U[0]*U[1]+1,J.getDate())),e=G&&G>e?G:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-Q,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":V?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+Q,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":V?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?$:j,a=K?this.formatDate(a,r,this._getFormatConfig(t)):a,h=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(Y?"":h)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),_=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;U[0]>k;k++){for(x="",this.maxRows=4,D=0;U[1]>D;D++){if(C=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),I=" ui-corner-all",P="",X){if(P+="<div class='ui-datepicker-group",U[1]>1)switch(D){case 0:P+=" ui-datepicker-group-first",I=" ui-corner-"+(Y?"right":"left");break;case U[1]-1:P+=" ui-datepicker-group-last",I=" ui-corner-"+(Y?"left":"right");break;default:P+=" ui-datepicker-group-middle",I=""}P+="'>"}for(P+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+I+"'>"+(/all|left/.test(I)&&0===k?Y?o:s:"")+(/all|right/.test(I)&&0===k?Y?s:o:"")+this._generateMonthYearHeader(t,Z,te,G,J,k>0||D>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",T=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)M=(w+c)%7,T+="<th"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[M]+"'>"+p[M]+"</span></th>";for(P+=T+"</tr></thead><tbody>",S=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,S)),z=(this._getFirstDayOfMonth(te,Z)-c+7)%7,A=Math.ceil((z+S)/7),H=X?this.maxRows>A?this.maxRows:A:A,this.maxRows=H,E=this._daylightSavingAdjust(new Date(te,Z,1-z)),N=0;H>N;N++){for(P+="<tr>",W=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(E)+"</td>":"",w=0;7>w;w++)O=m?m.apply(t.input?t.input[0]:null,[E]):[!0,""],F=E.getMonth()!==Z,R=F&&!_||!O[0]||G&&G>E||J&&E>J,W+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(E.getTime()===C.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===E.getTime()&&b.getTime()===C.getTime()?" "+this._dayOverClass:"")+(R?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!v?"":" "+O[1]+(E.getTime()===$.getTime()?" "+this._currentClass:"")+(E.getTime()===j.getTime()?" ui-datepicker-today":""))+"'"+(F&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(R?"":" data-handler='selectDay' data-event='click' data-month='"+E.getMonth()+"' data-year='"+E.getFullYear()+"'")+">"+(F&&!v?"&#xa0;":R?"<span class='ui-state-default'>"+E.getDate()+"</span>":"<a class='ui-state-default"+(E.getTime()===j.getTime()?" ui-state-highlight":"")+(E.getTime()===$.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+E.getDate()+"</a>")+"</td>",E.setDate(E.getDate()+1),E=this._daylightSavingAdjust(E);P+=W+"</tr>"}Z++,Z>11&&(Z=0,te++),P+="</tbody></table>"+(X?"</div>"+(U[0]>0&&D===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=P}y+=x}return y+=l,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var h,l,c,u,d,p,f,g,m=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),_=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(o||!m)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!h||c>=s.getMonth())&&(!l||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+r[c]+"</option>");y+="</select>"}if(_||(b+=y+(!o&&m&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),g=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),_&&(b+=(!o&&m&&v?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"===i?e:0),n=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,h=this._get(t,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.3"}(jQuery),function(t){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};t.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||t(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!e&&this._trigger("focus",t),i},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),undefined):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._trigger("open"),undefined)},_focusTabbable:function(){var t=this.element.find("[autofocus]");t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),undefined;if(e.keyCode===t.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(n.focus(1),e.preventDefault()):(s.focus(1),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),undefined):(t.each(i,function(i,s){var n,o;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(e.element[0],arguments)},o={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,t("<button></button>",s).button(o).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),undefined)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,o){s.position=[o.position.left-i.document.scrollLeft(),o.position.top-i.document.scrollTop()],t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(o))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:a,start:function(s,n){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,o){s.height=t(this).height(),s.width=t(this).width(),t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(o))}}).css("position",o)},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(s){var n=this,o=!1,a={};t.each(s,function(t,s){n._setOption(t,s),t in e&&(o=!0),t in i&&(a[t]=s)}),o&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(t,e){var i,s,n=this.uiDialog;"dialogClass"===t&&n.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=n.is(":data(ui-draggable)"),i&&!e&&n.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(s=n.is(":data(ui-resizable)"),s&&!e&&n.resizable("destroy"),s&&"string"==typeof e&&n.resizable("option","handles",e),s||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,i=this.widgetFullName;t.ui.dialog.overlayInstances||this._delay(function(){t.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(s){e._allowInteraction(s)||(s.preventDefault(),t(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),t.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(t.ui.dialog.overlayInstances--,t.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),t.ui.dialog.overlayInstances=0,t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{_position:function(){var e,i=this.options.position,s=[],n=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(s=i.split?i.split(" "):[i[0],i[1]],1===s.length&&(s[1]=s[0]),t.each(["left","top"],function(t,e){+s[t]===s[t]&&(n[t]=s[t],s[t]=e)}),i={my:s[0]+(0>n[0]?n[0]:"+"+n[0])+" "+s[1]+(0>n[1]?n[1]:"+"+n[1]),at:s.join(" ")}),i=t.extend({},t.ui.dialog.prototype.options.position,i)):i=t.ui.dialog.prototype.options.position,e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.position(i),e||this.uiDialog.hide()}})}(jQuery),function(t){var e=/up|down|vertical/,i=/up|left|vertical|horizontal/;t.effects.effect.blind=function(s,n){var o,a,r,h=t(this),l=["position","top","bottom","left","right","height","width"],c=t.effects.setMode(h,s.mode||"hide"),u=s.direction||"up",d=e.test(u),p=d?"height":"width",f=d?"top":"left",g=i.test(u),m={},v="show"===c;h.parent().is(".ui-effects-wrapper")?t.effects.save(h.parent(),l):t.effects.save(h,l),h.show(),o=t.effects.createWrapper(h).css({overflow:"hidden"}),a=o[p](),r=parseFloat(o.css(f))||0,m[p]=v?a:0,g||(h.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=v?r:a+r),v&&(o.css(p,0),g||o.css(f,r+a)),o.animate(m,{duration:s.duration,easing:s.easing,queue:!1,complete:function(){"hide"===c&&h.hide(),t.effects.restore(h,l),t.effects.removeWrapper(h),n()}})}}(jQuery),function(t){t.effects.effect.bounce=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(a,e.mode||"effect"),l="hide"===h,c="show"===h,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||l?1:0),g=e.duration/f,m=e.easing,v="up"===u||"down"===u?"top":"left",_="up"===u||"left"===u,b=a.queue(),y=b.length;for((c||l)&&r.push("opacity"),t.effects.save(a,r),a.show(),t.effects.createWrapper(a),d||(d=a["top"===v?"outerHeight":"outerWidth"]()/3),c&&(o={opacity:1},o[v]=0,a.css("opacity",0).css(v,_?2*-d:2*d).animate(o,g,m)),l&&(d/=Math.pow(2,p-1)),o={},o[v]=0,s=0;p>s;s++)n={},n[v]=(_?"-=":"+=")+d,a.animate(n,g,m).animate(o,g,m),d=l?2*d:d/2;l&&(n={opacity:0},n[v]=(_?"-=":"+=")+d,a.animate(n,g,m)),a.queue(function(){l&&a.hide(),t.effects.restore(a,r),t.effects.removeWrapper(a),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,f+1))),a.dequeue()}}(jQuery),function(t){t.effects.effect.clip=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(a,e.mode||"hide"),l="show"===h,c=e.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};t.effects.save(a,r),a.show(),s=t.effects.createWrapper(a).css({overflow:"hidden"}),n="IMG"===a[0].tagName?s:a,o=n[d](),l&&(n.css(d,0),n.css(p,o/2)),f[d]=l?o:0,f[p]=l?0:o/2,n.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||a.hide(),t.effects.restore(a,r),t.effects.removeWrapper(a),i()}})}}(jQuery),function(t){t.effects.effect.drop=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","opacity","height","width"],a=t.effects.setMode(n,e.mode||"hide"),r="show"===a,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h?"pos":"neg",u={opacity:r?1:0};t.effects.save(n,o),n.show(),t.effects.createWrapper(n),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===c?-s:s),u[l]=(r?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}})}}(jQuery),function(t){t.effects.effect.explode=function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),g||p.hide(),i()}var o,a,r,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),_=Math.ceil(p.outerHeight()/u),b=[];for(o=0;u>o;o++)for(h=m.top+o*_,c=o-(u-1)/2,a=0;d>a;a++)r=m.left+a*v,l=a-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*v,top:-o*_}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:_,left:r+(g?l*v:0),top:h+(g?c*_:0),opacity:g?0:1}).animate({left:r+(g?0:l*v),top:h+(g?0:c*_),opacity:g?1:0},e.duration||500,e.easing,s)}}(jQuery),function(t){t.effects.effect.fade=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}}(jQuery),function(t){t.effects.effect.fold=function(e,i){var s,n,o=t(this),a=["position","top","bottom","left","right","height","width"],r=t.effects.setMode(o,e.mode||"hide"),h="show"===r,l="hide"===r,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=h!==d,f=p?["width","height"]:["height","width"],g=e.duration/2,m={},v={};t.effects.save(o,a),o.show(),s=t.effects.createWrapper(o).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],u&&(c=parseInt(u[1],10)/100*n[l?0:1]),h&&s.css(d?{height:0,width:c}:{height:c,width:0}),m[f[0]]=h?n[0]:c,v[f[1]]=h?n[1]:0,s.animate(m,g,e.easing).animate(v,g,e.easing,function(){l&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()})}}(jQuery),function(t){t.effects.effect.highlight=function(e,i){var s=t(this),n=["backgroundImage","backgroundColor","opacity"],o=t.effects.setMode(s,e.mode||"show"),a={backgroundColor:s.css("backgroundColor")};"hide"===o&&(a.opacity=0),t.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(a,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&s.hide(),t.effects.restore(s,n),i()}})}}(jQuery),function(t){t.effects.effect.pulsate=function(e,i){var s,n=t(this),o=t.effects.setMode(n,e.mode||"show"),a="show"===o,r="hide"===o,h=a||"hide"===o,l=2*(e.times||5)+(h?1:0),c=e.duration/l,u=0,d=n.queue(),p=d.length;for((a||!n.is(":visible"))&&(n.css("opacity",0).show(),u=1),s=1;l>s;s++)n.animate({opacity:u},c,e.easing),u=1-u;n.animate({opacity:u},c,e.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,l+1))),n.dequeue()}}(jQuery),function(t){t.effects.effect.puff=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"hide"),o="hide"===n,a=parseInt(e.percent,10)||150,r=a/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:o?a:100,from:o?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(e)},t.effects.effect.scale=function(e,i){var s=t(this),n=t.extend(!0,{},e),o=t.effects.setMode(s,e.mode||"effect"),a=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===o?0:100),r=e.direction||"both",h=e.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},c={y:"horizontal"!==r?a/100:1,x:"vertical"!==r?a/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==o&&(n.origin=h||["middle","center"],n.restore=!0),n.from=e.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*c.y,width:l.width*c.x,outerHeight:l.outerHeight*c.y,outerWidth:l.outerWidth*c.x},n.fade&&("show"===o&&(n.from.opacity=0,n.to.opacity=1),"hide"===o&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},t.effects.effect.size=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(a,e.mode||"effect"),f=e.restore||"effect"!==p,g=e.scale||"both",m=e.origin||["middle","center"],v=a.css("position"),_=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&a.show(),s={height:a.height(),width:a.width(),outerHeight:a.outerHeight(),outerWidth:a.outerWidth()},"toggle"===e.mode&&"show"===p?(a.from=e.to||b,a.to=e.from||s):(a.from=e.from||("show"===p?b:s),a.to=e.to||("hide"===p?b:s)),o={from:{y:a.from.height/s.height,x:a.from.width/s.width},to:{y:a.to.height/s.height,x:a.to.width/s.width}},("box"===g||"both"===g)&&(o.from.y!==o.to.y&&(_=_.concat(u),a.from=t.effects.setTransition(a,u,o.from.y,a.from),a.to=t.effects.setTransition(a,u,o.to.y,a.to)),o.from.x!==o.to.x&&(_=_.concat(d),a.from=t.effects.setTransition(a,d,o.from.x,a.from),a.to=t.effects.setTransition(a,d,o.to.x,a.to))),("content"===g||"both"===g)&&o.from.y!==o.to.y&&(_=_.concat(c).concat(l),a.from=t.effects.setTransition(a,c,o.from.y,a.from),a.to=t.effects.setTransition(a,c,o.to.y,a.to)),t.effects.save(a,_),a.show(),t.effects.createWrapper(a),a.css("overflow","hidden").css(a.from),m&&(n=t.effects.getBaseline(m,s),a.from.top=(s.outerHeight-a.outerHeight())*n.y,a.from.left=(s.outerWidth-a.outerWidth())*n.x,a.to.top=(s.outerHeight-a.to.outerHeight)*n.y,a.to.left=(s.outerWidth-a.to.outerWidth)*n.x),a.css(a.from),("content"===g||"both"===g)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),l=r.concat(u).concat(d),a.find("*[width]").each(function(){var i=t(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,l),i.from={height:s.height*o.from.y,width:s.width*o.from.x,outerHeight:s.outerHeight*o.from.y,outerWidth:s.outerWidth*o.from.x},i.to={height:s.height*o.to.y,width:s.width*o.to.x,outerHeight:s.height*o.to.y,outerWidth:s.width*o.to.x},o.from.y!==o.to.y&&(i.from=t.effects.setTransition(i,u,o.from.y,i.from),i.to=t.effects.setTransition(i,u,o.to.y,i.to)),o.from.x!==o.to.x&&(i.from=t.effects.setTransition(i,d,o.from.x,i.from),i.to=t.effects.setTransition(i,d,o.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,l)})})),a.animate(a.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===a.to.opacity&&a.css("opacity",a.from.opacity),"hide"===p&&a.hide(),t.effects.restore(a,_),f||("static"===v?a.css({position:"relative",top:a.to.top,left:a.to.left}):t.each(["top","left"],function(t,e){a.css(e,function(e,i){var s=parseInt(i,10),n=t?a.to.left:a.to.top;return"auto"===i?n+"px":s+n+"px"})})),t.effects.removeWrapper(a),i()}})}}(jQuery),function(t){t.effects.effect.shake=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(n,e.mode||"effect"),r=e.direction||"left",h=e.distance||20,l=e.times||3,c=2*l+1,u=Math.round(e.duration/c),d="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},g={},m={},v=n.queue(),_=v.length;for(t.effects.save(n,o),n.show(),t.effects.createWrapper(n),f[d]=(p?"-=":"+=")+h,g[d]=(p?"+=":"-=")+2*h,m[d]=(p?"-=":"+=")+2*h,n.animate(f,u,e.easing),s=1;l>s;s++)n.animate(g,u,e.easing).animate(m,u,e.easing);n.animate(g,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}),_>1&&v.splice.apply(v,[1,0].concat(v.splice(_,c+1))),n.dequeue()}}(jQuery),function(t){t.effects.effect.slide=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","width","height"],a=t.effects.setMode(n,e.mode||"show"),r="show"===a,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u={};t.effects.save(n,o),n.show(),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,c?isNaN(s)?"-"+s:-s:s),u[l]=(r?c?"+=":"-=":c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}})}}(jQuery),function(t){t.effects.effect.transfer=function(e,i){var s=t(this),n=t(e.to),o="fixed"===n.css("position"),a=t("body"),r=o?a.scrollTop():0,h=o?a.scrollLeft():0,l=n.offset(),c={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-r,left:u.left-h,height:s.innerHeight(),width:s.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})}}(jQuery),function(t){t.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,t.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(e){var i=t(e.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),i.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var i=t(e.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){t(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,o,a,r,h=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:h=!1,n=this.previousFilter||"",o=String.fromCharCode(e.keyCode),a=!1,clearTimeout(this.filterTimer),o===n?a=!0:o=n+o,r=RegExp("^"+i(o),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())}),s=a&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s,s.length||(o=String.fromCharCode(e.keyCode),r=RegExp("^"+i(o),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())})),s.length?(this.focus(e,s),s.length>1?(this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}h&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i=this.options.icons.submenu,s=this.element.find(this.options.menus);s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),s=e.prev("a"),n=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",s.attr("id"))}),e=s.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=t(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),this._super(t,e)},focus:function(t,e){var i,s;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.height(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),undefined):(this.next(e),undefined)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item").first())),undefined):(this.next(e),undefined)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)}})}(jQuery),function(t,e){function i(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function s(e,i){return parseInt(t.css(e,i),10)||0}function n(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var o,a=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(o!==e)return o;var i,s,n=t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=n.children()[0];return t("body").append(n),i=a.offsetWidth,n.css("overflow","scroll"),s=a.offsetWidth,i===s&&(s=n[0].clientWidth),n.remove(),o=i-s},getScrollInfo:function(e){var i=e.isWindow?"":e.element.css("overflow-x"),s=e.isWindow?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]);return{element:i,isWindow:s,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s?i.width():i.outerWidth(),height:s?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return f.apply(this,arguments);e=t.extend({},e);var o,p,g,m,v,_,b=t(e.of),y=t.position.getWithinInfo(e.within),w=t.position.getScrollInfo(y),k=(e.collision||"flip").split(" "),x={};return _=n(b),b[0].preventDefault&&(e.at="left top"),p=_.width,g=_.height,m=_.offset,v=t.extend({},m),t.each(["my","at"],function(){var t,i,s=(e[this]||"").split(" ");1===s.length&&(s=l.test(s[0])?s.concat(["center"]):c.test(s[0])?["center"].concat(s):["center","center"]),s[0]=l.test(s[0])?s[0]:"center",s[1]=c.test(s[1])?s[1]:"center",t=u.exec(s[0]),i=u.exec(s[1]),x[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(s[0])[0],d.exec(s[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===e.at[0]?v.left+=p:"center"===e.at[0]&&(v.left+=p/2),"bottom"===e.at[1]?v.top+=g:"center"===e.at[1]&&(v.top+=g/2),o=i(x.at,p,g),v.left+=o[0],v.top+=o[1],this.each(function(){var n,l,c=t(this),u=c.outerWidth(),d=c.outerHeight(),f=s(this,"marginLeft"),_=s(this,"marginTop"),D=u+f+s(this,"marginRight")+w.width,C=d+_+s(this,"marginBottom")+w.height,I=t.extend({},v),P=i(x.my,c.outerWidth(),c.outerHeight());"right"===e.my[0]?I.left-=u:"center"===e.my[0]&&(I.left-=u/2),"bottom"===e.my[1]?I.top-=d:"center"===e.my[1]&&(I.top-=d/2),I.left+=P[0],I.top+=P[1],t.support.offsetFractions||(I.left=h(I.left),I.top=h(I.top)),n={marginLeft:f,marginTop:_},t.each(["left","top"],function(i,s){t.ui.position[k[i]]&&t.ui.position[k[i]][s](I,{targetWidth:p,targetHeight:g,elemWidth:u,elemHeight:d,collisionPosition:n,collisionWidth:D,collisionHeight:C,offset:[o[0]+P[0],o[1]+P[1]],my:e.my,at:e.at,within:y,elem:c})}),e.using&&(l=function(t){var i=m.left-I.left,s=i+p-u,n=m.top-I.top,o=n+g-d,h={target:{element:b,left:m.left,top:m.top,width:p,height:g},element:{element:c,left:I.left,top:I.top,width:u,height:d},horizontal:0>s?"left":i>0?"right":"center",vertical:0>o?"top":n>0?"bottom":"middle"};u>p&&p>r(i+s)&&(h.horizontal="center"),d>g&&g>r(n+o)&&(h.vertical="middle"),h.important=a(r(i),r(s))>a(r(n),r(o))?"horizontal":"vertical",e.using.call(this,t,h)}),c.offset(t.extend(I,{using:l}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,o=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-o-n;e.collisionWidth>o?h>0&&0>=l?(i=t.left+h+e.collisionWidth-o-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+o-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=a(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-o-n;e.collisionHeight>o?h>0&&0>=l?(i=t.top+h+e.collisionHeight-o-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+o-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=a(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,a=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-a-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-a-o,(0>i||r(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||u>r(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,a=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-a-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-a-o,t.top+p+f+g>c&&(0>s||r(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-h,t.top+p+f+g>u&&(i>0||u>r(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,s,n,o,a=document.getElementsByTagName("body")[0],r=document.createElement("div");e=document.createElement(a?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)e.style[o]=s[o];e.appendChild(r),i=a||document.documentElement,i.insertBefore(e,i.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",n=t(r).offset().left,t.support.offsetFractions=n>10&&11>n,e.innerHTML="",i.removeChild(e)}()}(jQuery),function(t,e){t.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),e)},_constrainedValue:function(t){return t===e&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}})}(jQuery),function(t){var e=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push(o);this.handles=n.add(t(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=t([])},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,r,h,l,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,o.addClass("ui-state-active").focus(),h=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-o.width()/2,top:e.pageY-h.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var s,n,o;this.options.values&&this.options.values.length?(s=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>s||1===e&&s>i)&&(i=s),i!==this.values(e)&&(n=this.values(),n[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:n}),s=this.values(e?0:1),o!==!1&&this.values(e,i,!0))):i!==this.value()&&(o=this._trigger("slide",t,{handle:this.handles[e],value:i}),o!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),undefined):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),undefined;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((s-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(i){var s,n,o,a,r=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(i.target).addClass("ui-state-active"),s=this._start(i,r),s===!1))return}switch(a=this.options.step,n=o=this.options.values&&this.options.values.length?this.values(r):this.value(),i.keyCode){case t.ui.keyCode.HOME:o=this._valueMin();break;case t.ui.keyCode.END:o=this._valueMax();break;case t.ui.keyCode.PAGE_UP:o=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(n===this._valueMax())return;o=this._trimAlignValue(n+a);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n===this._valueMin())return;o=this._trimAlignValue(n-a)}this._slide(i,r,o)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})}(jQuery),function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,this.element.val(this._format(i)),void 0}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(e(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(t,e){function i(){return++n}function s(t){return t.hash.length>1&&decodeURIComponent(t.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var n=0,o=/#.*$/;t.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var i=this.options.active,s=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(s,o){return t(o).attr("aria-controls")===n?(i=s,!1):e}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=this.tabs.length?0:!1)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=s?!1:0)),!s&&i===!1&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(i){var s=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(s),o=!0;if(!this._handlePageNav(i)){switch(i.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:o=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return i.preventDefault(),clearTimeout(this.activating),this._activate(n),e;case t.ui.keyCode.ENTER:return i.preventDefault(),clearTimeout(this.activating),this._activate(n===this.options.active?!1:n),e;default:return}i.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),i.ctrlKey||(s.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(i){return i.altKey&&i.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):i.altKey&&i.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):e},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,i){return"active"===t?(this._activate(i),e):"disabled"===t?(this._setupDisabled(i),e):(this._super(t,i),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",i),i||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(i),"heightStyle"===t&&this._setupHeightStyle(i),e)},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var o,a,r,h=t(n).uniqueId().attr("id"),l=t(n).closest("li"),c=l.attr("aria-controls");s(n)?(o=n.hash,a=e.element.find(e._sanitizeSelector(o))):(r=e._tabId(l),o="#"+r,a=e.element.find(o),a.length||(a=e._createPanel(r),a.insertAfter(e.panels[i-1]||e.tablist)),a.attr("aria-live","polite")),a.length&&(e.panels=e.panels.add(a)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":o.substring(1),"aria-labelledby":h}),a.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,s=0;i=this.tabs[s];s++)e===!0||-1!==t.inArray(s,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n.closest("li"),a=o[0]===s[0],r=a&&i.collapsible,h=r?t():this._getPanelForTab(o),l=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:l,newTab:r?t():o,newPanel:h};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=r?!1:this.tabs.index(o),this.active=a?t():o,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function s(){o.running=!1,o._trigger("activate",e,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,s):(a.show(),s())}var o=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var s=this.options.disabled;s!==!1&&(i===e?s=!1:(i=this._getIndex(i),s=t.isArray(s)?t.map(s,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(s))},disable:function(i){var s=this.options.disabled;if(s!==!0){if(i===e)s=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,s))return;s=t.isArray(s)?t.merge([i],s).sort():[i]}this._setupDisabled(s)}},load:function(e,i){e=this._getIndex(e);var n=this,o=this.tabs.eq(e),a=o.find(".ui-tabs-anchor"),r=this._getPanelForTab(o),h={tab:o,panel:r};s(a[0])||(this.xhr=t.ajax(this._ajaxSettings(a,i,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){r.html(t),n._trigger("load",i,h)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href"),beforeSend:function(e,o){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:o},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(t){function e(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")}var s=0;t.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var s=this;return"disabled"===e?(this[i?"_disable":"_enable"](),this.options[e]=i,void 0):(this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e)}),void 0)},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,o=e?e.type:null;return"string"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){t.data("ui-tooltip-open")&&n._delay(function(){e&&(e.type=o),this._open(e,t,i)})}),i&&this._open(e,t,i),void 0)},_open:function(i,s,n){function o(t){l.of=t,a.is(":hidden")||a.position(l)}var a,r,h,l=t.extend({},this.options.position);if(n){if(a=this._find(s),a.length)return a.find(".ui-tooltip-content").html(n),void 0;s.is("[title]")&&(i&&"mouseover"===i.type?s.attr("title",""):s.removeAttr("title")),a=this._tooltip(s),e(s,a.attr("id")),a.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:o}),o(i)):a.position(t.extend({of:s},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){a.is(":visible")&&(o(l.of),clearInterval(h))},t.fx.interval)),this._trigger("open",i,{tooltip:a}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=s[0],this.close(i,!0)}},remove:function(){this._removeTooltip(a)}},i&&"mouseover"!==i.type||(r.mouseleave="close"),i&&"focusin"!==i.type||(r.focusout="close"),this._on(!0,s,r)}},close:function(e){var s=this,n=t(e?e.currentTarget:this.element),o=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),i(n),o.stop(!0),this._hide(o,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:o}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+s++,n=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[i]=e,n},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})}})}(jQuery);
;;;
(function(m,f,l){'use strict';f.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(d,b){var c={},g={},h,i=!1,j=f.copy,k=f.isUndefined;b.addPollFn(function(){var a=b.cookies();h!=a&&(h=a,j(a,g),j(a,c),i&&d.$apply())})();i=!0;d.$watch(function(){var a,e,d;for(a in g)k(c[a])&&b.cookies(a,l);for(a in c)e=c[a],f.isString(e)?e!==g[a]&&(b.cookies(a,e),d=!0):f.isDefined(g[a])?c[a]=g[a]:delete c[a];if(d)for(a in e=b.cookies(),c)c[a]!==e[a]&&(k(e[a])?delete c[a]:c[a]=e[a])});return c}]).factory("$cookieStore",["$cookies",function(d){return{get:function(b){return(b=d[b])?f.fromJson(b):b},put:function(b,c){d[b]=f.toJson(c)},remove:function(b){delete d[b]}}}])})(window,window.angular);
;;;
(function(window,angular,undefined){'use strict';var ngMobile=angular.module('ngMobile',[]);ngMobile.config(['$provide',function($provide){$provide.decorator('ngClickDirective',['$delegate',function($delegate){$delegate.shift();return $delegate;}]);}]);ngMobile.directive('ngClick',['$parse','$timeout','$rootElement',function($parse,$timeout,$rootElement){var TAP_DURATION=750;var MOVE_TOLERANCE=12;var PREVENT_DURATION=2500;var CLICKBUSTER_THRESHOLD=25;var ACTIVE_CLASS_NAME='ng-click-active';var lastPreventedTime;var touchCoordinates;function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD;}
function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2){if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y)){touchCoordinates.splice(i,i+2);return true;}}
return false;}
function onClick(event){if(Date.now()-lastPreventedTime>PREVENT_DURATION){return;}
var touches=event.touches&&event.touches.length?event.touches:[event];var x=touches[0].clientX;var y=touches[0].clientY;if(x<1&&y<1){return;}
if(checkAllowableRegions(touchCoordinates,x,y)){return;}
event.stopPropagation();event.preventDefault();}
function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event];var x=touches[0].clientX;var y=touches[0].clientY;touchCoordinates.push(x,y);$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2){if(touchCoordinates[i]==x&&touchCoordinates[i+1]==y){touchCoordinates.splice(i,i+2);return;}}},PREVENT_DURATION,false);}
function preventGhostClick(x,y){if(!touchCoordinates){$rootElement[0].addEventListener('click',onClick,true);$rootElement[0].addEventListener('touchstart',onTouchStart,true);touchCoordinates=[];}
lastPreventedTime=Date.now();checkAllowableRegions(touchCoordinates,x,y);}
return function(scope,element,attr){var clickHandler=$parse(attr.ngClick),tapping=false,tapElement,startTime,touchStartX,touchStartY;function resetState(){tapping=false;element.removeClass(ACTIVE_CLASS_NAME);}
element.bind('touchstart',function(event){tapping=true;tapElement=event.target?event.target:event.srcElement;if(tapElement.nodeType==3){tapElement=tapElement.parentNode;}
element.addClass(ACTIVE_CLASS_NAME);startTime=Date.now();var touches=event.touches&&event.touches.length?event.touches:[event];var e=touches[0].originalEvent||touches[0];touchStartX=e.clientX;touchStartY=e.clientY;});element.bind('touchmove',function(event){resetState();});element.bind('touchcancel',function(event){resetState();});element.bind('touchend',function(event){var diff=Date.now()-startTime;var touches=(event.changedTouches&&event.changedTouches.length)?event.changedTouches:((event.touches&&event.touches.length)?event.touches:[event]);var e=touches[0].originalEvent||touches[0];var x=e.clientX;var y=e.clientY;var dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));if(tapping&&diff<TAP_DURATION&&dist<MOVE_TOLERANCE){preventGhostClick(x,y);if(tapElement){tapElement.blur();}
scope.$apply(function(){clickHandler(scope,{$event:event});});}
resetState();});element.onclick=function(event){};element.bind('click',function(event){scope.$apply(function(){clickHandler(scope,{$event:event});});});};}]);function makeSwipeDirective(directiveName,direction){ngMobile.directive(directiveName,['$parse',function($parse){var MAX_VERTICAL_DISTANCE=75;var MAX_VERTICAL_RATIO=0.3;var MIN_HORIZONTAL_DISTANCE=30;var MOVE_BUFFER_RADIUS=10;function getCoordinates(event){var touches=event.touches&&event.touches.length?event.touches:[event];var e=(event.changedTouches&&event.changedTouches[0])||(event.originalEvent&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches[0])||touches[0].originalEvent||touches[0];return{x:e.clientX,y:e.clientY};}
return function(scope,element,attr){var swipeHandler=$parse(attr[directiveName]);var startCoords,valid;var totalX,totalY;var lastX,lastY;function validSwipe(event){if(!startCoords)return false;var coords=getCoordinates(event);var deltaY=Math.abs(coords.y-startCoords.y);var deltaX=(coords.x-startCoords.x)*direction;return valid&&deltaY<MAX_VERTICAL_DISTANCE&&deltaX>0&&deltaX>MIN_HORIZONTAL_DISTANCE&&deltaY/deltaX<MAX_VERTICAL_RATIO;}
element.bind('touchstart mousedown',function(event){startCoords=getCoordinates(event);valid=true;totalX=0;totalY=0;lastX=startCoords.x;lastY=startCoords.y;});element.bind('touchcancel',function(event){valid=false;});element.bind('touchmove mousemove',function(event){if(!valid)return;if(!startCoords)return;var coords=getCoordinates(event);if(Math.abs(coords.y-startCoords.y)>MAX_VERTICAL_DISTANCE){valid=false;return;}
totalX+=Math.abs(coords.x-lastX);totalY+=Math.abs(coords.y-lastY);lastX=coords.x;lastY=coords.y;if(totalX<MOVE_BUFFER_RADIUS&&totalY<MOVE_BUFFER_RADIUS){return;}
if(totalY>totalX){valid=false;return;}else{event.preventDefault();}});element.bind('touchend mouseup',function(event){if(validSwipe(event)){event.stopPropagation();scope.$apply(function(){swipeHandler(scope,{$event:event});});}});};}]);}
makeSwipeDirective('ngSwipeLeft',-1);makeSwipeDirective('ngSwipeRight',1);})(window,window.angular);
;;;
(function(I,h){'use strict';function i(a){var d={},a=a.split(","),c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function z(a,d){function c(a,b,c,f){b=h.lowercase(b);if(m[b])for(;e.last()&&n[e.last()];)g("",e.last());o[b]&&e.last()==b&&g("",b);(f=p[b]||!!f)||e.push(b);var j={};c.replace(A,function(a,b,d,c,g){j[b]=k(d||c||g||"")});d.start&&d.start(b,j,f)}function g(a,b){var c=0,g;if(b=h.lowercase(b))for(c=e.length-1;c>=0;c--)if(e[c]==b)break;if(c>=0){for(g=e.length-1;g>=c;g--)d.end&&d.end(e[g]);e.length=c}}var b,f,e=[],j=a;for(e.last=function(){return e[e.length-1]};a;){f=!0;if(!e.last()||!q[e.last()]){if(a.indexOf("<\!--")===0)b=a.indexOf("--\>"),b>=0&&(d.comment&&d.comment(a.substring(4,b)),a=a.substring(b+3),f=!1);else if(B.test(a)){if(b=a.match(r))a=a.substring(b[0].length),b[0].replace(r,g),f=!1}else if(C.test(a)&&(b=a.match(s)))a=a.substring(b[0].length),b[0].replace(s,c),f=!1;f&&(b=a.indexOf("<"),f=b<0?a:a.substring(0,b),a=b<0?"":a.substring(b),d.chars&&d.chars(k(f)))}else a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+
e.last()+"[^>]*>","i"),function(a,b){b=b.replace(D,"$1").replace(E,"$1");d.chars&&d.chars(k(b));return""}),g("",e.last());if(a==j)throw"Parse Error: "+a;j=a}g()}function k(a){l.innerHTML=a.replace(/</g,"&lt;");return l.innerText||l.textContent||""}function t(a){return a.replace(/&/g,"&amp;").replace(F,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(a){var d=!1,c=h.bind(a,a.push);return{start:function(a,b,f){a=h.lowercase(a);!d&&q[a]&&(d=a);!d&&v[a]==!0&&(c("<"),c(a),h.forEach(b,function(a,b){var d=h.lowercase(b);if(G[d]==!0&&(w[d]!==!0||a.match(H)))c(" "),c(b),c('="'),c(t(a)),c('"')}),c(f?"/>":">"))},end:function(a){a=h.lowercase(a);!d&&v[a]==!0&&(c("</"),c(a),c(">"));a==d&&(d=!1)},chars:function(a){d||c(t(a))}}}var s=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,r=/^<\s*\/\s*([\w:-]+)[^>]*>/,A=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,C=/^</,B=/^<\s*\//,D=/<\!--(.*?)--\>/g,E=/<!\[CDATA\[(.*?)]]\>/g,H=/^((ftp|https?):\/\/|mailto:|tel:|#)/,F=/([^\#-~| |!])/g,p=i("area,br,col,hr,img,wbr"),x=i("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y=i("rp,rt"),o=h.extend({},y,x),m=h.extend({},x,i("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),n=h.extend({},y,i("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),q=i("script,style"),v=h.extend({},p,m,n,o),w=i("background,cite,href,longdesc,src,usemap"),G=h.extend({},w,i("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,span,start,summary,target,title,type,valign,value,vspace,width")),l=document.createElement("pre");h.module("ngSanitize",[]).value("$sanitize",function(a){var d=[];z(a,u(d));return d.join("")});h.module("ngSanitize").directive("ngBindHtml",["$sanitize",function(a){return function(d,c,g){c.addClass("ng-binding").data("$binding",g.ngBindHtml);d.$watch(g.ngBindHtml,function(b){b=a(b);c.html(b||"")})}}]);h.module("ngSanitize").filter("linky",function(){var a=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s\.\;\,\(\)\{\}\<\>]/,d=/^mailto:/;return function(c,g){if(!c)return c;var b,f=c,e=[],j=u(e),i,k,l={};if(h.isDefined(g))l.target=g;for(;b=f.match(a);)i=b[0],b[2]==b[3]&&(i="mailto:"+i),k=b.index,j.chars(f.substr(0,k)),l.href=i,j.start("a",l),j.chars(b[0].replace(d,"")),j.end("a"),f=f.substring(k+b[0].length);j.chars(f);return e.join("")}})})(window,window.angular);
;;;
angular.module('ui.sortable',[]).value('uiSortableConfig',{}).directive('uiSortable',['uiSortableConfig','$timeout','$log',function(uiSortableConfig,$timeout,$log){return{require:'?ngModel',link:function(scope,element,attrs,ngModel){var savedNodes;function combineCallbacks(first,second){if(second&&(typeof second==='function')){return function(e,ui){first(e,ui);second(e,ui);};}
return first;}
function hasSortingHelper(element,ui){var helperOption=element.sortable('option','helper');return helperOption==='clone'||(typeof helperOption==='function'&&ui.item.sortable.isCustomHelperUsed());}
var opts={};var callbacks={receive:null,remove:null,start:null,stop:null,update:null};var wrappers={helper:null};angular.extend(opts,uiSortableConfig,scope.$eval(attrs.uiSortable));if(!angular.element.fn||!angular.element.fn.jquery){$log.error('ui.sortable: jQuery should be included before AngularJS!');return;}
if(ngModel){scope.$watch(attrs.ngModel+'.length',function(){$timeout(function(){if(!!element.data('ui-sortable')){element.sortable('refresh');}});});callbacks.start=function(e,ui){ui.item.sortable={index:ui.item.index(),cancel:function(){ui.item.sortable._isCanceled=true;},isCanceled:function(){return ui.item.sortable._isCanceled;},isCustomHelperUsed:function(){return!!ui.item.sortable._isCustomHelperUsed;},_isCanceled:false,_isCustomHelperUsed:ui.item.sortable._isCustomHelperUsed};};callbacks.activate=function(){savedNodes=element.contents();var placeholder=element.sortable('option','placeholder');if(placeholder&&placeholder.element&&typeof placeholder.element==='function'){var phElement=placeholder.element();phElement=angular.element(phElement);var excludes=element.find('[class="'+phElement.attr('class')+'"]');savedNodes=savedNodes.not(excludes);}};callbacks.update=function(e,ui){if(!ui.item.sortable.received){ui.item.sortable.dropindex=ui.item.index();ui.item.sortable.droptarget=ui.item.parent();element.sortable('cancel');}
if(hasSortingHelper(element,ui)&&!ui.item.sortable.received&&element.sortable('option','appendTo')==='parent'){savedNodes=savedNodes.not(savedNodes.last());}
savedNodes.appendTo(element);if(ui.item.sortable.received){savedNodes=null;}
if(ui.item.sortable.received&&!ui.item.sortable.isCanceled()){scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ui.item.sortable.moved);});}};callbacks.stop=function(e,ui){if(!ui.item.sortable.received&&('dropindex'in ui.item.sortable)&&!ui.item.sortable.isCanceled()){scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]);});}else{if((!('dropindex'in ui.item.sortable)||ui.item.sortable.isCanceled())&&!hasSortingHelper(element,ui)){savedNodes.appendTo(element);}}
savedNodes=null;};callbacks.receive=function(e,ui){ui.item.sortable.received=true;};callbacks.remove=function(e,ui){if(!('dropindex'in ui.item.sortable)){element.sortable('cancel');ui.item.sortable.cancel();}
if(!ui.item.sortable.isCanceled()){scope.$apply(function(){ui.item.sortable.moved=ngModel.$modelValue.splice(ui.item.sortable.index,1)[0];});}};wrappers.helper=function(inner){if(inner&&typeof inner==='function'){return function(e,item){var innerResult=inner(e,item);item.sortable._isCustomHelperUsed=item!==innerResult;return innerResult;};}
return inner;};scope.$watch(attrs.uiSortable,function(newVal){if(!!element.data('ui-sortable')){angular.forEach(newVal,function(value,key){if(callbacks[key]){if(key==='stop'){value=combineCallbacks(value,function(){scope.$apply();});}
value=combineCallbacks(callbacks[key],value);}else if(wrappers[key]){value=wrappers[key](value);}
element.sortable('option',key,value);});}},true);angular.forEach(callbacks,function(value,key){opts[key]=combineCallbacks(value,opts[key]);});}else{$log.info('ui.sortable: ngModel not provided!',element);}
element.sortable(opts);}};}]);
;;;
(function(window){'use strict';angular.module('tmh.dynamicLocale',[]).provider('tmhDynamicLocale',function(){var defaultLocale,localeLocationPattern='angular/i18n/angular-locale_{{locale}}.js',storageFactory='tmhDynamicLocaleStorageCache',storage,storeKey='tmhDynamicLocale.locale',promiseCache={},activeLocale;function loadScript(url,callback,errorCallback,$timeout){var script=document.createElement('script'),body=document.getElementsByTagName('body')[0],removed=false;script.type='text/javascript';if(script.readyState){script.onreadystatechange=function(){if(script.readyState==='complete'||script.readyState==='loaded'){script.onreadystatechange=null;$timeout(function(){if(removed)return;removed=true;body.removeChild(script);callback();},30,false);}};}else{script.onload=function(){if(removed)return;removed=true;body.removeChild(script);callback();};script.onerror=function(){if(removed)return;removed=true;body.removeChild(script);errorCallback();};}
script.src=url;script.async=false;body.appendChild(script);}
function loadLocale(localeUrl,$locale,localeId,$rootScope,$q,localeCache,$timeout){function overrideValues(oldObject,newObject){if(activeLocale!==localeId){return;}
angular.forEach(oldObject,function(value,key){if(!newObject[key]){delete oldObject[key];}else if(angular.isArray(newObject[key])){oldObject[key].length=newObject[key].length;}});angular.forEach(newObject,function(value,key){if(angular.isArray(newObject[key])||angular.isObject(newObject[key])){if(!oldObject[key]){oldObject[key]=angular.isArray(newObject[key])?[]:{};}
overrideValues(oldObject[key],newObject[key]);}else{oldObject[key]=newObject[key];}});}
if(promiseCache[localeId])return promiseCache[localeId];var cachedLocale,deferred=$q.defer();if(localeId===activeLocale){deferred.resolve($locale);}else if((cachedLocale=localeCache.get(localeId))){activeLocale=localeId;$rootScope.$evalAsync(function(){overrideValues($locale,cachedLocale);$rootScope.$broadcast('$localeChangeSuccess',localeId,$locale);storage.put(storeKey,localeId);deferred.resolve($locale);});}else{activeLocale=localeId;promiseCache[localeId]=deferred.promise;loadScript(localeUrl,function(){var localInjector=angular.injector(['ngLocale']),externalLocale=localInjector.get('$locale');overrideValues($locale,externalLocale);localeCache.put(localeId,externalLocale);delete promiseCache[localeId];$rootScope.$apply(function(){$rootScope.$broadcast('$localeChangeSuccess',localeId,$locale);storage.put(storeKey,localeId);deferred.resolve($locale);});},function(){delete promiseCache[localeId];$rootScope.$apply(function(){$rootScope.$broadcast('$localeChangeError',localeId);deferred.reject(localeId);});},$timeout);}
return deferred.promise;}
this.localeLocationPattern=function(value){if(value){localeLocationPattern=value;return this;}else{return localeLocationPattern;}};this.useStorage=function(storageName){storageFactory=storageName;};this.useCookieStorage=function(){this.useStorage('$cookieStore');};this.defaultLocale=function(value){defaultLocale=value;};this.$get=['$rootScope','$injector','$interpolate','$locale','$q','tmhDynamicLocaleCache','$timeout',function($rootScope,$injector,interpolate,locale,$q,tmhDynamicLocaleCache,$timeout){var localeLocation=interpolate(localeLocationPattern);storage=$injector.get(storageFactory);$rootScope.$evalAsync(function(){var initialLocale;if((initialLocale=(storage.get(storeKey)||defaultLocale))){loadLocale(localeLocation({locale:initialLocale}),locale,initialLocale,$rootScope,$q,tmhDynamicLocaleCache,$timeout);}});return{set:function(value){return loadLocale(localeLocation({locale:value}),locale,value,$rootScope,$q,tmhDynamicLocaleCache,$timeout);}};}];}).provider('tmhDynamicLocaleCache',function(){this.$get=['$cacheFactory',function($cacheFactory){return $cacheFactory('tmh.dynamicLocales');}];}).provider('tmhDynamicLocaleStorageCache',function(){this.$get=['$cacheFactory',function($cacheFactory){return $cacheFactory('tmh.dynamicLocales.store');}];}).run(['tmhDynamicLocale',angular.noop]);}(window));
;;;
!function(a){"use strict";var b=function(a,c,d){var e,f,g=document.createElement("img");if(g.onerror=c,g.onload=function(){!f||d&&d.noRevoke||b.revokeObjectURL(f),c&&c(b.scale(g,d))},b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a))e=f=b.createObjectURL(a),g._type=a.type;else{if("string"!=typeof a)return!1;e=a,d&&d.crossOrigin&&(g.crossOrigin=d.crossOrigin)}return e?(g.src=e,g):b.readFile(a,function(a){var b=a.target;b&&b.result?g.src=b.result:c&&c(a)})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(a,b){var c,d,e,f,g=b.aspectRatio;if(!g)return b;c={};for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c.crop=!0,e=a.naturalWidth||a.width,f=a.naturalHeight||a.height,e/f>g?(c.maxWidth=f*g,c.maxHeight=f):(c.maxWidth=e,c.maxHeight=e/g),c},b.renderImageToCanvas=function(a,b,c,d,e,f,g,h,i,j){return a.getContext("2d").drawImage(b,c,d,e,f,g,h,i,j),a},b.hasCanvasOption=function(a){return a.canvas||a.crop||a.aspectRatio},b.scale=function(a,c){c=c||{};var d,e,f,g,h,i,j,k,l,m=document.createElement("canvas"),n=a.getContext||b.hasCanvasOption(c)&&m.getContext,o=a.naturalWidth||a.width,p=a.naturalHeight||a.height,q=o,r=p,s=function(){var a=Math.max((f||q)/q,(g||r)/r);a>1&&(q*=a,r*=a)},t=function(){var a=Math.min((d||q)/q,(e||r)/r);1>a&&(q*=a,r*=a)};return n&&(c=b.getTransformedOptions(a,c),j=c.left||0,k=c.top||0,c.sourceWidth?(h=c.sourceWidth,void 0!==c.right&&void 0===c.left&&(j=o-h-c.right)):h=o-j-(c.right||0),c.sourceHeight?(i=c.sourceHeight,void 0!==c.bottom&&void 0===c.top&&(k=p-i-c.bottom)):i=p-k-(c.bottom||0),q=h,r=i),d=c.maxWidth,e=c.maxHeight,f=c.minWidth,g=c.minHeight,n&&d&&e&&c.crop?(q=d,r=e,l=h/i-d/e,0>l?(i=e*h/d,void 0===c.top&&void 0===c.bottom&&(k=(p-i)/2)):l>0&&(h=d*i/e,void 0===c.left&&void 0===c.right&&(j=(o-h)/2))):((c.contain||c.cover)&&(f=d=d||f,g=e=e||g),c.cover?(t(),s()):(s(),t())),n?(m.width=q,m.height=r,b.transformCoordinates(m,c),b.renderImageToCanvas(m,a,j,k,h,i,0,0,q,r)):(a.width=q,a.height=r,a)},b.createObjectURL=function(a){return c?c.createObjectURL(a):!1},b.revokeObjectURL=function(a){return c?c.revokeObjectURL(a):!1},b.readFile=function(a,b,c){if(window.FileReader){var d=new FileReader;if(d.onload=d.onerror=b,c=c||"readAsDataURL",d[c])return d[c](a),d}return!1},"function"==typeof define&&define.amd?define(function(){return b}):a.loadImage=b}(this),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var b=a.renderImageToCanvas;a.detectSubsampling=function(a){var b,c;return a.width*a.height>1048576?(b=document.createElement("canvas"),b.width=b.height=1,c=b.getContext("2d"),c.drawImage(a,-a.width+1,0),0===c.getImageData(0,0,1,1).data[3]):!1},a.detectVerticalSquash=function(a,b){var c,d,e,f,g,h=a.naturalHeight||a.height,i=document.createElement("canvas"),j=i.getContext("2d");for(b&&(h/=2),i.width=1,i.height=h,j.drawImage(a,0,0),c=j.getImageData(0,0,1,h).data,d=0,e=h,f=h;f>d;)g=c[4*(f-1)+3],0===g?e=f:d=f,f=e+d>>1;return f/h||1},a.renderImageToCanvas=function(c,d,e,f,g,h,i,j,k,l){if("image/jpeg"===d._type){var m,n,o,p,q=c.getContext("2d"),r=document.createElement("canvas"),s=1024,t=r.getContext("2d");if(r.width=s,r.height=s,q.save(),m=a.detectSubsampling(d),m&&(e/=2,f/=2,g/=2,h/=2),n=a.detectVerticalSquash(d,m),m||1!==n){for(f*=n,k=Math.ceil(s*k/g),l=Math.ceil(s*l/h/n),j=0,p=0;h>p;){for(i=0,o=0;g>o;)t.clearRect(0,0,s,s),t.drawImage(d,e,f,g,h,-o,-p,g,h),q.drawImage(r,0,0,s,s,i,j,k,l),o+=s,i+=k;p+=s,j+=l}return q.restore(),c}}return b(c,d,e,f,g,h,i,j,k,l)}}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=a.hasCanvasOption,c=a.transformCoordinates,d=a.getTransformedOptions;a.hasCanvasOption=function(c){return b.call(a,c)||c.orientation},a.transformCoordinates=function(b,d){c.call(a,b,d);var e=b.getContext("2d"),f=b.width,g=b.height,h=d.orientation;if(h&&!(h>8))switch(h>4&&(b.width=g,b.height=f),h){case 2:e.translate(f,0),e.scale(-1,1);break;case 3:e.translate(f,g),e.rotate(Math.PI);break;case 4:e.translate(0,g),e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI),e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI),e.translate(0,-g);break;case 7:e.rotate(.5*Math.PI),e.translate(f,-g),e.scale(-1,1);break;case 8:e.rotate(-.5*Math.PI),e.translate(-f,0)}},a.getTransformedOptions=function(b,c){var e,f,g=d.call(a,b,c),h=g.orientation;if(!h||h>8||1===h)return g;e={};for(f in g)g.hasOwnProperty(f)&&(e[f]=g[f]);switch(g.orientation){case 2:e.left=g.right,e.right=g.left;break;case 3:e.left=g.right,e.top=g.bottom,e.right=g.left,e.bottom=g.top;break;case 4:e.top=g.bottom,e.bottom=g.top;break;case 5:e.left=g.top,e.top=g.left,e.right=g.bottom,e.bottom=g.right;break;case 6:e.left=g.top,e.top=g.right,e.right=g.bottom,e.bottom=g.left;break;case 7:e.left=g.bottom,e.top=g.right,e.right=g.top,e.bottom=g.left;break;case 8:e.left=g.bottom,e.top=g.left,e.right=g.top,e.bottom=g.right}return g.orientation>4&&(e.maxWidth=g.maxHeight,e.maxHeight=g.maxWidth,e.minWidth=g.minHeight,e.minHeight=g.minWidth,e.sourceWidth=g.sourceHeight,e.sourceHeight=g.sourceWidth),e}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.blobSlice=b&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},a.metaDataParsers={jpeg:{65505:[]}},a.parseMetaData=function(b,c,d){d=d||{};var e=this,f=d.maxMetaDataSize||262144,g={},h=!(window.DataView&&b&&b.size>=12&&"image/jpeg"===b.type&&a.blobSlice);(h||!a.readFile(a.blobSlice.call(b,0,f),function(b){if(b.target.error)return console.log(b.target.error),void c(g);var f,h,i,j,k=b.target.result,l=new DataView(k),m=2,n=l.byteLength-4,o=m;if(65496===l.getUint16(0)){for(;n>m&&(f=l.getUint16(m),f>=65504&&65519>=f||65534===f);){if(h=l.getUint16(m+2)+2,m+h>l.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=a.metaDataParsers.jpeg[f])for(j=0;j<i.length;j+=1)i[j].call(e,l,m,h,g,d);m+=h,o=m}!d.disableImageHead&&o>6&&(g.imageHead=k.slice?k.slice(0,o):new Uint8Array(k).subarray(0,o))}else console.log("Invalid JPEG file: Missing JPEG marker.");c(g)},"readAsArrayBuffer"))&&c(g)}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap=function(){return this},a.ExifMap.prototype.map={Orientation:274},a.ExifMap.prototype.get=function(a){return this[a]||this[this.map[a]]},a.getExifThumbnail=function(a,b,c){var d,e,f;if(!c||b+c>a.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(d=[],e=0;c>e;e+=1)f=a.getUint8(b+e),d.push((16>f?"0":"")+f.toString(16));return"data:image/jpeg,%"+d.join("%")},a.exifTagTypes={1:{getValue:function(a,b){return a.getUint8(b)},size:1},2:{getValue:function(a,b){return String.fromCharCode(a.getUint8(b))},size:1,ascii:!0},3:{getValue:function(a,b,c){return a.getUint16(b,c)},size:2},4:{getValue:function(a,b,c){return a.getUint32(b,c)},size:4},5:{getValue:function(a,b,c){return a.getUint32(b,c)/a.getUint32(b+4,c)},size:8},9:{getValue:function(a,b,c){return a.getInt32(b,c)},size:4},10:{getValue:function(a,b,c){return a.getInt32(b,c)/a.getInt32(b+4,c)},size:8}},a.exifTagTypes[7]=a.exifTagTypes[1],a.getExifValue=function(b,c,d,e,f,g){var h,i,j,k,l,m,n=a.exifTagTypes[e];if(!n)return void console.log("Invalid Exif data: Invalid tag type.");if(h=n.size*f,i=h>4?c+b.getUint32(d+8,g):d+8,i+h>b.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===f)return n.getValue(b,i,g);for(j=[],k=0;f>k;k+=1)j[k]=n.getValue(b,i+k*n.size,g);if(n.ascii){for(l="",k=0;k<j.length&&(m=j[k],"\x00"!==m);k+=1)l+=m;return l}return j},a.parseExifTag=function(b,c,d,e,f){var g=b.getUint16(d,e);f.exif[g]=a.getExifValue(b,c,d,b.getUint16(d+2,e),b.getUint32(d+4,e),e)},a.parseExifTags=function(a,b,c,d,e){var f,g,h;if(c+6>a.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(f=a.getUint16(c,d),g=c+2+12*f,g+4>a.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(h=0;f>h;h+=1)this.parseExifTag(a,b,c+2+12*h,d,e);return a.getUint32(g,d)},a.parseExifData=function(b,c,d,e,f){if(!f.disableExif){var g,h,i,j=c+10;if(1165519206===b.getUint32(c+4)){if(j+8>b.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==b.getUint16(c+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(b.getUint16(j)){case 18761:g=!0;break;case 19789:g=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==b.getUint16(j+2,g))return void console.log("Invalid Exif data: Missing TIFF marker.");h=b.getUint32(j+4,g),e.exif=new a.ExifMap,h=a.parseExifTags(b,j,j+h,g,e),h&&!f.disableExifThumbnail&&(i={exif:{}},h=a.parseExifTags(b,j,j+h,g,i),i.exif[513]&&(e.exif.Thumbnail=a.getExifThumbnail(b,j+i.exif[513],i.exif[514]))),e.exif[34665]&&!f.disableExifSub&&a.parseExifTags(b,j,j+e.exif[34665],g,e),e.exif[34853]&&!f.disableExifGps&&a.parseExifTags(b,j,j+e.exif[34853],g,e)}}},a.metaDataParsers.jpeg[65505].push(a.parseExifData)}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},a.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},a.ExifMap.prototype.getText=function(a){var b=this.get(a);switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[a][b];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(b[0],b[1],b[2],b[3]);case"ComponentsConfiguration":return this.stringValues[a][b[0]]+this.stringValues[a][b[1]]+this.stringValues[a][b[2]]+this.stringValues[a][b[3]];case"GPSVersionID":return b[0]+"."+b[1]+"."+b[2]+"."+b[3]}return String(b)},function(a){var b,c=a.tags,d=a.map;for(b in c)c.hasOwnProperty(b)&&(d[c[b]]=b)}(a.ExifMap.prototype),a.ExifMap.prototype.getAll=function(){var a,b,c={};for(a in this)this.hasOwnProperty(a)&&(b=this.tags[a],b&&(c[b]=this.getText(b)));return c}});
;;;
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','jquery.ui.widget'],factory);}else{factory(window.jQuery);}}(function($){'use strict';$.support.fileInput=!(new RegExp('(Android (1\\.[0156]|2\\.[01]))'+'|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)'+'|(w(eb)?OSBrowser)|(webOS)'+'|(Kindle/(1\\.0|2\\.[05]|3\\.0))').test(window.navigator.userAgent)||$('<input type="file">').prop('disabled'));$.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget('blueimp.fileupload',{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:'Uploaded bytes exceed file size'},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace('{'+key+'}',value);});}
return message;},formData:function(form){return form.serializeArray();},add:function(e,data){if(e.isDefaultPrevented()){return false;}
if(data.autoUpload||(data.autoUpload!==false&&$(this).fileupload('option','autoUpload'))){data.process().done(function(){data.submit();});}},processData:false,contentType:false,cache:false},_specialOptions:['fileInput','dropZone','pasteZone','multipart','forceIframeTransport'],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments);},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1000/timeDiff)*8;this.loaded=loaded;this.timestamp=now;}
return this.bitrate;};},_isXHRUpload:function(options){return!options.forceIframeTransport&&((!options.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload);},_getFormData:function(options){var formData;if($.type(options.formData)==='function'){return options.formData(options.form);}
if($.isArray(options.formData)){return options.formData;}
if($.type(options.formData)==='object'){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value});});return formData;}
return[];},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1;});return total;},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress);}else{obj._progress=progress;}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop];}}}else{obj._response={};}},_onProgress:function(e,data){if(e.lengthComputable){var now=((Date.now)?Date.now():(new Date()).getTime()),loaded;if(data._time&&data.progressInterval&&(now-data._time<data.progressInterval)&&e.loaded!==e.total){return;}
data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=(loaded-data._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger('progress',$.Event('progress',{delegatedEvent:e}),data);this._trigger('progressall',$.Event('progressall',{delegatedEvent:e}),this._progress);}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind('progress',function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options);});options.xhr=function(){return xhr;};}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)==='[object '+type+']';},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=options.paramName[0];options.headers=$.extend({},options.headers);if(options.contentRange){options.headers['Content-Range']=options.contentRange;}
if(!multipart||options.blob||!this._isInstanceOf('File',file)){options.headers['Content-Disposition']='attachment; filename="'+
encodeURI(file.name)+'"';}
if(!multipart){options.contentType=file.type||'application/octet-stream';options.data=options.blob||file;}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob});}else{$.each(options.files,function(index,file){formData.push({name:options.paramName[index]||paramName,value:file});});}}else{if(that._isInstanceOf('FormData',options.formData)){formData=options.formData;}else{formData=new FormData();$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value);});}
if(options.blob){formData.append(paramName,options.blob,file.name);}else{$.each(options.files,function(index,file){if(that._isInstanceOf('File',file)||that._isInstanceOf('Blob',file)){formData.append(options.paramName[index]||paramName,file,file.uploadName||file.name);}});}}
options.data=formData;}
options.blob=null;},_initIframeSettings:function(options){var targetHost=$('<a></a>').prop('href',options.url).prop('host');options.dataType='iframe '+(options.dataType||'');options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||'redirect',value:options.redirect});}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options);}
this._initProgressListener(options);}
if(options.postMessage){options.dataType='postmessage '+(options.dataType||'');}}else{this._initIframeSettings(options);}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop('name')||'files[]',i=(input.prop('files')||[1]).length;while(i){paramName.push(name);i-=1;}});if(!paramName.length){paramName=[fileInput.prop('name')||'files[]'];}}else if(!$.isArray(paramName)){paramName=[paramName];}
return paramName;},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop('form'));if(!options.form.length){options.form=$(this.options.fileInput.prop('form'));}}
options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop('action')||location.href;}
options.type=(options.type||($.type(options.form.prop('method'))==='string'&&options.form.prop('method'))||'').toUpperCase();if(options.type!=='POST'&&options.type!=='PUT'&&options.type!=='PATCH'){options.type='POST';}
if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr('accept-charset');}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options;},_getDeferredState:function(deferred){if(deferred.state){return deferred.state();}
if(deferred.isResolved()){return'resolved';}
if(deferred.isRejected()){return'rejected';}
return'pending';},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise;},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args);}else if(resolveOrReject===false){dfd.rejectWith(context,args);}
promise.abort=dfd.promise;return this._enhancePromise(promise);},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(args){return $.Deferred().resolveWith(that,args).promise();};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise([this])).pipe(function(){if(data.errorThrown){return $.Deferred().rejectWith(that,[data]).promise();}
return getPromise(arguments);}).pipe(resolveFunc,rejectFunc);}
return this._processQueue||getPromise([this]);};data.submit=function(){if(this.state()!=='pending'){data.jqXHR=this.jqXHR=(that._trigger('submit',$.Event('submit',{delegatedEvent:e}),this)!==false)&&that._onSend(e,this);}
return this.jqXHR||that._getXHRPromise();};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort();}
this.errorThrown='abort';that._trigger('fail',null,this);return that._getXHRPromise(false);};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR);}
if(this._processQueue){return that._getDeferredState(this._processQueue);}};data.processing=function(){return!this.jqXHR&&this._processQueue&&that._getDeferredState(this._processQueue)==='pending';};data.progress=function(){return this._progress;};data.response=function(){return this._response;};},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader('Range'),parts=range&&range.split('-'),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1;},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false;}
if(testOnly){return true;}
if(ub>=fs){file.error=options.i18n('uploadedBytes');return this._getXHRPromise(false,options.context,[null,'error',file.error]);}
upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange='bytes '+ub+'-'+
(ub+o.chunkSize-1)+'/'+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=((that._trigger('chunksend',null,o)!==false&&$.ajax(o))||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||(ub+o.chunkSize);if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event('progress',{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o);}
options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger('chunkdone',null,o);that._trigger('chunkalways',null,o);if(ub<fs){upload();}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR]);}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger('chunkfail',null,o);that._trigger('chunkalways',null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown]);});};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort();};upload();return promise;},_beforeSend:function(e,data){if(this._active===0){this._trigger('start');this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0;}
this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total;},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event('progress',{lengthComputable:true,loaded:total,total:total}),options);}
response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger('done',null,options);},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total;}
response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger('fail',null,options);},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger('always',null,options);},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data);}
var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer();jqXHR=jqXHR||(((aborted||that._trigger('send',$.Event('send',{delegatedEvent:e}),options)===false)&&that._getXHRPromise(false,options.context,aborted))||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options);}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options);}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)==='pending'){nextSlot.resolve();break;}
nextSlot=that._slots.shift();}}
if(that._active===0){that._trigger('stop');}});return jqXHR;};this._beforeSend(e,options);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send);}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence;}
pipe.abort=function(){aborted=[undefined,'abort','abort'];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted);}
return send();}
return jqXHR.abort();};return this._enhancePromise(pipe);}
return send();},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),files=data.files,filesLength=files.length,limit=options.limitMultiFileUploads,limitSize=options.limitMultiFileUploadSize,overhead=options.limitMultiFileUploadSizeOverhead,batchSize=0,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i,j=0;if(limitSize&&(!filesLength||files[0].size===undefined)){limitSize=undefined;}
if(!(options.singleFileUploads||limit||limitSize)||!this._isXHRUpload(options)){fileSet=[files];paramNameSet=[paramName];}else if(!(options.singleFileUploads||limitSize)&&limit){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i+=limit){fileSet.push(files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);}}else if(!options.singleFileUploads&&limitSize){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i=i+1){batchSize+=files[i].size+overhead;if(i+1===filesLength||(batchSize+files[i+1].size+overhead)>limitSize){fileSet.push(files.slice(j,i+1));paramNameSlice=paramName.slice(j,i+1);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);j=i+1;batchSize=0;}}}else{paramNameSet=paramName;}
data.originalFiles=files;$.each(fileSet||files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger('add',$.Event('add',{delegatedEvent:e}),newData);return result;});return result;},_replaceFileInput:function(input){var inputClone=input.clone(true);$('<form></form>').append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind('remove'));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0];}
return el;});if(input[0]===this.element[0]){this.element=inputClone;}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry;}
dfd.resolve([e]);},dirReader;path=path||'';if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file);}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file);},errorHandler);}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+'/').done(function(files){dfd.resolve(files);}).fail(errorHandler);},errorHandler);}else{dfd.resolve([]);}
return dfd.promise();},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path);})).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile();}
return entry;}
return item.getAsEntry();}));}
return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise();},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop('webkitEntries')||fileInput.prop('entries'),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries);}
files=$.makeArray(fileInput.prop('files'));if(!files.length){value=fileInput.prop('value');if(!value){return $.Deferred().resolve([]).promise();}
files=[{name:value.replace(/^.*\\/,'')}];}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize;});}
return $.Deferred().resolve(files).promise();},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput);}
return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput);}
if(that._trigger('change',$.Event('change',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file);}});if(this._trigger('paste',$.Event('paste',{delegatedEvent:e}),data)!==false){this._onAdd(e,data);}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger('drop',$.Event('drop',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer;if(dataTransfer&&$.inArray('Files',dataTransfer.types)!==-1&&this._trigger('dragover',$.Event('dragover',{delegatedEvent:e}))!==false){e.preventDefault();dataTransfer.dropEffect='copy';}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste});}
if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange});}},_destroyEventHandlers:function(){this._off(this.options.dropZone,'dragover drop');this._off(this.options.pasteZone,'paste');this._off(this.options.fileInput,'change');},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers();}
this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers();}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]');}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput);}
if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone);}
if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone);}},_getRegExp:function(str){var parts=str.split('/'),modifiers=parts.pop();parts.shift();return new RegExp(parts.join('/'),modifiers);},_isRegExpOption:function(key,value){return key!=='url'&&$.type(value)==='string'&&/^\/.*\/[igm]{0,3}$/.test(value);},_initDataAttributes:function(){var that=this,options=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(key,value){if(that._isRegExpOption(key,value)){value=that._getRegExp(value);}
options[key]=value;});},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers();},active:function(){return this._active;},progress:function(){return this._progress;},add:function(data){var that=this;if(!data||this.options.disabled){return;}
if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data);});}else{data.files=$.makeArray(data.files);this._onAdd(null,data);}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort();}
dfd.reject(null,'abort','abort');return promise;};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return;}
if(!files.length){dfd.reject();return;}
data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR);},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown);});});return this._enhancePromise(promise);}
data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data);}}
return this._getXHRPromise(false,data&&data.context);}});}));
;;;
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','./jquery.fileupload'],factory);}else{factory(window.jQuery);}}(function($){'use strict';var originalAdd=$.blueimp.fileupload.prototype.options.add;$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{processQueue:[],add:function(e,data){var $this=$(this);data.process(function(){return $this.fileupload('process',data);});originalAdd.call(this,e,data);}},processActions:{},_processFile:function(data,originalData){var that=this,dfd=$.Deferred().resolveWith(that,[data]),chain=dfd.promise();this._trigger('process',null,data);$.each(data.processQueue,function(i,settings){var func=function(data){if(originalData.errorThrown){return $.Deferred().rejectWith(that,[originalData]).promise();}
return that.processActions[settings.action].call(that,data,settings);};chain=chain.pipe(func,settings.always&&func);});chain.done(function(){that._trigger('processdone',null,data);that._trigger('processalways',null,data);}).fail(function(){that._trigger('processfail',null,data);that._trigger('processalways',null,data);});return chain;},_transformProcessQueue:function(options){var processQueue=[];$.each(options.processQueue,function(){var settings={},action=this.action,prefix=this.prefix===true?action:this.prefix;$.each(this,function(key,value){if($.type(value)==='string'&&value.charAt(0)==='@'){settings[key]=options[value.slice(1)||(prefix?prefix+
key.charAt(0).toUpperCase()+key.slice(1):key)];}else{settings[key]=value;}});processQueue.push(settings);});options.processQueue=processQueue;},processing:function(){return this._processing;},process:function(data){var that=this,options=$.extend({},this.options,data);if(options.processQueue&&options.processQueue.length){this._transformProcessQueue(options);if(this._processing===0){this._trigger('processstart');}
$.each(data.files,function(index){var opts=index?$.extend({},options):options,func=function(){if(data.errorThrown){return $.Deferred().rejectWith(that,[data]).promise();}
return that._processFile(opts,data);};opts.index=index;that._processing+=1;that._processingQueue=that._processingQueue.pipe(func,func).always(function(){that._processing-=1;if(that._processing===0){that._trigger('processstop');}});});}
return this._processingQueue;},_create:function(){this._super();this._processing=0;this._processingQueue=$.Deferred().resolveWith(this).promise();}});}));
;;;
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','load-image','load-image-meta','load-image-exif','load-image-ios','canvas-to-blob','./jquery.fileupload-process'],factory);}else{factory(window.jQuery,window.loadImage);}}(function($,loadImage){'use strict';$.blueimp.fileupload.prototype.options.processQueue.unshift({action:'loadImageMetaData',disableImageHead:'@',disableExif:'@',disableExifThumbnail:'@',disableExifSub:'@',disableExifGps:'@',disabled:'@disableImageMetaDataLoad'},{action:'loadImage',prefix:true,fileTypes:'@',maxFileSize:'@',noRevoke:'@',disabled:'@disableImageLoad'},{action:'resizeImage',prefix:'image',maxWidth:'@',maxHeight:'@',minWidth:'@',minHeight:'@',crop:'@',orientation:'@',forceResize:'@',disabled:'@disableImageResize'},{action:'saveImage',quality:'@imageQuality',type:'@imageType',disabled:'@disableImageResize'},{action:'saveImageMetaData',disabled:'@disableImageMetaDataSave'},{action:'resizeImage',prefix:'preview',maxWidth:'@',maxHeight:'@',minWidth:'@',minHeight:'@',crop:'@',orientation:'@',thumbnail:'@',canvas:'@',disabled:'@disableImagePreview'},{action:'setImage',name:'@imagePreviewName',disabled:'@disableImagePreview'});$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png)$/,loadImageMaxFileSize:10000000,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:false,imageCrop:false,disableImageResize:true,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:true,previewThumbnail:true,previewCrop:false,previewCanvas:true},processActions:{loadImage:function(data,options){if(options.disabled){return data;}
var that=this,file=data.files[data.index],dfd=$.Deferred();if(($.type(options.maxFileSize)==='number'&&file.size>options.maxFileSize)||(options.fileTypes&&!options.fileTypes.test(file.type))||!loadImage(file,function(img){if(img.src){data.img=img;}
dfd.resolveWith(that,[data]);},options)){return data;}
return dfd.promise();},resizeImage:function(data,options){if(options.disabled||!(data.canvas||data.img)){return data;}
options=$.extend({canvas:true},options);var that=this,dfd=$.Deferred(),img=(options.canvas&&data.canvas)||data.img,resolve=function(newImg){if(newImg&&(newImg.width!==img.width||newImg.height!==img.height||options.forceResize)){data[newImg.getContext?'canvas':'img']=newImg;}
data.preview=newImg;dfd.resolveWith(that,[data]);},thumbnail;if(data.exif){if(options.orientation===true){options.orientation=data.exif.get('Orientation');}
if(options.thumbnail){thumbnail=data.exif.get('Thumbnail');if(thumbnail){loadImage(thumbnail,resolve,options);return dfd.promise();}}}
if(img){resolve(loadImage.scale(img,options));return dfd.promise();}
return data;},saveImage:function(data,options){if(!data.canvas||options.disabled){return data;}
var that=this,file=data.files[data.index],dfd=$.Deferred();if(data.canvas.toBlob){data.canvas.toBlob(function(blob){if(!blob.name){if(file.type===blob.type){blob.name=file.name;}else if(file.name){blob.name=file.name.replace(/\..+$/,'.'+blob.type.substr(6));}}
if(file.type!==blob.type){delete data.imageHead;}
data.files[data.index]=blob;dfd.resolveWith(that,[data]);},options.type||file.type,options.quality);}else{return data;}
return dfd.promise();},loadImageMetaData:function(data,options){if(options.disabled){return data;}
var that=this,dfd=$.Deferred();loadImage.parseMetaData(data.files[data.index],function(result){$.extend(data,result);dfd.resolveWith(that,[data]);},options);return dfd.promise();},saveImageMetaData:function(data,options){if(!(data.imageHead&&data.canvas&&data.canvas.toBlob&&!options.disabled)){return data;}
var file=data.files[data.index],blob=new Blob([data.imageHead,this._blobSlice.call(file,20)],{type:file.type});blob.name=file.name;data.files[data.index]=blob;return data;},setImage:function(data,options){if(data.preview&&!options.disabled){data.files[data.index][options.name||'preview']=data.preview;}
return data;}}});}));
;;;
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','angular','./jquery.fileupload-image','./jquery.fileupload-audio','./jquery.fileupload-video','./jquery.fileupload-validate'],factory);}else{factory();}}(function(){'use strict';angular.module('blueimp.fileupload',[]).provider('fileUpload',function(){var scopeEvalAsync=function(expression){var scope=angular.element(this).fileupload('option','scope')();scope.$evalAsync(expression);},addFileMethods=function(scope,data){var files=data.files,file=files[0];angular.forEach(files,function(file,index){file._index=index;file.$state=function(){return data.state();};file.$processing=function(){return data.processing();};file.$progress=function(){return data.progress();};file.$response=function(){return data.response();};});file.$submit=function(){if(!file.error){return data.submit();}};file.$cancel=function(){return data.abort();};},$config;$config=this.defaults={handleResponse:function(e,data){var files=data.result&&data.result.files;if(files){data.scope().replace(data.files,files);}else if(data.errorThrown||data.textStatus==='error'){data.files[0].error=data.errorThrown||data.textStatus;}},add:function(e,data){if(e.isDefaultPrevented()){return false;}
var scope=data.scope(),filesCopy=[];angular.forEach(data.files,function(file){filesCopy.push(file);});scope.$apply(function(){addFileMethods(scope,data);var method=scope.option('prependFiles')?'unshift':'push';Array.prototype[method].apply(scope.queue,data.files);});data.process(function(){return scope.process(data);}).always(function(){scope.$apply(function(){addFileMethods(scope,data);scope.replace(filesCopy,data.files);});}).then(function(){if((scope.option('autoUpload')||data.autoUpload)&&data.autoUpload!==false){data.submit();}});},progress:function(e,data){if(e.isDefaultPrevented()){return false;}
data.scope().$apply();},done:function(e,data){if(e.isDefaultPrevented()){return false;}
var that=this;data.scope().$apply(function(){data.handleResponse.call(that,e,data);});},fail:function(e,data){if(e.isDefaultPrevented()){return false;}
var that=this,scope=data.scope();if(data.errorThrown==='abort'){scope.clear(data.files);return;}
scope.$apply(function(){data.handleResponse.call(that,e,data);});},stop:scopeEvalAsync,processstart:scopeEvalAsync,processstop:scopeEvalAsync,getNumberOfFiles:function(){var scope=this.scope();return scope.queue.length-scope.processing();},dataType:'json',autoUpload:false};this.$get=[function(){return{defaults:$config};}];}).provider('formatFileSizeFilter',function(){var $config={units:[{size:1000000000,suffix:' GB'},{size:1000000,suffix:' MB'},{size:1000,suffix:' KB'}]};this.defaults=$config;this.$get=function(){return function(bytes){if(!angular.isNumber(bytes)){return'';}
var unit=true,i=0,prefix,suffix;while(unit){unit=$config.units[i];prefix=unit.prefix||'';suffix=unit.suffix||'';if(i===$config.units.length-1||bytes>=unit.size){return prefix+(bytes/unit.size).toFixed(2)+suffix;}
i+=1;}};};}).controller('FileUploadController',['$scope','$element','$attrs','$window','fileUpload',function($scope,$element,$attrs,$window,fileUpload){var uploadMethods={progress:function(){return $element.fileupload('progress');},active:function(){return $element.fileupload('active');},option:function(option,data){return $element.fileupload('option',option,data);},add:function(data){return $element.fileupload('add',data);},send:function(data){return $element.fileupload('send',data);},process:function(data){return $element.fileupload('process',data);},processing:function(data){return $element.fileupload('processing',data);}};$scope.disabled=!$window.jQuery.support.fileInput;$scope.queue=$scope.queue||[];$scope.clear=function(files){var queue=this.queue,i=queue.length,file=files,length=1;if(angular.isArray(files)){file=files[0];length=files.length;}
while(i){i-=1;if(queue[i]===file){return queue.splice(i,length);}}};$scope.replace=function(oldFiles,newFiles){var queue=this.queue,file=oldFiles[0],i,j;for(i=0;i<queue.length;i+=1){if(queue[i]===file){for(j=0;j<newFiles.length;j+=1){queue[i+j]=newFiles[j];}
return;}}};$scope.applyOnQueue=function(method){var list=this.queue.slice(0),i,file;for(i=0;i<list.length;i+=1){file=list[i];if(file[method]){file[method]();}}};$scope.submit=function(){this.applyOnQueue('$submit');};$scope.cancel=function(){this.applyOnQueue('$cancel');};angular.extend($scope,uploadMethods);$element.fileupload(angular.extend({scope:function(){return $scope;}},fileUpload.defaults)).on('fileuploadadd',function(e,data){data.scope=$scope.option('scope');}).on('fileuploadfail',function(e,data){if(data.errorThrown==='abort'){return;}
if(data.dataType&&data.dataType.indexOf('json')===data.dataType.length-4){try{data.result=angular.fromJson(data.jqXHR.responseText);}catch(ignore){}}}).on(['fileuploadadd','fileuploadsubmit','fileuploadsend','fileuploaddone','fileuploadfail','fileuploadalways','fileuploadprogress','fileuploadprogressall','fileuploadstart','fileuploadstop','fileuploadchange','fileuploadpaste','fileuploaddrop','fileuploaddragover','fileuploadchunksend','fileuploadchunkdone','fileuploadchunkfail','fileuploadchunkalways','fileuploadprocessstart','fileuploadprocess','fileuploadprocessdone','fileuploadprocessfail','fileuploadprocessalways','fileuploadprocessstop'].join(' '),function(e,data){if($scope.$emit(e.type,data).defaultPrevented){e.preventDefault();}}).on('remove',function(){var method;for(method in uploadMethods){if(uploadMethods.hasOwnProperty(method)){delete $scope[method];}}});$scope.$watch($attrs.fileUpload,function(newOptions){if(newOptions){$element.fileupload('option',newOptions);}});}]).controller('FileUploadProgressController',['$scope','$attrs','$parse',function($scope,$attrs,$parse){var fn=$parse($attrs.fileUploadProgress),update=function(){var progress=fn($scope);if(!progress||!progress.total){return;}
$scope.num=Math.floor(progress.loaded/progress.total*100);};update();$scope.$watch($attrs.fileUploadProgress+'.loaded',function(newValue,oldValue){if(newValue!==oldValue){update();}});}]).controller('FileUploadPreviewController',['$scope','$element','$attrs',function($scope,$element,$attrs){$scope.$watch($attrs.fileUploadPreview+'.preview',function(preview){if(preview){$element.empty().append(preview);}});}]).directive('fileUpload',function(){return{controller:'FileUploadController',scope:true};}).directive('fileUploadProgress',function(){return{controller:'FileUploadProgressController',scope:true};}).directive('fileUploadPreview',function(){return{controller:'FileUploadPreviewController'};}).directive('download',function(){return function(scope,elm){elm.on('dragstart',function(e){try{e.originalEvent.dataTransfer.setData('DownloadURL',['application/octet-stream',elm.prop('download'),elm.prop('href')].join(':'));}catch(ignore){}});};});}));
;;;
!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(".dropdown-backdrop").remove(),e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",r),s.toggleClass("open")),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);
;;;
(function(){if(!Date.prototype.toIsoDateTimeString){Date.prototype.toIsoDateTimeString=function(str){var month=(this.getMonth()+1).toString();if(month.length===1){month="0"+month;}
var day=this.getDate().toString();if(day.length===1){day="0"+day;}
var hour=this.getHours().toString();if(hour.length===1){hour="0"+hour;}
var mins=this.getMinutes().toString();if(mins.length===1){mins="0"+mins;}
var secs=this.getSeconds().toString();if(secs.length===1){secs="0"+secs;}
return this.getFullYear()+"-"+month+"-"+day+" "+hour+":"+mins+":"+secs;};}
if(!Date.prototype.toIsoDateString){Date.prototype.toIsoDateString=function(str){var month=(this.getMonth()+1).toString();if(month.length===1){month="0"+month;}
var day=this.getDate().toString();if(day.length===1){day="0"+day;}
return this.getFullYear()+"-"+month+"-"+day;};}
if(String.CreateGuid==null){String.CreateGuid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});};}
if(!window.__debug__){window.__debug__=function(msg,category,isErr){if(((typeof console)!="undefined")&&console.log&&console.error){if(isErr)console.error(category+": "+msg);else console.log(category+": "+msg);}};}
if(!String.prototype.startsWith){String.prototype.startsWith=function(str){return this.substr(0,str.length)===str;};}
if(!String.prototype.endsWith){String.prototype.endsWith=function(str){return this.substr(this.length-str.length)===str;};}
if(!String.prototype.trimStart){String.prototype.trimStart=function(str){if(this.startsWith(str)){return this.substring(str.length);}
return this;};}
if(!String.prototype.trimEnd){String.prototype.trimEnd=function(str){if(this.endsWith(str)){return this.substring(0,this.length-str.length);}
return this;};}
if(!String.prototype.utf8Encode){String.prototype.utf8Encode=function(){var str=this.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<str.length;n++){var c=str.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;};}
if(!String.prototype.utf8Decode){String.prototype.utf8Decode=function(){var utftext=this;var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}
else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}
else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;};}
if(!String.prototype.base64Encode){String.prototype.base64Encode=function(){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;var input=this.utf8Encode();while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
keyStr.charAt(enc1)+keyStr.charAt(enc2)+
keyStr.charAt(enc3)+keyStr.charAt(enc4);}
return output;};}
if(!String.prototype.base64Decode){String.prototype.base64Decode=function(){var input=this;var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=keyStr.indexOf(input.charAt(i++));enc2=keyStr.indexOf(input.charAt(i++));enc3=keyStr.indexOf(input.charAt(i++));enc4=keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
return output.utf8Decode();};}
if(!Math.randomRange){Math.randomRange=function(from,to){return Math.floor(Math.random()*(to-from+1)+from);};}
if(!String.prototype.toCamelCase){String.prototype.toCamelCase=function(){var s=this.toPascalCase();if($.trim(s)=="")
return"";if(s.length>1){var regex=/^([A-Z]*)([A-Z].*)/g;if(s.match(regex)){var match=regex.exec(s);s=match[1].toLowerCase()+match[2];s=s.substr(0,1).toLowerCase()+s.substr(1);}}else{s=s.toLowerCase();}
return s;};}
if(!String.prototype.toPascalCase){String.prototype.toPascalCase=function(){var s="";$.each($.trim(this).split(/[\s\.-]+/g),function(idx,val){if($.trim(val)=="")
return;if(val.length>1)
s+=val.substr(0,1).toUpperCase()+val.substr(1);else
s+=val.toUpperCase();});return s;};}
if(!String.prototype.toUmbracoAlias){String.prototype.toUmbracoAlias=function(){var s=this.replace(/[^a-zA-Z0-9\s\.-]+/g,'');return s.toCamelCase();};}
if(!String.prototype.toFunction){String.prototype.toFunction=function(){var arr=this.split(".");var fn=(window||this);for(var i=0,len=arr.length;i<len;i++){fn=fn[arr[i]];}
if(typeof fn!=="function"){throw new Error("function not found");}
return fn;};}
if(!String.prototype.detectIsJson){String.prototype.detectIsJson=function(){if((this.startsWith("{")&&this.endsWith("}"))||(this.startsWith("[")||this.endsWith("]"))){return true;}
return false;};}})();
;;;
if(typeof Umbraco=='undefined')var Umbraco={};if(!Umbraco.Sys)Umbraco.Sys={};Umbraco.Sys.registerNamespace=function(namespace){namespace=namespace.split('.');if(!window[namespace[0]])window[namespace[0]]={};var strFullNamespace=namespace[0];for(var i=1;i<namespace.length;i++){strFullNamespace+="."+namespace[i];eval("if(!window."+strFullNamespace+")window."+strFullNamespace+"={};");}};
;;;
Umbraco.Sys.registerNamespace("Umbraco.Application");(function($){Umbraco.Application.ClientManager=function(){var fakeFrame={};Object.defineProperty(fakeFrame,"href",{get:function(){return this._href?this._href:"";},set:function(value){this._href=value;UmbClientMgr.contentFrame(value);},});function getRootScope(){return angular.element(document.getElementById("umbracoMainPageBody")).scope();}
function getRootInjector(){return angular.element(document.getElementById("umbracoMainPageBody")).injector();}
return{_isDirty:false,_isDebug:false,_mainTree:null,_appActions:null,_historyMgr:null,_rootPath:"/umbraco",_modal:new Array(),historyManager:function(){throw"Not implemented!";},setUmbracoPath:function(strPath){this._debug("setUmbracoPath: "+strPath);this._rootPath=strPath;},mainWindow:function(){return top;},mainTree:function(){var injector=getRootInjector();var navService=injector.get("navigationService");var appState=injector.get("appState");var angularHelper=injector.get("angularHelper");var $rootScope=injector.get("$rootScope");var tree={setActiveTreeType:function(treeType){angularHelper.safeApply($rootScope,function(){navService._setActiveTreeType(treeType);});},syncTree:function(path,forceReload){angularHelper.safeApply($rootScope,function(){navService._syncPath(path,forceReload);});},clearTreeCache:function(){var treeService=injector.get("treeService");angularHelper.safeApply($rootScope,function(){treeService.clearCache();});},reloadActionNode:function(){angularHelper.safeApply($rootScope,function(){var currentMenuNode=appState.getMenuState("currentNode");if(currentMenuNode){navService.reloadNode(currentMenuNode);}});},refreshTree:function(treeAlias){angularHelper.safeApply($rootScope,function(){navService._setActiveTreeType(treeAlias,true);});},moveNode:function(id,path){angularHelper.safeApply($rootScope,function(){var currentMenuNode=appState.getMenuState("currentNode");if(currentMenuNode){var treeService=injector.get("treeService");var treeRoot=treeService.getTreeRoot(currentMenuNode);if(treeRoot){var found=treeService.getDescendantNode(treeRoot,id);if(found){treeService.removeNode(found);}}}
navService._syncPath(path,true);});},getActionNode:function(){var currentMenuNode=appState.getMenuState("currentNode");if(!currentMenuNode){return null;}
var legacyNode={nodeId:currentMenuNode.id,nodeName:currentMenuNode.name,nodeType:currentMenuNode.nodeType,treeType:currentMenuNode.nodeType,sourceUrl:currentMenuNode.childNodesUrl,updateDefinition:function(){throw"'updateDefinition' method is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}};Object.defineProperty(legacyNode,"menu",{get:function(){throw"'menu' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});Object.defineProperty(legacyNode,"jsNode",{get:function(){throw"'jsNode' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});Object.defineProperty(legacyNode,"jsTree",{get:function(){throw"'jsTree' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});return legacyNode;}};return tree;},appActions:function(){var injector=getRootInjector();var navService=injector.get("navigationService");var localizationService=injector.get("localizationService");var userResource=injector.get("userResource");var angularHelper=injector.get("angularHelper");var $rootScope=injector.get("$rootScope");var actions={openDashboard:function(section){navService.changeSection(section);},actionDisable:function(){localizationService.localize("defaultdialogs_confirmdisable").then(function(txtConfirmDisable){var currentMenuNode=UmbClientMgr.mainTree().getActionNode();if(currentMenuNode){if(confirm(txtConfirmDisable+' "'+UmbClientMgr.mainTree().getActionNode().nodeName+'"?\n\n')){angularHelper.safeApply($rootScope,function(){userResource.disableUser(currentMenuNode.nodeId).then(function(){UmbClientMgr.mainTree().syncTree("-1,"+currentMenuNode.nodeId,true);});});}}});}};return actions;},uiKeys:function(){throw"Not implemented!";},contentFrameAndSection:function(app,rightFrameUrl){throw"Not implemented!";},contentFrame:function(strLocation){if(!strLocation||strLocation==""){if(typeof top.right!="undefined"){return top.right;}
else{return top;}}
this._debug("contentFrame: "+strLocation);var injector=getRootInjector();var rootScope=injector.get("$rootScope");var angularHelper=injector.get("angularHelper");var navService=injector.get("navigationService");var locationService=injector.get("$location");var self=this;angularHelper.safeApply(rootScope,function(){if(strLocation.startsWith("#")){locationService.path(strLocation.trimStart("#")).search("");}
else{if(!strLocation.startsWith("/")){strLocation=self._rootPath+"/"+strLocation;}
else if(strLocation.length>=self._rootPath.length&&strLocation.substr(0,self._rootPath.length)!=self._rootPath){strLocation=self._rootPath+"/"+strLocation;}
navService.loadLegacyIFrame(strLocation);}});},getFakeFrame:function(){return fakeFrame;},openAngularModalWindow:function(options){var injector=getRootInjector();var dialogService=injector.get("dialogService");var dialog=dialogService.open(options);},openModalWindow:function(url,name,showHeader,width,height,top,leftOffset,closeTriggers,onCloseCallback){var injector=getRootInjector();var navService=injector.get("navigationService");var dialogService=injector.get("dialogService");var self=this;var appState=injector.get("appState");var navMode=appState.getGlobalState("navMode");var dialog;if(navMode==="menu"){dialog=navService.showDialog({action:{name:name,metaData:{actionUrl:url}},node:{}});}
else{dialog=dialogService.open({template:url,width:width,height:height,iframe:true,show:true});}
dialog.element.data("modalCb",onCloseCallback);if(angular.isArray(closeTriggers)){for(var i=0;i<closeTriggers.length;i++){var e=dialog.find(closeTriggers[i]);if(e.length>0){e.click(function(){self.closeModalWindow();});}}}
this._modal.push(dialog);return dialog;},rootScope:function(){return getRootScope();},closeModalWindow:function(rVal){var injector=getRootInjector();var dialogService=injector.get("dialogService");if(this._modal!=null&&this._modal.length>0){var lastModal=this._modal.pop();var self=this;var onCloseCallback=lastModal.element.data("modalCb");if(typeof onCloseCallback=="function"){onCloseCallback.apply(self,[{outVal:rVal}]);}
lastModal.close();}
else{getRootScope().$emit("app.closeDialogs",undefined);}},_packageInstalled:function(){var injector=getRootInjector();var packageHelper=injector.get("packageHelper");packageHelper.packageInstalled();},_debug:function(strMsg){if(this._isDebug){Sys.Debug.trace("UmbClientMgr: "+strMsg);}},get_isDirty:function(){return this._isDirty;},set_isDirty:function(value){this._isDirty=value;}};};})(jQuery);var UmbClientMgr=new Umbraco.Application.ClientManager();
;;;
Umbraco.Sys.registerNamespace("Umbraco.Application");(function($){Umbraco.Application.SpeechBubble=function(){function getRootScope(){return angular.element(document.getElementById("umbracoMainPageBody")).scope();}
function getRootInjector(){return angular.element(document.getElementById("umbracoMainPageBody")).injector();}
return{ShowMessage:function(icon,header,message){var injector=getRootInjector();var notifyService=injector.get("notificationsService");switch(icon){case"save":notifyService.success(header,message);break;case"success":notifyService.success(header,message);break;case"warning":notifyService.warning(header,message);break;case"error":notifyService.error(header,message);break;default:notifyService.info(header,message);}}};};})(jQuery);var UmbSpeechBubble=new Umbraco.Application.SpeechBubble();
;;;
var app=angular.module('umbraco',['umbraco.filters','umbraco.directives','umbraco.resources','umbraco.services','umbraco.packages','ngCookies','ngSanitize','ngMobile','blueimp.fileupload','tmh.dynamicLocale']);var packages=angular.module("umbraco.packages",[]);
;;;
(function(){angular.module("umbraco.resources",[]);function authResource($q,$http,umbRequestHelper,angularHelper){return{performLogin:function(username,password){if(!username||!password){return angularHelper.rejectedPromise({errorMsg:'Username or password cannot be empty'});}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","PostLogin"),{username:username,password:password}),'Login failed for user '+username);},performLogout:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","PostLogout")));},getCurrentUser:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","GetCurrentUser")),'Server call failed for getting current user');},isAuthenticated:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","IsAuthenticated")),{success:function(data,status,headers,config){if(data===false||data==="false"){return $q.reject('User is not logged in');}
return data;},error:function(data,status,headers,config){return{errorMsg:'Server call failed for checking authentication',data:data,status:status};}});},getRemainingTimeoutSeconds:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","GetRemainingTimeoutSeconds")),'Server call failed for checking remaining seconds');}};}
angular.module('umbraco.resources').factory('authResource',authResource);function contentResource($q,$http,umbDataFormatter,umbRequestHelper){function saveContentItem(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("contentApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatContentPostData(c,a);}});}
return{sort:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.sortedIds){throw"args.sortedIds cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostSort"),{parentId:args.parentId,idSortOrder:args.sortedIds}),'Failed to sort content');},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move content');},copy:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostCopy"),args),'Failed to copy content');},unPublish:function(id){if(!id){throw"id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostUnPublish",[{id:id}])),'Failed to publish content with id '+id);},emptyRecycleBin:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","EmptyRecycleBin")),'Failed to empty the recycle bin');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve data for content id '+id);},getByIds:function(ids){var idQuery="";_.each(ids,function(item){idQuery+="ids="+item+"&";});return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetByIds",idQuery)),'Failed to retrieve data for content with multiple ids');},getScaffold:function(parentId,alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetEmpty",[{contentTypeAlias:alias},{parentId:parentId}])),'Failed to retrieve data for empty content item type '+alias);},getNiceUrl:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetNiceUrl",[{id:id}])),'Failed to retrieve url for id:'+id);},getChildren:function(parentId,options){var defaults={pageSize:0,pageNumber:0,filter:'',orderDirection:"Ascending",orderBy:"SortOrder"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetChildren",[{id:parentId},{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}])),'Failed to retrieve children for content item '+parentId);},checkPermission:function(permission,id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetHasPermission",[{permissionToCheck:permission},{nodeId:id}])),'Failed to check permission for item '+id);},save:function(content,isNew,files){return saveContentItem(content,"save"+(isNew?"New":""),files);},publish:function(content,isNew,files){return saveContentItem(content,"publish"+(isNew?"New":""),files);},sendToPublish:function(content,isNew,files){return saveContentItem(content,"sendPublish"+(isNew?"New":""),files);},publishById:function(id){if(!id){throw"id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostPublishById",[{id:id}])),'Failed to publish content with id '+id);}};}
angular.module('umbraco.resources').factory('contentResource',contentResource);function contentTypeResource($q,$http,umbRequestHelper){return{getAssignedListViewDataType:function(contentTypeId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAssignedListViewDataType",[{contentTypeId:contentTypeId}])),'Failed to retrieve data for content id '+contentTypeId);},getAllowedTypes:function(contentId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAllowedChildren",[{contentId:contentId}])),'Failed to retrieve data for content id '+contentId);},getAllPropertyTypeAliases:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAllPropertyTypeAliases")),'Failed to retrieve property type aliases');}};}
angular.module('umbraco.resources').factory('contentTypeResource',contentTypeResource);function currentUserResource($q,$http,umbRequestHelper){return{changePassword:function(changePasswordArgs){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("currentUserApiBaseUrl","PostChangePassword"),changePasswordArgs),'Failed to change password');},getMembershipProviderConfig:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("currentUserApiBaseUrl","GetMembershipProviderConfig")),'Failed to retrieve membership provider config');},};}
angular.module('umbraco.resources').factory('currentUserResource',currentUserResource);function dashboardResource($q,$http,umbRequestHelper){return{getDashboard:function(section){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dashboardApiBaseUrl","GetDashboard",[{section:section}])),'Failed to get dashboard '+section);}};}
angular.module('umbraco.resources').factory('dashboardResource',dashboardResource);function dataTypeResource($q,$http,umbDataFormatter,umbRequestHelper){return{getPreValues:function(editorAlias,dataTypeId){if(!dataTypeId){dataTypeId=-1;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetPreValues",[{editorAlias:editorAlias},{dataTypeId:dataTypeId}])),'Failed to retrieve pre values for editor alias '+editorAlias);},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve data for data type id '+id);},getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetAll")),'Failed to retrieve data');},getScaffold:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetEmpty")),'Failed to retrieve data for empty datatype');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);},save:function(dataType,preValues,isNew){var saveModel=umbDataFormatter.formatDataTypePostData(dataType,preValues,"save"+(isNew?"New":""));return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","PostSave"),saveModel),'Failed to save data for data type id '+dataType.id);}};}
angular.module('umbraco.resources').factory('dataTypeResource',dataTypeResource);function entityResource($q,$http,umbRequestHelper){return{getPath:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetPath",[{id:id},{type:type}])),'Failed to retrieve path for id:'+id);},getById:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetById",[{id:id},{type:type}])),'Failed to retrieve entity data for id '+id);},getByQuery:function(query,nodeContextId,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetByQuery",[{query:query},{nodeContextId:nodeContextId},{type:type}])),'Failed to retrieve entity data for query '+query);},getByIds:function(ids,type){var query="";_.each(ids,function(item){query+="ids="+item+"&";});query+="type="+type;return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetByIds",query)),'Failed to retrieve entity data for ids '+ids);},getAll:function(type,postFilter,postFilterParams){var query="type="+type+"&postFilter="+(postFilter?postFilter:"");if(postFilter&&postFilterParams){var counter=0;_.each(postFilterParams,function(val,key){query+="&postFilterParams["+counter+"].key="+key+"&postFilterParams["+counter+"].value="+val;counter++;});}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetAll",query)),'Failed to retrieve entity data for type '+type);},getAncestors:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetAncestors",[{id:id},{type:type}])),'Failed to retrieve ancestor data for id '+id);},getChildren:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetChildren",[{id:id},{type:type}])),'Failed to retrieve child data for id '+id);},search:function(query,type,searchFrom,canceler){var args=[{query:query},{type:type}];if(searchFrom){args.push({searchFrom:searchFrom});}
var httpConfig={};if(canceler){httpConfig["timeout"]=canceler;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","Search",args),httpConfig),'Failed to retrieve entity data for query '+query);},searchAll:function(query,canceler){var httpConfig={};if(canceler){httpConfig["timeout"]=canceler;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","SearchAll",[{query:query}]),httpConfig),'Failed to retrieve entity data for query '+query);}};}
angular.module('umbraco.resources').factory('entityResource',entityResource);function legacyResource($q,$http,umbRequestHelper){return{deleteItem:function(args){if(!args.nodeId||!args.nodeType||!args.alias){throw"The args parameter is not formatted correct, it requires properties: nodeId, nodeType, alias";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("legacyApiBaseUrl","DeleteLegacyItem",[{nodeId:args.nodeId},{nodeType:args.nodeType},{alias:args.alias}])),'Failed to delete item '+args.nodeId);}};}
angular.module('umbraco.resources').factory('legacyResource',legacyResource);function logResource($q,$http,umbRequestHelper){return{getEntityLog:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetEntityLog",[{id:id}])),'Failed to retrieve user data for id '+id);},getUserLog:function(type,since){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetCurrentUserLog",[{logtype:type,sinceDate:since}])),'Failed to retrieve user data for id '+id);},getLog:function(type,since){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetLog",[{logtype:type,sinceDate:since}])),'Failed to retrieve user data for id '+id);}};}
angular.module('umbraco.resources').factory('logResource',logResource);function macroResource($q,$http,umbRequestHelper){return{getMacroParameters:function(macroId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("macroApiBaseUrl","GetMacroParameters",[{macroId:macroId}])),'Failed to retrieve macro parameters for macro with id  '+macroId);},getMacroResultAsHtmlForEditor:function(macroAlias,pageId,macroParamDictionary){var query="macroAlias="+macroAlias+"&pageId="+pageId;if(macroParamDictionary){var counter=0;_.each(macroParamDictionary,function(val,key){val=val?val:"";if(!angular.isString(val)){var json=angular.toJson(val);val=encodeURIComponent(json);}
else{val=encodeURIComponent(val);}
query+="&macroParams["+counter+"].key="+key+"&macroParams["+counter+"].value="+val;counter++;});}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("macroApiBaseUrl","GetMacroResultAsHtmlForEditor",query)),'Failed to retrieve macro result for macro with alias  '+macroAlias);}};}
angular.module('umbraco.resources').factory('macroResource',macroResource);function mediaResource($q,$http,umbDataFormatter,umbRequestHelper){function saveMediaItem(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatMediaPostData(c,a);}});}
return{sort:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.sortedIds){throw"args.sortedIds cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostSort"),{parentId:args.parentId,idSortOrder:args.sortedIds}),'Failed to sort media');},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move media');},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve data for media id '+id);},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);},getByIds:function(ids){var idQuery="";_.each(ids,function(item){idQuery+="ids="+item+"&";});return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetByIds",idQuery)),'Failed to retrieve data for media ids '+ids);},getScaffold:function(parentId,alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetEmpty",[{contentTypeAlias:alias},{parentId:parentId}])),'Failed to retrieve data for empty media item type '+alias);},rootMedia:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetRootMedia")),'Failed to retrieve data for root media');},getChildren:function(parentId,options){var defaults={pageSize:0,pageNumber:0,filter:'',orderDirection:"Ascending",orderBy:"SortOrder"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetChildren",[{id:parentId},{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}])),'Failed to retrieve children for media item '+parentId);},save:function(media,isNew,files){return saveMediaItem(media,"save"+(isNew?"New":""),files);},addFolder:function(name,parentId){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostAddFolder"),{name:name,parentId:parentId}),'Failed to add folder');},emptyRecycleBin:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","EmptyRecycleBin")),'Failed to empty the recycle bin');}};}
angular.module('umbraco.resources').factory('mediaResource',mediaResource);function mediaTypeResource($q,$http,umbRequestHelper){return{getAllowedTypes:function(mediaId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetAllowedChildren",[{contentId:mediaId}])),'Failed to retrieve allowed types for media id '+mediaId);}};}
angular.module('umbraco.resources').factory('mediaTypeResource',mediaTypeResource);function memberResource($q,$http,umbDataFormatter,umbRequestHelper){function saveMember(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("memberApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatMemberPostData(c,a);}});}
return{getPagedResults:function(memberTypeAlias,options){if(memberTypeAlias==='all-members'){memberTypeAlias=null;}
var defaults={pageSize:25,pageNumber:1,filter:'',orderDirection:"Ascending",orderBy:"LoginName"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
var params=[{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}];if(memberTypeAlias!=null){params.push({memberTypeAlias:memberTypeAlias});}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetPagedResults",params)),'Failed to retrieve member paged result');},getListNode:function(listName){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetListNodeDisplay",[{listName:listName}])),'Failed to retrieve data for member list '+listName);},getByKey:function(key){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetByKey",[{key:key}])),'Failed to retrieve data for member id '+key);},deleteByKey:function(key){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("memberApiBaseUrl","DeleteByKey",[{key:key}])),'Failed to delete item '+key);},getScaffold:function(alias){if(alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetEmpty",[{contentTypeAlias:alias}])),'Failed to retrieve data for empty member item type '+alias);}
else{return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetEmpty")),'Failed to retrieve data for empty member item type '+alias);}},save:function(member,isNew,files){return saveMember(member,"save"+(isNew?"New":""),files);}};}
angular.module('umbraco.resources').factory('memberResource',memberResource);function memberTypeResource($q,$http,umbRequestHelper){return{getTypes:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","GetAllTypes")),'Failed to retrieve data for member types id');}};}
angular.module('umbraco.resources').factory('memberTypeResource',memberTypeResource);function packageResource($q,$http,umbDataFormatter,umbRequestHelper){return{fetch:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","Fetch",[{packageGuid:id}])),'Failed to download package with guid '+id);},import:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","Import"),package),'Failed to create package manifest for zip file ');},installFiles:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","InstallFiles"),package),'Failed to create package manifest for zip file ');},installData:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","InstallData"),package),'Failed to create package manifest for zip file ');},cleanUp:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","CleanUp"),package),'Failed to create package manifest for zip file ');}};}
angular.module('umbraco.resources').factory('packageResource',packageResource);function sectionResource($q,$http,umbRequestHelper){function getSectionsUrl(section){return Umbraco.Sys.ServerVariables.sectionApiBaseUrl+"GetSections";}
return{getSections:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("sectionApiBaseUrl","GetSections")),'Failed to retrieve data for sections');}};}
angular.module('umbraco.resources').factory('sectionResource',sectionResource);function stylesheetResource($q,$http,umbRequestHelper){return{getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("stylesheetApiBaseUrl","GetAll")),'Failed to retrieve stylesheets ');},getRules:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("stylesheetApiBaseUrl","GetRules",[{id:id}])),'Failed to retrieve stylesheets ');},getRulesByName:function(name){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("stylesheetApiBaseUrl","GetRulesByName",[{name:name}])),'Failed to retrieve stylesheets ');}};}
angular.module('umbraco.resources').factory('stylesheetResource',stylesheetResource);function treeResource($q,$http,umbRequestHelper){function getTreeNodesUrl(node){if(!node.childNodesUrl){throw"No childNodesUrl property found on the tree node, cannot load child nodes";}
return node.childNodesUrl;}
function getTreeMenuUrl(node){if(!node.menuUrl){throw"No menuUrl property found on the tree node, cannot load menu";}
return node.menuUrl;}
return{loadMenu:function(node){return umbRequestHelper.resourcePromise($http.get(getTreeMenuUrl(node)),"Failed to retrieve data for a node's menu "+node.id);},loadApplication:function(options){if(!options||!options.section){throw"The object specified for does not contain a 'section' property";}
if(!options.tree){options.tree="";}
if(!options.isDialog){options.isDialog=false;}
var query="application="+options.section+"&tree="+options.tree+"&isDialog="+options.isDialog;if(options.queryString){query+="&"+options.queryString;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("treeApplicationApiBaseUrl","GetApplicationTrees",query)),'Failed to retrieve data for application tree '+options.section);},loadNodes:function(options){if(!options||!options.node){throw"The options parameter object does not contain the required properties: 'node'";}
return umbRequestHelper.resourcePromise($http.get(getTreeNodesUrl(options.node)),'Failed to retrieve data for child nodes '+options.node.nodeId);}};}
angular.module('umbraco.resources').factory('treeResource',treeResource);function userResource($q,$http,umbDataFormatter,umbRequestHelper){return{disableUser:function(userId){if(!userId){throw"userId not specified";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("userApiBaseUrl","PostDisableUser",[{userId:userId}])),'Failed to disable the user '+userId);}};}
angular.module('umbraco.resources').factory('userResource',userResource);})();
;;;
(function(){angular.module("umbraco.directives",["umbraco.directives.editors","umbraco.directives.html","umbraco.directives.validation","ui.sortable"]);angular.module("umbraco.directives.editors",[]);angular.module("umbraco.directives.html",[]);angular.module("umbraco.directives.validation",[]);angular.module("umbraco.directives").directive('buttonGroup',function(contentEditingHelper){return{scope:{actions:"=",handler:"="},transclude:true,restrict:'E',replace:true,templateUrl:'views/directives/button-group.html',link:function(scope,element,attrs,ctrl){scope.buttons=[];scope.handle=function(action){if(scope.handler){}};function processActions(){var buttons=[];angular.forEach(scope.actions,function(action){if(angular.isObject(action)){buttons.push(action);}else{var btn=contentEditingHelper.getButtonFromAction(action);if(btn){buttons.push(btn);}}});scope.defaultButton=buttons.pop(0);scope.buttons=buttons;}
scope.$watchCollection(scope.actions,function(){processActions();});}};});angular.module("umbraco.directives").directive('umbAutoFocus',function($timeout){return function(scope,element,attr){var update=function(){if(element.val()===""){element.focus();}};$timeout(function(){update();});};});angular.module("umbraco.directives").directive('umbAutoResize',function($timeout){return function(scope,element,attr){var domEl=element[0];var update=function(force){if(force===true){element.height(0);}
if(domEl.scrollHeight!==domEl.clientHeight){element.height(domEl.scrollHeight);}};element.bind('keyup keydown keypress change',update);element.bind('blur',function(){update(true);});$timeout(function(){update(true);},200);$('a[data-toggle="tab"]').on('shown',update);scope.$on('$destroy',function(){$('a[data-toggle="tab"]').unbind("shown",update);});};});angular.module("umbraco.directives").directive('umbRawModel',function(){return{restrict:'A',require:'ngModel',template:'<textarea ng-model="jsonEditing"></textarea>',replace:true,scope:{model:'=umbRawModel',validateOn:'='},link:function(scope,element,attrs,ngModelCtrl){function setEditing(value){scope.jsonEditing=angular.copy(jsonToString(value));}
function updateModel(value){scope.model=stringToJson(value);}
function setValid(){ngModelCtrl.$setValidity('json',true);}
function setInvalid(){ngModelCtrl.$setValidity('json',false);}
function stringToJson(text){try{return angular.fromJson(text);}catch(err){setInvalid();return text;}}
function jsonToString(object){return angular.toJson(object,true);}
function isValidJson(model){var flag=true;try{angular.fromJson(model);}catch(err){flag=false;}
return flag;}
setEditing(scope.model);var onInputChange=function(newval,oldval){if(newval!==oldval){if(isValidJson(newval)){setValid();updateModel(newval);}else{setInvalid();}}};if(scope.validateOn){element.on(scope.validateOn,function(){scope.$apply(function(){onInputChange(scope.jsonEditing);});});}else{scope.$watch('jsonEditing',onInputChange,true);}
scope.$watch('model',function(newval,oldval){if(newval!==oldval){setEditing(newval);}},true);}};});angular.module("umbraco.directives").directive('umbContentName',function($timeout,localizationService){return{require:"ngModel",restrict:'E',replace:true,templateUrl:'views/directives/umb-content-name.html',scope:{placeholder:'@placeholder',model:'=ngModel',ngDisabled:'='},link:function(scope,element,attrs,ngModel){var inputElement=element.find("input");if(scope.placeholder&&scope.placeholder[0]==="@"){localizationService.localize(scope.placeholder.substring(1)).then(function(value){scope.placeholder=value;});}
var mX,mY,distance;function calculateDistance(elem,mouseX,mouseY){var cx=Math.max(Math.min(mouseX,elem.offset().left+elem.width()),elem.offset().left);var cy=Math.max(Math.min(mouseY,elem.offset().top+elem.height()),elem.offset().top);return Math.sqrt((mouseX-cx)*(mouseX-cx)+(mouseY-cy)*(mouseY-cy));}
var mouseMoveDebounce=_.throttle(function(e){mX=e.pageX;mY=e.pageY;if(!inputElement.is(":focus")&&!inputElement.hasClass("ng-invalid")){if(mX>=inputElement.offset().left){distance=calculateDistance(inputElement,mX,mY);if(distance<=155){distance=1-(100/150*distance/100);inputElement.css("border","1px solid rgba(175,175,175, "+distance+")");inputElement.css("background-color","rgba(255,255,255, "+distance+")");}}}},15);$(document).bind("mousemove",mouseMoveDebounce);$timeout(function(){if(!scope.model){scope.goEdit();}},100,false);scope.goEdit=function(){scope.editMode=true;$timeout(function(){inputElement.focus();},100,false);};scope.exitEdit=function(){if(scope.model&&scope.model!==""){scope.editMode=false;}};scope.$on('$destroy',function(){$(document).unbind("mousemove",mouseMoveDebounce);});}};});angular.module("umbraco.directives").directive('umbLaunchMiniEditor',function(dialogService,editorState,fileManager,contentEditingHelper){return{restrict:'A',replace:false,scope:{node:'=umbLaunchMiniEditor',},link:function(scope,element,attrs){var launched=false;element.click(function(){if(launched===true){return;}
launched=true;var currFiles=_.groupBy(fileManager.getFiles(),"alias");fileManager.clearFiles();var currEditorState=editorState.getCurrent();dialogService.open({template:"views/common/dialogs/content/edit.html",id:scope.node.id,closeOnSave:true,tabFilter:["Generic properties"],callback:function(data){scope.node.name=data.name;fileManager.clearFiles();_.each(currFiles,function(val,key){fileManager.setFiles(key,_.map(currFiles['upload'],function(i){return i.file;}));});editorState.set(currEditorState);if(data.id===currEditorState.id){var changed=contentEditingHelper.reBindChangedProperties(currEditorState,data);}
launched=false;},closeCallback:function(){fileManager.clearFiles();_.each(currFiles,function(val,key){fileManager.setFiles(key,_.map(currFiles['upload'],function(i){return i.file;}));});editorState.set(currEditorState);launched=false;}});});}};});function umbSingleFileUpload($compile){return{restrict:"E",scope:{rebuild:"="},replace:true,template:"<div><input type='file' umb-file-upload /></div>",link:function(scope,el,attrs){scope.$watch("rebuild",function(newVal,oldVal){if(newVal&&newVal!==oldVal){el.html("<input type='file' umb-file-upload />");$compile(el.contents())(scope);}});}};}
angular.module('umbraco.directives').directive("umbSingleFileUpload",umbSingleFileUpload);angular.module("umbraco.directives").value('umbSortContextInternal',{}).directive('umbSort',function($log,umbSortContextInternal){return{require:'?ngModel',link:function(scope,element,attrs,ngModel){var adjustment;var cfg=scope.$eval(element.attr('umb-sort'))||{};scope.model=ngModel;scope.opts=cfg;scope.opts.containerSelector=cfg.containerSelector||".umb-"+cfg.group+"-container",scope.opts.nested=cfg.nested||true,scope.opts.drop=cfg.drop||true,scope.opts.drag=cfg.drag||true,scope.opts.clone=cfg.clone||"<li/>";scope.opts.mode=cfg.mode||"list";scope.opts.itemSelectorFull=$.trim(scope.opts.itemPath+" "+scope.opts.itemSelector);element.addClass("umb-sort");element.addClass("umb-"+cfg.group+"-container");scope.opts.onDrag=function(item,position){if(scope.opts.mode==="list"){item.css({left:position.left-adjustment.left,top:position.top-adjustment.top});}};scope.opts.onDrop=function(item,targetContainer,_super){if(scope.opts.mode==="list"){var clonedItem=$(scope.opts.clone).css({height:0});item.after(clonedItem);clonedItem.animate({'height':item.height()});item.animate(clonedItem.position(),function(){clonedItem.detach();_super(item);});}
var children=$(scope.opts.itemSelectorFull,targetContainer.el);var targetIndex=children.index(item);var targetScope=$(targetContainer.el[0]).scope();if(targetScope===umbSortContextInternal.sourceScope){if(umbSortContextInternal.sourceScope.opts.onSortHandler){var _largs={oldIndex:umbSortContextInternal.sourceIndex,newIndex:targetIndex,scope:umbSortContextInternal.sourceScope};umbSortContextInternal.sourceScope.opts.onSortHandler.call(this,item,_largs);}}else{if(targetScope.opts.onDropHandler){var args={sourceScope:umbSortContextInternal.sourceScope,sourceIndex:umbSortContextInternal.sourceIndex,sourceContainer:umbSortContextInternal.sourceContainer,targetScope:targetScope,targetIndex:targetIndex,targetContainer:targetContainer};targetScope.opts.onDropHandler.call(this,item,args);}
if(umbSortContextInternal.sourceScope.opts.onReleaseHandler){var _args={sourceScope:umbSortContextInternal.sourceScope,sourceIndex:umbSortContextInternal.sourceIndex,sourceContainer:umbSortContextInternal.sourceContainer,targetScope:targetScope,targetIndex:targetIndex,targetContainer:targetContainer};umbSortContextInternal.sourceScope.opts.onReleaseHandler.call(this,item,_args);}}};scope.changeIndex=function(from,to){scope.$apply(function(){var i=ngModel.$modelValue.splice(from,1)[0];ngModel.$modelValue.splice(to,0,i);});};scope.move=function(args){var from=args.sourceIndex;var to=args.targetIndex;if(args.sourceContainer===args.targetContainer){scope.changeIndex(from,to);}else{scope.$apply(function(){var i=args.sourceScope.model.$modelValue.splice(from,1)[0];args.targetScope.model.$modelvalue.splice(to,0,i);});}};scope.opts.onDragStart=function(item,container,_super){var children=$(scope.opts.itemSelectorFull,container.el);var offset=item.offset();umbSortContextInternal.sourceIndex=children.index(item);umbSortContextInternal.sourceScope=$(container.el[0]).scope();umbSortContextInternal.sourceContainer=container;var pointer=container.rootGroup.pointer;adjustment={left:pointer.left-offset.left,top:pointer.top-offset.top};_super(item,container);};element.sortable(scope.opts);}};});angular.module("umbraco.directives").directive('gridRte',function(tinyMceService,stylesheetResource,angularHelper,assetsService,$q,$timeout){return{scope:{uniqueId:'=',value:'=',onClick:'&',onFocus:'&',onBlur:'&',configuration:"="},template:"<textarea ng-model=\"value\" rows=\"10\" class=\"mceNoEditor\" style=\"overflow:hidden\" id=\"{{uniqueId}}\"></textarea>",replace:true,link:function(scope,element,attrs){var initTiny=function(){tinyMceService.configuration().then(function(tinyMceConfig){var validElements=tinyMceConfig.validElements;var fallbackStyles=[{title:"Page header",block:"h2"},{title:"Section header",block:"h3"},{title:"Paragraph header",block:"h4"},{title:"Normal",block:"p"},{title:"Quote",block:"blockquote"},{title:"Code",block:"code"}];var extendedValidElements="@[id|class|style],-div[id|dir|class|align|style],ins[datetime|cite],-ul[class|style],-li[class|style],-h1[id|dir|class|align|style],-h2[id|dir|class|align|style],-h3[id|dir|class|align|style],-h4[id|dir|class|align|style],-h5[id|dir|class|align|style],-h6[id|style|dir|class|align]";var invalidElements=tinyMceConfig.inValidElements;var plugins=_.map(tinyMceConfig.plugins,function(plugin){if(plugin.useOnFrontend){return plugin.name;}}).join(" ")+" autoresize";var toolbar=["code","styleselect","bold","italic","alignleft","aligncenter","alignright","bullist","numlist","link","umbmediapicker","umbembeddialog"].join(" | ");var stylesheets=[];var styleFormats=[];var await=[];if(typeof(tinymce)==="undefined"){await.push(assetsService.loadJs("lib/tinymce/tinymce.min.js",scope));}
if(scope.configuration&&scope.configuration.toolbar){toolbar=scope.configuration.toolbar.join(' | ');}
if(scope.configuration&&scope.configuration.stylesheets){angular.forEach(scope.configuration.stylesheets,function(stylesheet,key){stylesheets.push("/css/"+stylesheet+".css");await.push(stylesheetResource.getRulesByName(stylesheet).then(function(rules){angular.forEach(rules,function(rule){var r={};r.title=rule.name;if(rule.selector[0]==="."){r.inline="span";r.classes=rule.selector.substring(1);}else if(rule.selector[0]==="#"){r.inline="span";r.attributes={id:rule.selector.substring(1)};}else{r.block=rule.selector;}
styleFormats.push(r);});}));});}else{stylesheets.push("views/propertyeditors/grid/config/grid.default.rtestyles.css");styleFormats=fallbackStyles;}
var tinyMceEditor=null;$q.all(await).then(function(){var uniqueId=scope.uniqueId;var baseLineConfigObj={mode:"exact",skin:"umbraco",plugins:plugins,valid_elements:validElements,invalid_elements:invalidElements,extended_valid_elements:extendedValidElements,menubar:false,statusbar:false,relative_urls:false,toolbar:toolbar,content_css:stylesheets.join(','),style_formats:styleFormats};if(tinyMceConfig.customConfig){angular.extend(baseLineConfigObj,tinyMceConfig.customConfig);}
baseLineConfigObj.elements=uniqueId;baseLineConfigObj.setup=function(editor){tinyMceEditor=editor;editor.on('init',function(e){editor.getBody().setAttribute('spellcheck',true);$(editor.editorContainer).find(".mce-toolbar").css("visibility","hidden");editor.getBody().style.overflow="hidden";$timeout(function(){if(scope.value===null){editor.focus();}},400);});var pinToolbar=function(){var _toolbar=$(editor.editorContainer).find(".mce-toolbar");var toolbarHeight=_toolbar.height();var _tinyMce=$(editor.editorContainer);var tinyMceRect=_tinyMce[0].getBoundingClientRect();var tinyMceTop=tinyMceRect.top;var tinyMceBottom=tinyMceRect.bottom;if(tinyMceTop<100&&(tinyMceBottom>(100+toolbarHeight))){_toolbar.css("visibility","visible").css("position","fixed").css("top","100px").css("margin-top","0");}else{_toolbar.css("visibility","visible").css("position","absolute").css("top","auto").css("margin-top",(-toolbarHeight-2)+"px");}};editor.on('blur',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();var _toolbar=$(editor.editorContainer).find(".mce-toolbar");if(scope.onBlur){scope.onBlur();}
_toolbar.css("visibility","hidden");$('.umb-panel-body').off('scroll',pinToolbar);});});editor.on('focus',function(e){angularHelper.safeApply(scope,function(){if(scope.onFocus){scope.onFocus();}
pinToolbar();$('.umb-panel-body').on('scroll',pinToolbar);});});editor.on('click',function(e){angularHelper.safeApply(scope,function(){if(scope.onClick){scope.onClick();}
pinToolbar();$('.umb-panel-body').on('scroll',pinToolbar);});});editor.on('ExecCommand',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});});editor.on('KeyUp',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});});editor.on('SetContent',function(e){if(!e.initial){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});}});editor.on('ObjectResized',function(e){var qs="?width="+e.width+"px&height="+e.height+"px";var srcAttr=$(e.target).attr("src");var path=srcAttr.split("?")[0];$(e.target).attr("data-mce-src",path+qs);});tinyMceService.createMediaPicker(editor,scope);tinyMceService.createInsertEmbeddedMedia(editor,scope);tinyMceService.createInsertMacro(editor,scope);};function loadTinyMce(){$timeout(function(){tinymce.DOM.events.domLoaded=true;tinymce.init(baseLineConfigObj);},150,false);}
loadTinyMce();var unsubscribe=scope.$on("formSubmitting",function(){scope.value=tinyMceEditor.getContent();});scope.$on('$destroy',function(){unsubscribe();});});});};initTiny();}};});function hexBgColor(){return{restrict:"A",link:function(scope,element,attr,formCtrl){var origColor=null;if(attr.hexBgOrig){origColor=attr.hexBgOrig;}
attr.$observe("hexBgColor",function(newVal){if(newVal){if(!origColor){origColor=element.css("border-color");}
if(/^([0-9a-f]{3}|[0-9a-f]{6})$/i.test(newVal)){element.css("background-color","#"+newVal);return;}
if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(newVal)){element.css("background-color",newVal);return;}}
element.css("background-color",origColor);});}};}
angular.module('umbraco.directives').directive("hexBgColor",hexBgColor);angular.module("umbraco.directives").directive('sectionIcon',function($compile,iconHelper){return{restrict:'E',replace:true,link:function(scope,element,attrs){var icon=attrs.icon;if(iconHelper.isLegacyIcon(icon)){element.html("<i class='"+iconHelper.convertFromLegacyIcon(icon)+"'></i>");}
else if(iconHelper.isFileBasedIcon(icon)){var convert=iconHelper.convertFromLegacyImage(icon);if(convert){element.html("<i class='icon-section "+convert+"'></i>");}else{element.html("<img src='images/tray/"+icon+"'>");}}
else{element.html("<i class='icon-section "+icon+"'></i>");}}};});function avatarDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-avatar.html',scope:{name:'@',email:'@',hash:'@'},link:function(scope,element,attr,ctrl){scope.$watch("hash",function(val){scope.gravatar="//www.gravatar.com/avatar/"+val+"?s=40";});}};}
angular.module('umbraco.directives').directive("umbAvatar",avatarDirective);angular.module("umbraco.directives.html").directive('umbControlGroup',function(localizationService){return{scope:{label:"@label",description:"@",hideLabel:"@",alias:"@"},require:'?^form',transclude:true,restrict:'E',replace:true,templateUrl:'views/directives/html/umb-control-group.html',link:function(scope,element,attr,formCtrl){scope.formValid=function(){if(formCtrl){return formCtrl.$valid;}
return true;};if(scope.label&&scope.label[0]==="@"){scope.labelstring=localizationService.localize(scope.label.substring(1));}
else{scope.labelstring=scope.label;}
if(scope.description&&scope.description[0]==="@"){scope.descriptionstring=localizationService.localize(scope.description.substring(1));}
else{scope.descriptionstring=scope.description;}}};});angular.module("umbraco.directives").directive('umbHeader',function($parse,$timeout){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/umb-header.html',scope:{tabs:"="},link:function(scope,iElement,iAttrs){var maxTabs=4;function collectFromDom(activeTab){var $panes=$('div.tab-content');angular.forEach($panes.find('.tab-pane'),function(pane,index){var $this=angular.element(pane);var id=$this.attr("rel");var label=$this.attr("label");var tab={id:id,label:label,active:false};if(!activeTab){tab.active=true;activeTab=tab;}
if($this.attr("rel")===String(activeTab.id)){$this.addClass('active');}
else{$this.removeClass('active');}
if(label){scope.visibleTabs.push(tab);}});}
scope.showTabs=iAttrs.tabs?true:false;scope.visibleTabs=[];scope.overflownTabs=[];$timeout(function(){collectFromDom(undefined);},500);scope.$watch("tabs",function(newValue,oldValue){angular.forEach(newValue,function(val,index){var tab={id:val.id,label:val.label};scope.visibleTabs.push(tab);});if(!newValue){return;}
if(!newValue.length||newValue.length===0){return;}
var activeTab=_.find(newValue,function(item){return item.active;});$timeout(function(){collectFromDom(activeTab);},500);});}};});angular.module("umbraco.directives.html").directive('umbPane',function(){return{transclude:true,restrict:'E',replace:true,templateUrl:'views/directives/html/umb-pane.html'};});angular.module("umbraco.directives.html").directive('umbPanel',function($timeout,$log){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/html/umb-panel.html'};});angular.module("umbraco.directives.html").directive('umbPhotoFolder',function($compile,$log,$timeout,$filter,umbPhotoFolderHelper){return{restrict:'E',replace:true,require:'?ngModel',terminate:true,templateUrl:'views/directives/html/umb-photo-folder.html',link:function(scope,element,attrs,ngModel){var lastWatch=null;ngModel.$render=function(){if(ngModel.$modelValue){$timeout(function(){var photos=ngModel.$modelValue;scope.clickHandler=scope.$eval(element.attr('on-click'));var imagesOnly=element.attr('images-only')==="true";var margin=element.attr('border')?parseInt(element.attr('border'),10):5;var startingIndex=element.attr('baseline')?parseInt(element.attr('baseline'),10):0;var minWidth=element.attr('min-width')?parseInt(element.attr('min-width'),10):420;var minHeight=element.attr('min-height')?parseInt(element.attr('min-height'),10):100;var maxHeight=element.attr('max-height')?parseInt(element.attr('max-height'),10):300;var idealImgPerRow=element.attr('ideal-items-per-row')?parseInt(element.attr('ideal-items-per-row'),10):5;var fixedRowWidth=Math.max(element.width(),minWidth);scope.containerStyle={width:fixedRowWidth+"px"};scope.rows=umbPhotoFolderHelper.buildGrid(photos,fixedRowWidth,maxHeight,startingIndex,minHeight,idealImgPerRow,margin,imagesOnly);if(attrs.filterBy){if(lastWatch){lastWatch();}
lastWatch=scope.$watch(attrs.filterBy,function(newVal,oldVal){if(newVal&&newVal!==oldVal){var p=$filter('filter')(photos,newVal,false);scope.baseline=0;var m=umbPhotoFolderHelper.buildGrid(p,fixedRowWidth,maxHeight,startingIndex,minHeight,idealImgPerRow,margin,imagesOnly);scope.rows=m;}});}},500);}};}};});angular.module("umbraco.directives").directive('umbTab',function(){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/umb-tab.html'};});angular.module("umbraco.directives").directive('umbTabView',function($timeout,$log){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/umb-tab-view.html'};});angular.module("umbraco.directives.html").directive('umbUploadDropzone',function(){return{restrict:'E',replace:true,templateUrl:'views/directives/html/umb-upload-dropzone.html'};});angular.module("umbraco.directives").directive('umbImageCrop',function($timeout,localizationService,cropperHelper,$log){return{restrict:'E',replace:true,templateUrl:'views/directives/imaging/umb-image-crop.html',scope:{src:'=',width:'@',height:'@',crop:"=",center:"=",maxSize:'@'},link:function(scope,element,attrs){scope.width=400;scope.height=320;scope.dimensions={image:{},cropper:{},viewport:{},margin:20,scale:{min:0.3,max:3,current:1}};scope.style=function(){return{'height':(parseInt(scope.dimensions.viewport.height,10))+'px','width':(parseInt(scope.dimensions.viewport.width,10))+'px'};};var $viewport=element.find(".viewport");var $image=element.find("img");var $overlay=element.find(".overlay");var $container=element.find(".crop-container");var constraints={left:{max:scope.dimensions.margin,min:scope.dimensions.margin},top:{max:scope.dimensions.margin,min:scope.dimensions.margin},};scope.constraints=constraints;var setConstraints=function(){constraints.left.min=scope.dimensions.margin+scope.dimensions.cropper.width-scope.dimensions.image.width;constraints.top.min=scope.dimensions.margin+scope.dimensions.cropper.height-scope.dimensions.image.height;};var setDimensions=function(originalImage){originalImage.width("auto");originalImage.height("auto");var image={};image.originalWidth=originalImage.width();image.originalHeight=originalImage.height();image.width=image.originalWidth;image.height=image.originalHeight;image.left=originalImage[0].offsetLeft;image.top=originalImage[0].offsetTop;scope.dimensions.image=image;var _viewPortW=parseInt(scope.width,10);var _viewPortH=parseInt(scope.height,10);if(scope.maxSize){var ratioCalculation=cropperHelper.scaleToMaxSize(_viewPortW,_viewPortH,scope.maxSize);_viewPortW=ratioCalculation.width;_viewPortH=ratioCalculation.height;}
scope.dimensions.viewport.width=_viewPortW+2*scope.dimensions.margin;scope.dimensions.viewport.height=_viewPortH+2*scope.dimensions.margin;scope.dimensions.cropper.width=_viewPortW;scope.dimensions.cropper.height=_viewPortH;};var resizeImageToEditor=function(){var size=cropperHelper.calculateAspectRatioFit(scope.dimensions.image.width,scope.dimensions.image.height,scope.dimensions.cropper.width,scope.dimensions.cropper.height,true);scope.dimensions.image.width=size.width;scope.dimensions.image.height=size.height;scope.dimensions.scale.min=size.ratio;scope.dimensions.scale.max=2;scope.dimensions.scale.current=size.ratio;var position=cropperHelper.centerInsideViewPort(scope.dimensions.image,scope.dimensions.cropper);scope.dimensions.top=position.top;scope.dimensions.left=position.left;setConstraints();};var resizeImageToScale=function(ratio){var size=cropperHelper.calculateSizeToRatio(scope.dimensions.image.originalWidth,scope.dimensions.image.originalHeight,ratio);scope.dimensions.image.width=size.width;scope.dimensions.image.height=size.height;setConstraints();validatePosition(scope.dimensions.image.left,scope.dimensions.image.top);};var resizeImageToCrop=function(){scope.dimensions.image=cropperHelper.convertToStyle(scope.crop,{width:scope.dimensions.image.originalWidth,height:scope.dimensions.image.originalHeight},scope.dimensions.cropper,scope.dimensions.margin);var ratioCalculation=cropperHelper.calculateAspectRatioFit(scope.dimensions.image.originalWidth,scope.dimensions.image.originalHeight,scope.dimensions.cropper.width,scope.dimensions.cropper.height,true);scope.dimensions.scale.current=scope.dimensions.image.ratio;scope.dimensions.scale.min=ratioCalculation.ratio;scope.dimensions.scale.max=2;};var validatePosition=function(left,top){if(left>constraints.left.max)
{left=constraints.left.max;}
if(left<=constraints.left.min){left=constraints.left.min;}
if(top>constraints.top.max)
{top=constraints.top.max;}
if(top<=constraints.top.min){top=constraints.top.min;}
if(scope.dimensions.image.left!==left){scope.dimensions.image.left=left;}
if(scope.dimensions.image.top!==top){scope.dimensions.image.top=top;}};var calculateCropBox=function(){scope.crop=cropperHelper.pixelsToCoordinates(scope.dimensions.image,scope.dimensions.cropper.width,scope.dimensions.cropper.height,scope.dimensions.margin);};var onStartDragPosition,top,left;$overlay.draggable({drag:function(event,ui){scope.$apply(function(){validatePosition(ui.position.left,ui.position.top);});},stop:function(event,ui){scope.$apply(function(){validatePosition(ui.position.left,ui.position.top);calculateCropBox();scope.dimensions.image.rnd=Math.random();});}});var init=function(image){scope.loaded=false;setDimensions(image);if(scope.crop){resizeImageToCrop();}else{resizeImageToEditor();}
setConstraints();scope.loaded=true;};scope.$watchCollection('[width, height]',function(newValues,oldValues){if(newValues!==oldValues){setDimensions($image);setConstraints();}});var throttledResizing=_.throttle(function(){resizeImageToScale(scope.dimensions.scale.current);calculateCropBox();},100);scope.$watch("dimensions.scale.current",function(){if(scope.loaded){throttledResizing();}});if(window.navigator.userAgent.indexOf("MSIE ")){var ranger=element.find("input");ranger.bind("change",function(){scope.$apply(function(){scope.dimensions.scale.current=ranger.val();});});}
$image.load(function(){$timeout(function(){init($image);});});}};});function umbImageFolder($rootScope,assetsService,$timeout,$log,umbRequestHelper,mediaResource,imageHelper,notificationsService){return{restrict:'E',replace:true,templateUrl:'views/directives/imaging/umb-image-folder.html',scope:{options:'=',nodeId:'@',onUploadComplete:'='},link:function(scope,element,attrs){if(scope.onUploadComplete&&!angular.isFunction(scope.onUploadComplete)){throw"onUploadComplete must be a function callback";}
scope.uploading=false;scope.files=[];scope.progress=0;var defaultOptions={url:umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostAddFile")+"?origin=blueimp",autoUpload:true,disableImageResize:/Android(?!.*Chrome)|Opera/.test(window.navigator.userAgent),previewMaxWidth:150,previewMaxHeight:150,previewCrop:true,dropZone:element.find(".drop-zone"),fileInput:element.find("input.uploader"),formData:{currentFolder:scope.nodeId}};scope.blueimpOptions=angular.extend(defaultOptions,scope.options);function loadChildren(id){mediaResource.getChildren(id).then(function(data){scope.images=data.items;});}
function checkComplete(e,data){scope.$apply(function(){function findFile(file){return file===data.files[i];}
for(var i=0;i<data.files.length;i++){var found=_.find(scope.files,findFile);found.completed=true;}
var remaining=_.filter(scope.files,function(file){return file.completed!==true;});if(remaining.length===0){scope.progress=100;$timeout(function(){scope.progress=0;scope.files=[];scope.uploading=false;loadChildren(scope.nodeId);scope.onUploadComplete.apply(this,[data]);},200);}});}
scope.$on('fileuploaddone',function(e,data){checkComplete(e,data);});scope.$on('fileuploadprocessalways',function(e,data){scope.$apply(function(){scope.uploading=true;scope.files.push(data.files[data.index]);});});scope.$on('fileuploadfail',function(e,data){if(data.jqXHR.status===500&&data.jqXHR.responseText.indexOf("Maximum request length exceeded")>=0){notificationsService.error(data.errorThrown,"The image file size was too big, check with your site administrator to adjust the maximum size allowed");}
else{notificationsService.error(data.errorThrown,data.jqXHR.statusText);}
checkComplete(e,data);});scope.$on('fileuploadadd',function(e,data){scope.$apply(function(){scope.uploading=true;});});scope.$on('fileuploaddragover',function(e,data){if(!scope.dragClearTimeout){scope.$apply(function(){scope.dropping=true;});}
else{$timeout.cancel(scope.dragClearTimeout);}
scope.dragClearTimeout=$timeout(function(){scope.dropping=null;scope.dragClearTimeout=null;},300);});loadChildren(scope.nodeId);}};}
angular.module("umbraco.directives").directive("umbUploadPreview",function($parse){return{link:function(scope,element,attr,ctrl){var fn=$parse(attr.umbUploadPreview),file=fn(scope);if(file.preview){element.append(file.preview);}}};}).directive('umbImageFolder',umbImageFolder);angular.module("umbraco.directives").directive('umbImageGravity',function($timeout,localizationService,$log){return{restrict:'E',replace:true,templateUrl:'views/directives/imaging/umb-image-gravity.html',scope:{src:'=',center:"="},link:function(scope,element,attrs){scope.dimensions={width:0,height:0,left:0,top:0};var $viewport=element.find(".viewport");var $image=element.find("img");var $overlay=element.find(".overlay");scope.style=function(){if(scope.dimensions.width<=0){setDimensions();}
return{'top':scope.dimensions.top+'px','left':scope.dimensions.left+'px'};};var setDimensions=function(){scope.dimensions.width=$image.width();scope.dimensions.height=$image.height();if(scope.center){scope.dimensions.left=scope.center.left*scope.dimensions.width-10;scope.dimensions.top=scope.center.top*scope.dimensions.height-10;}else{scope.center={left:0.5,top:0.5};}};var calculateGravity=function(){scope.dimensions.left=$overlay[0].offsetLeft;scope.dimensions.top=$overlay[0].offsetTop;scope.center.left=(scope.dimensions.left+10)/scope.dimensions.width;scope.center.top=(scope.dimensions.top+10)/scope.dimensions.height;};var lazyEndEvent=_.debounce(function(){scope.$apply(function(){scope.$emit("imageFocalPointStop");});},2000);$overlay.draggable({containment:"parent",start:function(){scope.$apply(function(){scope.$emit("imageFocalPointStart");});},stop:function(){scope.$apply(function(){calculateGravity();});lazyEndEvent();}});$image.load(function(){$timeout(function(){setDimensions();});});}};});angular.module("umbraco.directives").directive('umbImageThumbnail',function($timeout,localizationService,cropperHelper,$log){return{restrict:'E',replace:true,templateUrl:'views/directives/imaging/umb-image-thumbnail.html',scope:{src:'=',width:'@',height:'@',center:"=",crop:"=",maxSize:'@'},link:function(scope,element,attrs){var $image=element.find("img");$image.load(function(){$timeout(function(){$image.width("auto");$image.height("auto");scope.image={};scope.image.width=$image[0].width;scope.image.height=$image[0].height;if(scope.maxSize){var ratioCalculation=cropperHelper.calculateAspectRatioFit(scope.width,scope.height,scope.maxSize,scope.maxSize,false);scope.width=ratioCalculation.width;scope.height=ratioCalculation.height;}
setPreviewStyle();});});scope.$watchCollection('[crop, center]',function(newValues,oldValues){setPreviewStyle();});scope.$watch("center",function(){setPreviewStyle();},true);function setPreviewStyle(){if(scope.crop&&scope.image){scope.preview=cropperHelper.convertToStyle(scope.crop,scope.image,{width:scope.width,height:scope.height},0);}else if(scope.image){var p=cropperHelper.calculateAspectRatioFit(scope.image.width,scope.image.height,scope.width,scope.height,true);if(scope.center){var xy=cropperHelper.alignToCoordinates(p,scope.center,{width:scope.width,height:scope.height});p.top=xy.top;p.left=xy.left;}else{}
p.position="absolute";scope.preview=p;}}}};});function umbImageUpload($compile){return{restrict:'A',scope:true,link:function(scope,element,attrs){scope.innerOptions=scope.$eval(attrs.umbImageUpload);var x=angular.element('<div file-upload="innerOptions" />');element.append(x);$compile(x)(scope);},controller:function($scope,$element,$attrs){this.bindEvent=function(e,callback){$scope.$on(e,callback);};}};}
angular.module("umbraco.directives").directive('umbImageUpload',umbImageUpload);function umbImageUploadProgress($rootScope,assetsService,$timeout,$log,umbRequestHelper,mediaResource,imageHelper){return{require:'^umbImageUpload',restrict:'E',replace:true,template:'<div class="progress progress-striped active"><div class="bar" ng-style="{width: progress + \'%\'}"></div></div>',link:function(scope,element,attrs,umbImgUploadCtrl){umbImgUploadCtrl.bindEvent('fileuploadprogressall',function(e,data){scope.progress=parseInt(data.loaded/data.total*100,10);});}};}
angular.module("umbraco.directives").directive('umbImageUploadProgress',umbImageUploadProgress);function umbItemSorter(angularHelper){return{scope:{model:"="},restrict:"E",replace:true,templateUrl:'views/directives/umb-item-sorter.html',link:function(scope,element,attrs,ctrl){var defaultModel={okButton:"Ok",successMsg:"Sorting successful",complete:false};angular.extend(defaultModel,scope.model);scope.model=defaultModel;scope.performSort=function(){scope.$emit("umbItemSorter.sorting",{sortedItems:scope.model.itemsToSort});};scope.handleCancel=function(){scope.$emit("umbItemSorter.cancel");};scope.handleOk=function(){scope.$emit("umbItemSorter.ok");};scope.sortableOptions={axis:'y',cursor:"move",placeholder:"ui-sortable-placeholder",update:function(ev,ui){$(ui.item).effect("highlight",{color:"#049cdb"},500);},stop:function(ev,ui){angularHelper.safeApply(scope,function(){angular.forEach(scope.itemsToSort,function(val,index){val.sortOrder=index+1;});});}};}};}
angular.module('umbraco.directives').directive("umbItemSorter",umbItemSorter);function confirmDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-confirm.html',scope:{onConfirm:'=',onCancel:'=',caption:'@'},link:function(scope,element,attr,ctrl){}};}
angular.module('umbraco.directives').directive("umbConfirm",confirmDirective);angular.module("umbraco.directives").directive('umbContextMenu',function(navigationService){return{scope:{menuDialogTitle:"@",currentSection:"@",currentNode:"=",menuActions:"="},restrict:'E',replace:true,templateUrl:'views/directives/umb-contextmenu.html',link:function(scope,element,attrs,ctrl){scope.executeMenuItem=function(action){navigationService.executeMenuAction(action,scope.currentNode,scope.currentSection);};}};});angular.module("umbraco.directives").directive('umbEditor',function(umbPropEditorHelper){return{scope:{model:"=",isPreValue:"@"},require:"^form",restrict:'E',replace:true,templateUrl:'views/directives/umb-editor.html',link:function(scope,element,attrs,ctrl){scope[ctrl.$name]=ctrl;if(!scope.model.alias){scope.model.alias=Math.random().toString(36).slice(2);}
scope.propertyEditorView=umbPropEditorHelper.getViewPath(scope.model.view,scope.isPreValue);}};});function umbFileUpload(){return{restrict:"A",scope:true,link:function(scope,el,attrs){el.bind('change',function(event){var files=event.target.files;scope.$emit("filesSelected",{files:files});});}};}
angular.module('umbraco.directives').directive("umbFileUpload",umbFileUpload);function loginDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-login.html'};}
angular.module('umbraco.directives').directive("umbLogin",loginDirective);function leftColumnDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-navigation.html'};}
angular.module('umbraco.directives').directive("umbNavigation",leftColumnDirective);function notificationDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-notifications.html'};}
angular.module('umbraco.directives').directive("umbNotifications",notificationDirective);angular.module("umbraco.directives").directive('umbOptionsMenu',function($injector,treeService,navigationService,umbModelMapper,appState){return{scope:{currentSection:"@",currentNode:"="},restrict:'E',replace:true,templateUrl:'views/directives/umb-optionsmenu.html',link:function(scope,element,attrs,ctrl){scope.executeMenuItem=function(action){navigationService.executeMenuAction(action,scope.currentNode,scope.currentSection);};scope.getOptions=function(){if(!scope.currentNode){return;}
appState.setMenuState("currentNode",scope.currentNode);if(!scope.actions){treeService.getMenu({treeNode:scope.currentNode}).then(function(data){scope.actions=data.menuItems;});}};}};});angular.module("umbraco.directives").directive('umbProperty',function(umbPropEditorHelper){return{scope:{property:"="},transclude:true,restrict:'E',replace:true,templateUrl:'views/directives/umb-property.html',controller:function($scope,$timeout){var self=this;self.property=$scope.property;self.setPropertyError=function(errorMsg){$scope.property.propertyErrorMessage=errorMsg;};}};});function sectionsDirective($timeout,$window,navigationService,treeService,sectionResource,appState,eventsService,$location){return{restrict:"E",replace:true,templateUrl:'views/directives/umb-sections.html',link:function(scope,element,attr,ctrl){scope.maxSections=7;scope.overflowingSections=0;scope.sections=[];scope.currentSection=appState.getSectionState("currentSection");scope.showTray=false;scope.stickyNavigation=appState.getGlobalState("stickyNavigation");scope.needTray=false;scope.trayAnimation=function(){if(scope.showTray){return'slide';}
else{return'';}};function loadSections(){sectionResource.getSections().then(function(result){scope.sections=result;calculateHeight();});}
function calculateHeight(){$timeout(function(){var height=$(window).height()-200;scope.totalSections=scope.sections.length;scope.maxSections=Math.floor(height/70);scope.needTray=false;if(scope.totalSections>scope.maxSections){scope.needTray=true;scope.overflowingSections=scope.maxSections-scope.totalSections;}});}
eventsService.on("appState.globalState.changed",function(e,args){if(args.key==="showTray"){scope.showTray=args.value;}
if(args.key==="stickyNavigation"){scope.stickyNavigation=args.value;}});eventsService.on("appState.sectionState.changed",function(e,args){if(args.key==="currentSection"){scope.currentSection=args.value;}});eventsService.on("app.reInitialize",function(e,args){loadSections();});window.onresize=calculateHeight;scope.avatarClick=function(){navigationService.showUserDialog();};scope.helpClick=function(){navigationService.showHelpDialog();};scope.sectionClick=function(section){navigationService.hideSearch();navigationService.showTree(section.alias);$location.path("/"+section.alias);};scope.sectionDblClick=function(section){navigationService.reloadSection(section.alias);};scope.trayClick=function(){navigationService.showTray();};loadSections();}};}
angular.module('umbraco.directives').directive("umbSections",sectionsDirective);function umbTreeDirective($compile,$log,$q,$rootScope,treeService,notificationsService,$timeout,userService){return{restrict:'E',replace:true,terminal:false,scope:{section:'@',treealias:'@',hideoptions:'@',hideheader:'@',cachekey:'@',isdialog:'@',customtreeparams:'@',eventhandler:'=',enablecheckboxes:'@',enablelistviewsearch:'@'},compile:function(element,attrs){var hideoptions=(attrs.hideoptions==='true')?"hide-options":"";var template='<ul class="umb-tree '+hideoptions+'"><li class="root">';template+='<div ng-hide="hideheader" on-right-click="altSelect(tree.root, $event)">'+'<h5>'+'<i ng-if="enablecheckboxes == \'true\'" ng-class="selectEnabledNodeClass(tree.root)"></i>'+'<a href="#/{{section}}" ng-click="select(tree.root, $event)"  class="root-link">{{tree.name}}</a></h5>'+'<a href class="umb-options" ng-hide="tree.root.isContainer || !tree.root.menuUrl" ng-click="options(tree.root, $event)" ng-swipe-right="options(tree.root, $event)"><i></i><i></i><i></i></a>'+'</div>';template+='<ul>'+'<umb-tree-item ng-repeat="child in tree.root.children" eventhandler="eventhandler" node="child" current-node="currentNode" tree="this" section="{{section}}" ng-animate="animation()"></umb-tree-item>'+'</ul>'+'</li>'+'</ul>';element.replaceWith(template);return function(scope,elem,attr,controller){var lastSection="";if(!scope.eventhandler){scope.eventhandler=$({});}
var deleteAnimations=false;function emitEvent(eventName,args){if(scope.eventhandler){$(scope.eventhandler).trigger(eventName,args);}}
function enableDeleteAnimations(){$timeout(function(){deleteAnimations=true;},0,false);}
function setupExternalEvents(){if(scope.eventhandler){scope.eventhandler.clearCache=function(section){treeService.clearCache({section:section});};scope.eventhandler.load=function(section){scope.section=section;loadTree();};scope.eventhandler.reloadNode=function(node){if(!node){node=scope.currentNode;}
if(node){scope.loadChildren(node,true);}};scope.eventhandler.syncTree=function(args){if(!args){throw"args cannot be null";}
if(!args.path){throw"args.path cannot be null";}
var deferred=$q.defer();scope.eventhandler.one("treeSynced",function(e,syncArgs){deferred.resolve(syncArgs);});if(args.tree){loadActiveTree(args.tree);}
if(angular.isString(args.path)){args.path=args.path.replace('"','').split(',');}
args.path=_.filter(args.path,function(item){return(item!=="init"&&item!=="-1");});userService.getCurrentUser().then(function(userData){var startNodes=[userData.startContentId,userData.startMediaId];_.each(startNodes,function(i){var found=_.find(args.path,function(p){return String(p)===String(i);});if(found){args.path=args.path.splice(_.indexOf(args.path,found));}});loadPath(args.path,args.forceReload,args.activate);});return deferred.promise;};scope.eventhandler._setActiveTreeType=function(treeAlias,loadChildren){loadActiveTree(treeAlias,loadChildren);};}}
function loadPath(path,forceReload,activate){if(scope.activeTree){syncTree(scope.activeTree,path,forceReload,activate);}
else{scope.eventhandler.one("activeTreeLoaded",function(e,args){syncTree(args.tree,path,forceReload,activate);});}}
function loadActiveTree(treeAlias,loadChildren){scope.activeTree=undefined;function doLoad(tree){var childrenAndSelf=[tree].concat(tree.children);scope.activeTree=_.find(childrenAndSelf,function(node){if(node&&node.metaData){return node.metaData.treeAlias===treeAlias;}
return false;});if(!scope.activeTree){throw"Could not find the tree "+treeAlias+", activeTree has not been set";}
if(loadChildren){scope.activeTree.expanded=true;scope.loadChildren(scope.activeTree,false).then(function(){emitEvent("activeTreeLoaded",{tree:scope.activeTree});});}
else{emitEvent("activeTreeLoaded",{tree:scope.activeTree});}}
if(scope.tree){doLoad(scope.tree.root);}
else{scope.eventhandler.one("treeLoaded",function(e,args){doLoad(args.tree.root);});}}
function loadTree(){if(!scope.loading&&scope.section){scope.loading=true;deleteAnimations=false;var args={section:scope.section,tree:scope.treealias,cacheKey:scope.cachekey,isDialog:scope.isdialog?scope.isdialog:false};if(scope.customtreeparams){args["queryString"]=scope.customtreeparams;}
treeService.getTree(args).then(function(data){scope.tree=data;enableDeleteAnimations();scope.loading=false;scope.activeTree=scope.tree.root;emitEvent("treeLoaded",{tree:scope.tree});emitEvent("treeNodeExpanded",{tree:scope.tree,node:scope.tree.root,children:scope.tree.root.children});},function(reason){scope.loading=false;notificationsService.error("Tree Error",reason);});}}
function syncTree(treeNode,path,forceReload,activate){deleteAnimations=false;treeService.syncTree({node:treeNode,path:path,forceReload:forceReload}).then(function(data){if(activate===undefined||activate===true){scope.currentNode=data;}
emitEvent("treeSynced",{node:data,activate:activate});enableDeleteAnimations();});}
scope.selectEnabledNodeClass=function(node){return node?node.selected?'icon umb-tree-icon sprTree icon-check blue temporary':'':'';};scope.animation=function(){if(deleteAnimations&&scope.tree&&scope.tree.root&&scope.tree.root.expanded){return{leave:'tree-node-delete-leave'};}
else{return{};}};scope.loadChildren=function(node,forceReload){var deferred=$q.defer();emitEvent("treeNodeExpanding",{tree:scope.tree,node:node});if(!node.children){node.children=[];}
if(forceReload||(node.hasChildren&&node.children.length===0)){treeService.loadNodeChildren({node:node,section:scope.section}).then(function(data){emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:data});enableDeleteAnimations();deferred.resolve(data);});}
else{emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:node.children});node.expanded=true;enableDeleteAnimations();deferred.resolve(node.children);}
return deferred.promise;};scope.options=function(n,ev){emitEvent("treeOptionsClick",{element:elem,node:n,event:ev});};scope.select=function(n,ev){scope.currentNode=null;emitEvent("treeNodeSelect",{element:elem,node:n,event:ev});};scope.altSelect=function(n,ev){emitEvent("treeNodeAltSelect",{element:elem,tree:scope.tree,node:n,event:ev});};scope.$watch("section",function(newVal,oldVal){if(!scope.tree){loadTree();}
if(!newVal){lastSection=oldVal;}
else if(newVal!==oldVal&&newVal!==lastSection){loadTree();lastSection=newVal;}});setupExternalEvents();loadTree();};}};}
angular.module("umbraco.directives").directive('umbTree',umbTreeDirective);angular.module("umbraco.directives").directive('umbTreeItem',function($compile,$http,$templateCache,$interpolate,$log,$location,$rootScope,$window,treeService,$timeout,localizationService){return{restrict:'E',replace:true,scope:{section:'@',eventhandler:'=',currentNode:'=',node:'=',tree:'='},template:'<li ng-class="{\'current\': (node == currentNode)}" on-right-click="altSelect(node, $event)">'+'<div ng-class="getNodeCssClass(node)" ng-swipe-right="options(node, $event)" >'+'<ins style="width:18px;"></ins>'+'<ins ng-class="{\'icon-navigation-right\': !node.expanded, \'icon-navigation-down\': node.expanded}" ng-click="load(node)"></ins>'+'<i class="icon umb-tree-icon sprTree"></i>'+'<a href ng-click="select(node, $event)" on-right-click="altSelect(node, $event)"></a>'+'<a href class="umb-options" ng-click="options(node, $event)"><i></i><i></i><i></i></a>'+'<div ng-show="node.loading" class="l"><div></div></div>'+'</div>'+'</li>',link:function(scope,element,attrs){localizationService.localize("general_search").then(function(value){scope.searchAltText=value;});var deleteAnimations=true;function emitEvent(eventName,args){if(scope.eventhandler){$(scope.eventhandler).trigger(eventName,args);}}
function setupNodeDom(node,tree){element.children(":first").css("padding-left",(node.level*20)+"px");if(!node.hasChildren){element.find("ins:first").remove();element.find("ins").last().hide();}
else{element.find("ins").last().show();}
var icon=element.find("i:first");icon.addClass(node.cssClass);icon.attr("title",node.routePath);element.find("a:first").html(node.name);if(!node.menuUrl){element.find("a.umb-options").remove();}
if(node.style){element.find("i:first").attr("style",node.style);}}
function enableDeleteAnimations(){$timeout(function(){deleteAnimations=true;},0,false);}
scope.getNodeCssClass=function(node){if(!node){return'';}
var css=[];if(node.cssClasses){_.each(node.cssClasses,function(c){css.push(c);});}
if(node.selected){css.push("umb-tree-node-checked");}
return css.join(" ");};scope.node.updateNodeData=function(newNode){_.extend(scope.node,newNode);setupNodeDom(scope.node,scope.tree);};scope.options=function(n,ev){emitEvent("treeOptionsClick",{element:element,tree:scope.tree,node:n,event:ev});};scope.select=function(n,ev){emitEvent("treeNodeSelect",{element:element,tree:scope.tree,node:n,event:ev});};scope.altSelect=function(n,ev){emitEvent("treeNodeAltSelect",{element:element,tree:scope.tree,node:n,event:ev});};scope.animation=function(){if(scope.node.showHideAnimation){return scope.node.showHideAnimation;}
if(deleteAnimations&&scope.node.expanded){return{leave:'tree-node-delete-leave'};}
else{return{};}};scope.load=function(node){if(node.expanded){deleteAnimations=false;emitEvent("treeNodeCollapsing",{tree:scope.tree,node:node,element:element});node.expanded=false;}
else{scope.loadChildren(node,false);}};scope.loadChildren=function(node,forceReload){emitEvent("treeNodeExpanding",{tree:scope.tree,node:node});if(node.hasChildren&&(forceReload||!node.children||(angular.isArray(node.children)&&node.children.length===0))){treeService.loadNodeChildren({node:node,section:scope.section}).then(function(data){emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:data});enableDeleteAnimations();});}
else{emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:node.children});node.expanded=true;enableDeleteAnimations();}};setupNodeDom(scope.node,scope.tree);var template='<ul ng-class="{collapsed: !node.expanded}"><umb-tree-item  ng-repeat="child in node.children" eventhandler="eventhandler" tree="tree" current-node="currentNode" node="child" section="{{section}}" ng-animate="animation()"></umb-tree-item></ul>';var newElement=angular.element(template);$compile(newElement)(scope);element.append(newElement);}};});function treeSearchBox(localizationService,searchService,$q){return{scope:{searchFromId:"@",searchFromName:"@",showSearch:"@",section:"@",hideSearchCallback:"=",searchCallback:"="},restrict:"E",replace:true,templateUrl:'views/directives/umb-tree-search-box.html',link:function(scope,element,attrs,ctrl){scope.term="";scope.hideSearch=function(){scope.term="";scope.hideSearchCallback();};localizationService.localize("general_typeToSearch").then(function(value){scope.searchPlaceholderText=value;});if(!scope.showSearch){scope.showSearch="false";}
var canceler=null;function performSearch(){if(scope.term){scope.results=[];if(canceler){console.log("CANCELED!");canceler.resolve();canceler=$q.defer();}
else{canceler=$q.defer();}
var searchArgs={term:scope.term,canceler:canceler};if(scope.searchFromId){searchArgs["searchFrom"]=scope.searchFromId;}
searcher(searchArgs).then(function(data){scope.searchCallback(data);canceler=null;});}}
scope.$watch("term",_.debounce(function(newVal,oldVal){scope.$apply(function(){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){performSearch();}});},200));var searcher=searchService.searchContent;if(scope.section==="member"){searcher=searchService.searchMembers;}
else if(scope.section==="media"){searcher=searchService.searchMedia;}}};}
angular.module('umbraco.directives').directive("umbTreeSearchBox",treeSearchBox);function treeSearchResults(){return{scope:{results:"=",selectResultCallback:"="},restrict:"E",replace:true,templateUrl:'views/directives/umb-tree-search-results.html',link:function(scope,element,attrs,ctrl){}};}
angular.module('umbraco.directives').directive("umbTreeSearchResults",treeSearchResults);angular.module('umbraco.directives').directive('onKeyup',function(){return function(scope,elm,attrs){elm.bind("keyup",function(){scope.$apply(attrs.onKeyup);});};}).directive('onKeydown',function(){return{link:function(scope,elm,attrs){scope.$apply(attrs.onKeydown);}};}).directive('onBlur',function(){return function(scope,elm,attrs){elm.bind("blur",function(){scope.$apply(attrs.onBlur);});};}).directive('onFocus',function(){return function(scope,elm,attrs){elm.bind("focus",function(){scope.$apply(attrs.onFocus);});};}).directive('onRightClick',function(){document.oncontextmenu=function(e){if(e.target.hasAttribute('on-right-click')){e.preventDefault();e.stopPropagation();return false;}};return function(scope,el,attrs){el.bind('contextmenu',function(e){e.preventDefault();e.stopPropagation();scope.$apply(attrs.onRightClick);return false;});};});angular.module("umbraco.directives").directive('autoScale',function($window){return function(scope,el,attrs){var totalOffset=0;var offsety=parseInt(attrs.autoScale,10);var window=angular.element($window);if(offsety!==undefined){totalOffset+=offsety;}
setTimeout(function(){el.height(window.height()-(el.offset().top+totalOffset));},500);window.bind("resize",function(){el.height(window.height()-(el.offset().top+totalOffset));});};});angular.module('umbraco.directives').directive('checklistModel',['$parse','$compile',function($parse,$compile){function contains(arr,item){if(angular.isArray(arr)){for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){return true;}}}
return false;}
function add(arr,item){arr=angular.isArray(arr)?arr:[];for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){return arr;}}
arr.push(item);return arr;}
function remove(arr,item){if(angular.isArray(arr)){for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){arr.splice(i,1);break;}}}
return arr;}
function postLinkFn(scope,elem,attrs){$compile(elem)(scope);var getter=$parse(attrs.checklistModel);var setter=getter.assign;var value=$parse(attrs.checklistValue)(scope.$parent);scope.$watch('checked',function(newValue,oldValue){if(newValue===oldValue){return;}
var current=getter(scope.$parent);if(newValue===true){setter(scope.$parent,add(current,value));}else{setter(scope.$parent,remove(current,value));}});scope.$parent.$watch(attrs.checklistModel,function(newArr,oldArr){scope.checked=contains(newArr,value);},true);}
return{restrict:'A',priority:1000,terminal:true,scope:true,compile:function(tElement,tAttrs){if(tElement[0].tagName!=='INPUT'||!tElement.attr('type','checkbox')){throw'checklist-model should be applied to `input[type="checkbox"]`.';}
if(!tAttrs.checklistValue){throw'You should provide `checklist-value`.';}
tElement.removeAttr('checklist-model');tElement.attr('ng-model','checked');return postLinkFn;}};}]);angular.module("umbraco.directives").directive('delayedMouseleave',function($timeout,$parse){return{restrict:'A',link:function(scope,element,attrs,ctrl){var active=false;var fn=$parse(attrs.delayedMouseleave);element.on("mouseleave",function(event){var callback=function(){fn(scope,{$event:event});};active=false;$timeout(function(){if(active===false){scope.$apply(callback);}},650);});element.on("mouseenter",function(event,args){active=true;});}};});angular.module("umbraco.directives.html").directive('detectFold',function($timeout,$log){return{restrict:'A',link:function(scope,el,attrs){var state=false,parent=$(".umb-panel-body"),winHeight=$(window).height(),calculate=_.throttle(function(){if(el&&el.is(":visible")&&!el.hasClass("umb-bottom-bar")){var hasOverflow=parent.innerHeight()<parent[0].scrollHeight;if(hasOverflow){el.addClass("umb-bottom-bar");}}
return state;},1000);scope.$watch(calculate,function(newVal,oldVal){if(newVal!==oldVal){if(newVal){el.addClass("umb-bottom-bar");}else{el.removeClass("umb-bottom-bar");}}});$(window).bind("resize",function(){winHeight=$(window).height();el.removeClass("umb-bottom-bar");state=false;calculate();});$('a[data-toggle="tab"]').on('shown',function(e){calculate();});}};});function fixNumber($parse){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){var modelVal=scope.$eval(attrs.ngModel);if(modelVal){var asNum=parseFloat(modelVal,10);if(!isNaN(asNum)){$parse(attrs.ngModel).assign(scope,asNum);}}
ctrl.$parsers.push(function(value){if(value===0){return 0;}
return parseFloat(value||'',10);});ctrl.$formatters.push(function(value){if(angular.isString(value)){return parseFloat(value,10);}
return value;});if(typeof elem.prop('validity')==='undefined'){return;}
elem.bind('input',function(e){var validity=elem.prop('validity');scope.$apply(function(){ctrl.$setValidity('number',!validity.badInput);});});}};}
angular.module('umbraco.directives').directive("fixNumber",fixNumber);angular.module("umbraco.directives").directive('focusWhen',function($timeout){return{restrict:'A',link:function(scope,elm,attrs,ctrl){attrs.$observe("focusWhen",function(newValue){if(newValue==="true"){elm.focus();}});}};});angular.module("umbraco.directives").directive('hotkey',function($window,keyboardService,$log){return function(scope,el,attrs){var keyCombo=scope.$eval(attrs["hotkey"]);if(!keyCombo){keyCombo=attrs["hotkey"];}
keyboardService.bind(keyCombo,function(){var element=$(el);if(element.is("a,button,input[type='button'],input[type='submit']")&&!element.is(':disabled')){element.click();}else{element.focus();}});};});angular.module("umbraco.directives").directive('localize',function($log,localizationService){return{restrict:'E',scope:{key:'@'},replace:true,link:function(scope,element,attrs){var key=scope.key;localizationService.localize(key).then(function(value){element.html(value);});}};}).directive('localize',function($log,localizationService){return{restrict:'A',link:function(scope,element,attrs){var keys=attrs.localize.split(',');angular.forEach(keys,function(value,key){var attr=element.attr(value);if(attr){if(attr[0]==='@'){var t=localizationService.tokenize(attr.substring(1),scope);localizationService.localize(t.key,t.tokens).then(function(val){element.attr(value,val);});}}});}};});angular.module("umbraco.directives").directive('preventDefault',function(){return function(scope,element,attrs){var enabled=true;if(attrs.preventDefault){attrs.$observe("preventDefault",function(newVal){enabled=(newVal==="false"||newVal===0||newVal===false)?false:true;});}
$(element).click(function(event){if(event.metaKey||event.ctrlKey){return;}
else{if(enabled===true){event.preventDefault();}}});};});angular.module("umbraco.directives").directive('preventEnterSubmit',function(){return function(scope,element,attrs){var enabled=true;if(attrs.preventEnterSubmit){attrs.$observe("preventEnterSubmit",function(newVal){enabled=(newVal==="false"||newVal===0||newVal===false)?false:true;});}
$(element).keypress(function(event){if(event.which===13){event.preventDefault();}});};});angular.module("umbraco.directives").directive('resizeToContent',function($window,$timeout){return function(scope,el,attrs){var iframe=el[0];var iframeWin=iframe.contentWindow||iframe.contentDocument.parentWindow;if(iframeWin.document.body){$timeout(function(){var height=iframeWin.document.documentElement.scrollHeight||iframeWin.document.body.scrollHeight;el.height(height);},3000);}};});angular.module("umbraco.directives").directive('selectOnFocus',function(){return function(scope,el,attrs){$(el).bind("click",function(){var editmode=$(el).data("editmode");if(!editmode){this.select();$(el).data("editmode",true);}}).bind("blur",function(){$(el).data("editmode",false);});};});function noDirtyCheck(){return{restrict:'A',require:'ngModel',link:function(scope,elm,attrs,ctrl){elm.focus(function(){ctrl.$pristine=false;});}};}
angular.module('umbraco.directives.validation').directive("noDirtyCheck",noDirtyCheck);angular.module('umbraco.directives.validation').directive('valCustom',function(){return{restrict:'A',require:'ngModel',link:function(scope,elm,attrs,ctrl){var validateFn,watch,validators={},validateExpr=scope.$eval(attrs.valCustom);if(!validateExpr){return;}
if(angular.isString(validateExpr)){validateExpr={validator:validateExpr};}
angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{'$value':valueToValidate});if(angular.isObject(expression)&&angular.isFunction(expression.then)){expression.then(function(){ctrl.$setValidity(key,true);},function(){ctrl.$setValidity(key,false);});return valueToValidate;}else if(expression){ctrl.$setValidity(key,true);return valueToValidate;}else{ctrl.$setValidity(key,false);return undefined;}};validators[key]=validateFn;ctrl.$formatters.push(validateFn);ctrl.$parsers.push(validateFn);});function apply_watch(watch)
{if(angular.isString(watch))
{scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue);});});return;}
if(angular.isArray(watch))
{angular.forEach(watch,function(expression){scope.$watch(expression,function()
{angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue);});});});return;}
if(angular.isObject(watch))
{angular.forEach(watch,function(expression,validatorKey)
{if(angular.isString(expression))
{scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue);});}
if(angular.isArray(expression))
{angular.forEach(expression,function(intExpression)
{scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue);});});}});}}
if(attrs.valCustomWatch){apply_watch(scope.$eval(attrs.valCustomWatch));}}};});function valHighlight($timeout){return{restrict:"A",link:function(scope,element,attrs,ctrl){scope.$watch(function(){return scope.$eval(attrs.valHighlight);},function(newVal,oldVal){if(newVal===true){element.addClass("highlight-error");$timeout(function(){scope[attrs.valHighlight]=false;},1000);}
else{element.removeClass("highlight-error");}});}};}
angular.module('umbraco.directives.validation').directive("valHighlight",valHighlight);angular.module('umbraco.directives.validation').directive('valCompare',function(){return{require:"ngModel",link:function(scope,elem,attrs,ctrl){var otherInput=elem.inheritedData("$formController")[attrs.valCompare];ctrl.$parsers.push(function(value){if(value===otherInput.$viewValue){ctrl.$setValidity("valCompare",true);return value;}
ctrl.$setValidity("valCompare",false);});otherInput.$parsers.push(function(value){ctrl.$setValidity("valCompare",value===ctrl.$viewValue);return value;});}};});function valEmail(valEmailExpression){return{require:'ngModel',restrict:"A",link:function(scope,elm,attrs,ctrl){var patternValidator=function(viewValue){if(!viewValue||valEmailExpression.EMAIL_REGEXP.test(viewValue)){ctrl.$setValidity('valEmail',true);ctrl.errorMsg="";return viewValue;}
else{ctrl.$setValidity('valEmail',false);ctrl.errorMsg="Invalid email";return undefined;}};ctrl.$formatters.push(patternValidator);ctrl.$parsers.push(patternValidator);}};}
angular.module('umbraco.directives.validation').directive("valEmail",valEmail).factory('valEmailExpression',function(){return{EMAIL_REGEXP:/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i};});function valFormManager(serverValidationManager,$rootScope,$log,$timeout,notificationsService,eventsService,$routeParams){return{require:"form",restrict:"A",link:function(scope,element,attr,formCtrl){scope.$watch(function(){return formCtrl.$error;},function(e){scope.$broadcast("valStatusChanged",{form:formCtrl});var inError=element.find(".control-group .ng-invalid").closest(".control-group");inError.addClass("error");var noInError=element.find(".control-group .ng-valid").closest(".control-group").not(inError);noInError.removeClass("error");},true);var className=attr.valShowValidation?attr.valShowValidation:"show-validation";var savingEventName=attr.savingEvent?attr.savingEvent:"formSubmitting";var savedEvent=attr.savedEvent?attr.savingEvent:"formSubmitted";var isSavingNewItem=false;if(serverValidationManager.items.length>0){element.addClass(className);}
scope.$on(savingEventName,function(ev,args){element.addClass(className);isSavingNewItem=$routeParams.create;});scope.$on(savedEvent,function(ev,args){element.removeClass(className);formCtrl.$setPristine();});var locationEvent=$rootScope.$on('$locationChangeStart',function(event,nextLocation,currentLocation){if(!formCtrl.$dirty||isSavingNewItem){return;}
var path=nextLocation.split("#")[1];if(path){if(path.indexOf("%253")||path.indexOf("%252")){path=decodeURIComponent(path);}
if(!notificationsService.hasView()){var msg={view:"confirmroutechange",args:{path:path,listener:locationEvent}};notificationsService.add(msg);}
event.preventDefault();eventsService.emit("valFormManager.pendingChanges",true);}});scope.$on('$destroy',function(){if(locationEvent){locationEvent();}});$timeout(function(){formCtrl.$setPristine();},1000);}};}
angular.module('umbraco.directives.validation').directive("valFormManager",valFormManager);function valPropertyMsg(serverValidationManager){return{scope:{property:"="},require:"^form",replace:true,restrict:"E",template:"<div ng-show=\"errorMsg != ''\" class='alert alert-error property-error' >{{errorMsg}}</div>",link:function(scope,element,attrs,formCtrl){var watcher=null;function getErrorMsg(){if(scope.property){var err=serverValidationManager.getPropertyError(scope.property.alias,"");if(err&&err.errorMsg){return err.errorMsg;}
else{return scope.property.propertyErrorMessage?scope.property.propertyErrorMessage:"Property has errors";}}
return"Property has errors";}
function startWatch(){if(!watcher){watcher=scope.$watch("property.value",function(newValue,oldValue){if(!newValue||angular.equals(newValue,oldValue)){return;}
var errCount=0;for(var e in formCtrl.$error){if(angular.isArray(formCtrl.$error[e])){errCount++;}}
if((errCount===1&&angular.isArray(formCtrl.$error.valPropertyMsg))||(formCtrl.$invalid&&angular.isArray(formCtrl.$error.valServer))){scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();}},true);}}
function stopWatch(){if(watcher){watcher();watcher=null;}}
var showValidation=serverValidationManager.items.length>0;var hasError=false;scope.errorMsg="";scope.$on("valStatusChanged",function(evt,args){if(args.form.$invalid){if(formCtrl.$error.valPropertyMsg&&formCtrl.$error.valPropertyMsg.length>0){return;}
else if(element.closest(".umb-control-group").find(".ng-invalid").length>0){hasError=true;if(showValidation&&scope.errorMsg===""){scope.errorMsg=getErrorMsg();}}
else{hasError=false;scope.errorMsg="";}}
else{hasError=false;scope.errorMsg="";}},true);scope.$on("formSubmitting",function(ev,args){showValidation=true;if(hasError&&scope.errorMsg===""){scope.errorMsg=getErrorMsg();}
else if(!hasError){scope.errorMsg="";stopWatch();}});scope.$on("formSubmitted",function(ev,args){showValidation=false;scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();});if(scope.property){serverValidationManager.subscribe(scope.property.alias,"",function(isValid,propertyErrors,allErrors){hasError=!isValid;if(hasError){scope.errorMsg=propertyErrors[0].errorMsg;formCtrl.$setValidity('valPropertyMsg',false);startWatch();}
else{scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();}});element.bind('$destroy',function(){stopWatch();serverValidationManager.unsubscribe(scope.property.alias,"");});}}};}
angular.module('umbraco.directives.validation').directive("valPropertyMsg",valPropertyMsg);function valPropertyValidator(serverValidationManager){return{scope:{valPropertyValidator:"="},require:['ngModel','?^umbProperty'],restrict:"A",link:function(scope,element,attrs,ctrls){var modelCtrl=ctrls[0];var propCtrl=ctrls.length>1?ctrls[1]:null;if(!scope.valPropertyValidator||!angular.isFunction(scope.valPropertyValidator)){throw new Error('val-property-validator directive must specify a function to call');}
var initResult=scope.valPropertyValidator();var validate=function(viewValue){var result=scope.valPropertyValidator();if(!result.errorKey||result.isValid===undefined||!result.errorMsg){throw"The result object from valPropertyValidator does not contain required properties: isValid, errorKey, errorMsg";}
if(result.isValid===true){modelCtrl.$setValidity(result.errorKey,true);if(propCtrl){propCtrl.setPropertyError(null);}}
else{modelCtrl.$setValidity(result.errorKey,false);if(propCtrl){propCtrl.setPropertyError(result.errorMsg);}}};modelCtrl.$formatters.push(validate);modelCtrl.$parsers.push(validate);}};}
angular.module('umbraco.directives.validation').directive("valPropertyValidator",valPropertyValidator);function valRegex(){return{require:'ngModel',restrict:"A",link:function(scope,elm,attrs,ctrl){var flags="";if(attrs.valRegexFlags){try{flags=scope.$eval(attrs.valRegexFlags);if(!flags){flags=attrs.valRegexFlags;}}
catch(e){flags=attrs.valRegexFlags;}}
var regex;try{var resolved=scope.$eval(attrs.valRegex);if(resolved){regex=new RegExp(resolved,flags);}
else{regex=new RegExp(attrs.valRegex,flags);}}
catch(e){regex=new RegExp(attrs.valRegex,flags);}
var patternValidator=function(viewValue){if(!viewValue||regex.test(viewValue)){ctrl.$setValidity('valRegex',true);ctrl.errorMsg="";return viewValue;}
else{ctrl.$setValidity('valRegex',false);ctrl.errorMsg="Value is invalid, it does not match the correct pattern";return undefined;}};ctrl.$formatters.push(patternValidator);ctrl.$parsers.push(patternValidator);}};}
angular.module('umbraco.directives.validation').directive("valRegex",valRegex);function valServer(serverValidationManager){return{require:['ngModel','?^umbProperty'],restrict:"A",link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];var umbPropCtrl=ctrls.length>1?ctrls[1]:null;if(!umbPropCtrl){return;}
var watcher=null;function startWatch(){if(!watcher){watcher=scope.$watch(function(){return modelCtrl.$modelValue;},function(newValue,oldValue){if(!newValue||angular.equals(newValue,oldValue)){return;}
if(modelCtrl.$invalid){modelCtrl.$setValidity('valServer',true);stopWatch();}},true);}}
function stopWatch(){if(watcher){watcher();watcher=null;}}
var currentProperty=umbPropCtrl.property;var fieldName="value";if(attr.valServer){fieldName=scope.$eval(attr.valServer);if(!fieldName){fieldName=attr.valServer;}}
serverValidationManager.subscribe(currentProperty.alias,fieldName,function(isValid,propertyErrors,allErrors){if(!isValid){modelCtrl.$setValidity('valServer',false);modelCtrl.errorMsg=propertyErrors[0].errorMsg;startWatch();}
else{modelCtrl.$setValidity('valServer',true);modelCtrl.errorMsg="";stopWatch();}});element.bind('$destroy',function(){stopWatch();serverValidationManager.unsubscribe(currentProperty.alias,fieldName);});}};}
angular.module('umbraco.directives.validation').directive("valServer",valServer);function valServerField(serverValidationManager){return{require:'ngModel',restrict:"A",link:function(scope,element,attr,ctrl){if(!attr.valServerField){throw"valServerField must have a field name for referencing server errors";}
var fieldName=attr.valServerField;ctrl.$viewChangeListeners.push(function(){if(ctrl.$invalid){ctrl.$setValidity('valServerField',true);}});serverValidationManager.subscribe(null,fieldName,function(isValid,fieldErrors,allErrors){if(!isValid){ctrl.$setValidity('valServerField',false);ctrl.errorMsg=fieldErrors[0].errorMsg;}
else{ctrl.$setValidity('valServerField',true);ctrl.errorMsg="";}});element.bind('$destroy',function(){serverValidationManager.unsubscribe(null,fieldName);});}};}
angular.module('umbraco.directives.validation').directive("valServerField",valServerField);function valTab(){return{require:"^form",restrict:"A",link:function(scope,element,attr,formCtrl){var tabId="tab"+scope.tab.id;scope.tabHasError=false;scope.$on("valStatusChanged",function(evt,args){if(!args.form.$valid){var tabContent=element.closest(".umb-panel").find("#"+tabId);if(tabContent.find(".ng-invalid").length>0){scope.tabHasError=true;}else{scope.tabHasError=false;}}
else{scope.tabHasError=false;}});}};}
angular.module('umbraco.directives.validation').directive("valTab",valTab);function valToggleMsg(serverValidationManager){return{require:"^form",restrict:"A",link:function(scope,element,attr,formCtrl){if(!attr.valToggleMsg){throw"valToggleMsg requires that a reference to a validator is specified";}
if(!attr.valMsgFor){throw"valToggleMsg requires that the attribute valMsgFor exists on the element";}
if(!formCtrl[attr.valMsgFor]){throw"valToggleMsg cannot find field "+attr.valMsgFor+" on form "+formCtrl.$name;}
var showValidation=serverValidationManager.items.length>0;var hasCustomMsg=element.contents().length>0;scope.$watch(function(){return(formCtrl&&formCtrl[attr.valMsgFor])?formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]:null;},function(){if((formCtrl&&formCtrl[attr.valMsgFor])){if(formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]&&showValidation){element.show();if(!hasCustomMsg){element.html(formCtrl[attr.valMsgFor].errorMsg);}}
else{element.hide();}}});var unsubscribeSaving=scope.$on("formSubmitting",function(ev,args){showValidation=true;if(formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]){element.show();if(!hasCustomMsg){element.html(formCtrl[attr.valMsgFor].errorMsg);}}
else{element.hide();}});var unsubscribeSaved=scope.$on("formSubmitted",function(ev,args){showValidation=false;element.hide();});element.bind('$destroy',function(){unsubscribeSaving();unsubscribeSaved();});}};}
angular.module('umbraco.directives.validation').directive("valToggleMsg",valToggleMsg);angular.module('umbraco.directives.validation').directive('valTriggerChange',function($sniffer){return{link:function(scope,elem,attrs){elem.bind('click',function(){$(attrs.valTriggerChange).trigger($sniffer.hasEvent('input')?'input':'change');});},priority:1};});})();
;;;
(function(){angular.module('umbraco.filters',[]);angular.module("umbraco.filters").filter('timespan',function(){return function(input){var sec_num=parseInt(input,10);var hours=Math.floor(sec_num/3600);var minutes=Math.floor((sec_num-(hours*3600))/60);var seconds=sec_num-(hours*3600)-(minutes*60);if(hours<10){hours="0"+hours;}
if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
var time=hours+':'+minutes+':'+seconds;return time;};});})();
;;;
(function(){angular.module("umbraco.services",["umbraco.security","umbraco.resources"]);function angularHelper($log,$q){return{rejectedPromise:function(objReject){var deferred=$q.defer();deferred.reject(objReject);return deferred.promise;},safeApply:function(scope,fn){if(scope.$$phase||scope.$root.$$phase){if(angular.isFunction(fn)){fn();}}
else{if(angular.isFunction(fn)){scope.$apply(fn);}
else{scope.$apply();}}},getCurrentForm:function(scope){var form=null;var requiredFormProps=["$addControl","$removeControl","$setValidity","$setDirty","$setPristine"];function propertyExists(objectPropNames){return _.every(requiredFormProps,function(item){return _.contains(objectPropNames,item);});}
for(var p in scope){if(_.isObject(scope[p])&&p!=="this"&&p.substr(0,1)!=="$"){var props=_.keys(scope[p]);if(props.length<requiredFormProps.length){continue;}
var containProperty=propertyExists(props);if(containProperty){form=scope[p];break;}}}
return form;},getRequiredCurrentForm:function(scope){var currentForm=this.getCurrentForm(scope);if(!currentForm||!currentForm.$name){throw"The current scope requires a current form object (or ng-form) with a name assigned to it";}
return currentForm;},getNullForm:function(formName){return{$addControl:angular.noop,$removeControl:angular.noop,$setValidity:angular.noop,$setDirty:angular.noop,$setPristine:angular.noop,$name:formName};}};}
angular.module('umbraco.services').factory('angularHelper',angularHelper);function appState(eventsService){var globalState={showNavigation:null,touchDevice:null,showTray:null,stickyNavigation:null,navMode:null,isReady:null};var sectionState={currentSection:null,showSearchResults:null};var treeState={selectedNode:null,currentRootNode:null};var menuState={menuActions:null,dialogTitle:null,currentNode:null,showMenuDialog:null,showMenu:null};function setState(stateObj,key,value,stateObjName){if(!_.has(stateObj,key)){throw"The variable "+key+" does not exist in "+stateObjName;}
var changed=stateObj[key]!==value;stateObj[key]=value;if(changed){eventsService.emit("appState."+stateObjName+".changed",{key:key,value:value});}}
function getState(stateObj,key,stateObjName){if(!_.has(stateObj,key)){throw"The variable "+key+" does not exist in "+stateObjName;}
return stateObj[key];}
return{getGlobalState:function(key){return getState(globalState,key,"globalState");},setGlobalState:function(key,value){setState(globalState,key,value,"globalState");},getSectionState:function(key){return getState(sectionState,key,"sectionState");},setSectionState:function(key,value){setState(sectionState,key,value,"sectionState");},getTreeState:function(key){return getState(treeState,key,"treeState");},setTreeState:function(key,value){setState(treeState,key,value,"treeState");},getMenuState:function(key){return getState(menuState,key,"menuState");},setMenuState:function(key,value){setState(menuState,key,value,"menuState");},};}
angular.module('umbraco.services').factory('appState',appState);angular.module('umbraco.services').factory("editorState",function(){var current=null;var state={set:function(entity){current=entity;},reset:function(){current=null;},getCurrent:function(){return current;}};Object.defineProperty(state,"current",{get:function(){return current;},set:function(value){throw"Use editorState.set to set the value of the current entity";},});return state;});angular.module('umbraco.services').factory('assetsService',function($q,$log,angularHelper,umbRequestHelper,$rootScope,$http){var initAssetsLoaded=false;var appendRnd=function(url){if(!Umbraco.Sys.ServerVariables.application){return url;}
var rnd=Umbraco.Sys.ServerVariables.application.version+"."+Umbraco.Sys.ServerVariables.application.cdf;var _op=(url.indexOf("?")>0)?"&":"?";url=url+_op+"umb__rnd="+rnd;return url;};var service={loadedAssets:{},_getAssetPromise:function(path){if(this.loadedAssets[path]){return this.loadedAssets[path];}else{var deferred=$q.defer();this.loadedAssets[path]={deferred:deferred,state:"new",path:path};return this.loadedAssets[path];}},_loadInitAssets:function(){var deferred=$q.defer();if(initAssetsLoaded===false){var self=this;self.loadJs(umbRequestHelper.getApiUrl("serverVarsJs","",""),$rootScope).then(function(){initAssetsLoaded=true;self.loadJs(umbRequestHelper.getApiUrl("legacyTreeJs","",""),$rootScope);deferred.resolve();});}
else{deferred.resolve();}
return deferred.promise;},loadCss:function(path,scope,attributes,timeout){var asset=this._getAssetPromise(path);var t=timeout||5000;var a=attributes||undefined;if(asset.state==="new"){asset.state="loading";LazyLoad.css(appendRnd(path),function(){if(!scope){asset.state="loaded";asset.deferred.resolve(true);}else{asset.state="loaded";angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});}else if(asset.state==="loaded"){asset.deferred.resolve(true);}
return asset.deferred.promise;},loadJs:function(path,scope,attributes,timeout){var asset=this._getAssetPromise(path);var t=timeout||5000;var a=attributes||undefined;if(asset.state==="new"){asset.state="loading";LazyLoad.js(appendRnd(path),function(){if(!scope){asset.state="loaded";asset.deferred.resolve(true);}else{asset.state="loaded";angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});}else if(asset.state==="loaded"){asset.deferred.resolve(true);}
return asset.deferred.promise;},load:function(pathArray,scope){var promise;if(!angular.isArray(pathArray)){throw"pathArray must be an array";}
var nonEmpty=_.reject(pathArray,function(item){return item===undefined||item==="";});if(nonEmpty.length>0){var promises=[];var assets=[];_.each(nonEmpty,function(path){var asset=service._getAssetPromise(path);if(asset.state!=="loaded")
{if(asset.state==="new"){asset.state="loading";assets.push(asset);}
promises.push(asset.deferred.promise);}});promise=$q.all(promises);_.each(assets,function(asset){LazyLoad.js(appendRnd(asset.path),function(){if(!scope){asset.state="loaded";asset.deferred.resolve(true);}else{asset.state="loaded";angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});});}else{var deferred=$q.defer();promise=deferred.promise;deferred.resolve(true);}
return promise;}};return service;});function contentEditingHelper(fileManager,$q,$location,$routeParams,notificationsService,serverValidationManager,dialogService,formHelper,appState,keyboardService){return{contentEditorPerformSave:function(args){if(!angular.isObject(args)){throw"args must be an object";}
if(!args.scope){throw"args.scope is not defined";}
if(!args.content){throw"args.content is not defined";}
if(!args.statusMessage){throw"args.statusMessage is not defined";}
if(!args.saveMethod){throw"args.saveMethod is not defined";}
var self=this;var deferred=$q.defer();if(!args.scope.busy&&formHelper.submitForm({scope:args.scope,statusMessage:args.statusMessage})){args.scope.busy=true;args.saveMethod(args.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:args.scope,notifications:data.notifications});self.handleSuccessfulSave({scope:args.scope,savedContent:data,rebindCallback:self.reBindChangedProperties(args.content,data)});args.scope.busy=false;deferred.resolve(data);},function(err){self.handleSaveError({redirectOnFailure:true,err:err,rebindCallback:self.reBindChangedProperties(args.content,err.data)});args.scope.busy=false;deferred.reject(err);});}
else{deferred.reject();}
return deferred.promise;},configureContentEditorButtons:function(args){if(!angular.isObject(args)){throw"args must be an object";}
if(!args.content){throw"args.content is not defined";}
if(!args.methods){throw"args.methods is not defined";}
if(!args.methods.saveAndPublish||!args.methods.sendToPublish||!args.methods.save||!args.methods.unPublish){throw"args.methods does not contain all required defined methods";}
var buttons={defaultButton:null,subButtons:[]};function createButtonDefinition(ch){switch(ch){case"U":keyboardService.bind("ctrl+p",args.methods.saveAndPublish);return{letter:ch,labelKey:"buttons_saveAndPublish",handler:args.methods.saveAndPublish,hotKey:"ctrl+p"};case"H":keyboardService.bind("ctrl+p",args.methods.sendToPublish);return{letter:ch,labelKey:"buttons_saveToPublish",handler:args.methods.sendToPublish,hotKey:"ctrl+p"};case"A":keyboardService.bind("ctrl+s",args.methods.save);return{letter:ch,labelKey:"buttons_save",handler:args.methods.save,hotKey:"ctrl+s"};case"Z":keyboardService.bind("ctrl+u",args.methods.unPublish);return{letter:ch,labelKey:"content_unPublish",handler:args.methods.unPublish};default:return null;}}
buttons.subButtons=[];var buttonOrder=["U","H","A"];if(!args.create||_.contains(args.content.allowedActions,"C")){for(var b in buttonOrder){if(_.contains(args.content.allowedActions,buttonOrder[b])){buttons.defaultButton=createButtonDefinition(buttonOrder[b]);break;}}}
if(buttons.defaultButton){var lastIndex=_.indexOf(buttonOrder,buttons.defaultButton.letter);for(var i=lastIndex+1;i<buttonOrder.length;i++){if(_.contains(args.content.allowedActions,buttonOrder[i])){buttons.subButtons.push(createButtonDefinition(buttonOrder[i]));}}
if(!args.create){if(args.content.publishDate&&_.contains(args.content.allowedActions,"U")){buttons.subButtons.push(createButtonDefinition("Z"));}}}
return buttons;},getAllProps:function(content){var allProps=[];for(var i=0;i<content.tabs.length;i++){for(var p=0;p<content.tabs[i].properties.length;p++){allProps.push(content.tabs[i].properties[p]);}}
return allProps;},getAllowedActions:function(content,creating){var actionOrder=["U","H","A"];var defaultActions;var actions=[];if(!creating||_.contains(content.allowedActions,"C")){for(var b in actionOrder){if(_.contains(content.allowedActions,actionOrder[b])){defaultAction=actionOrder[b];break;}}}
actions.push(defaultAction);if(defaultAction){var lastIndex=_.indexOf(actionOrder,defaultAction);for(var i=lastIndex+1;i<actionOrder.length;i++){if(_.contains(content.allowedActions,actionOrder[i])){actions.push(actionOrder[i]);}}
if(!creating){if(content.publishDate&&_.contains(content.allowedActions,"U")){actions.push("Z");}}}
return actions;},getButtonFromAction:function(ch){switch(ch){case"U":return{letter:ch,labelKey:"buttons_saveAndPublish",handler:"saveAndPublish",hotKey:"ctrl+p"};case"H":return{letter:ch,labelKey:"buttons_saveToPublish",handler:"sendToPublish",hotKey:"ctrl+p"};case"A":return{letter:ch,labelKey:"buttons_save",handler:"save",hotKey:"ctrl+s"};case"Z":return{letter:ch,labelKey:"content_unPublish",handler:"unPublish"};default:return null;}},reBindChangedProperties:function(origContent,savedContent){var changed=[];var allOrigProps=this.getAllProps(origContent);var allNewProps=this.getAllProps(savedContent);function getNewProp(alias){return _.find(allNewProps,function(item){return item.alias===alias;});}
var shouldIgnore=function(propName){return _.some(["tabs","notifications","ModelState","tabs","properties"],function(i){return i===propName;});};for(var o in origContent){if(shouldIgnore(o)){continue;}
if(!_.isEqual(origContent[o],savedContent[o])){origContent[o]=savedContent[o];}}
for(var p in allOrigProps){var newProp=getNewProp(allOrigProps[p].alias);if(newProp&&!_.isEqual(allOrigProps[p].value,newProp.value)){var origVal=allOrigProps[p].value;allOrigProps[p].value=newProp.value;if(angular.isFunction(allOrigProps[p].onValueChanged)){allOrigProps[p].onValueChanged(allOrigProps[p].value,origVal);}
changed.push(allOrigProps[p]);}}
return changed;},handleSaveError:function(args){if(!args.err){throw"args.err cannot be null";}
if(args.redirectOnFailure===undefined||args.redirectOnFailure===null){throw"args.redirectOnFailure must be set to true or false";}
if(args.err.status===400){if(args.err.data&&(args.err.data.ModelState)){formHelper.handleServerValidation(args.err.data.ModelState);if(!args.redirectOnFailure||!this.redirectToCreatedContent(args.err.data.id,args.err.data.ModelState)){if(args.rebindCallback&&angular.isFunction(args.rebindCallback)){args.rebindCallback();}
serverValidationManager.executeAndClearAllSubscriptions();}
return true;}
else{dialogService.ysodDialog(args.err);}}
else{dialogService.ysodDialog(args.err);}
return false;},handleSuccessfulSave:function(args){if(!args){throw"args cannot be null";}
if(!args.savedContent){throw"args.savedContent cannot be null";}
if(!this.redirectToCreatedContent(args.redirectId?args.redirectId:args.savedContent.id)){if(args.rebindCallback&&angular.isFunction(args.rebindCallback)){args.rebindCallback();}}},redirectToCreatedContent:function(id,modelState){if($routeParams.create&&(!modelState||!modelState["Name"])){$location.search("");$location.path("/"+$routeParams.section+"/"+$routeParams.tree+"/"+$routeParams.method+"/"+id);$location.replace();return true;}
return false;}};}
angular.module('umbraco.services').factory('contentEditingHelper',contentEditingHelper);function cropperHelper(umbRequestHelper,$http){var service={configuration:function(mediaTypeAlias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("imageCropperApiBaseUrl","GetConfiguration",[{mediaTypeAlias:mediaTypeAlias}])),'Failed to retrieve tinymce configuration');},calculateAspectRatioFit:function(srcWidth,srcHeight,maxWidth,maxHeight,maximize){var ratio=[maxWidth/srcWidth,maxHeight/srcHeight];if(maximize){ratio=Math.max(ratio[0],ratio[1]);}else{ratio=Math.min(ratio[0],ratio[1]);}
return{width:srcWidth*ratio,height:srcHeight*ratio,ratio:ratio};},calculateSizeToRatio:function(srcWidth,srcHeight,ratio){return{width:srcWidth*ratio,height:srcHeight*ratio,ratio:ratio};},scaleToMaxSize:function(srcWidth,srcHeight,maxSize){var retVal={height:srcHeight,width:srcWidth};if(srcWidth>maxSize||srcHeight>maxSize){var ratio=[maxSize/srcWidth,maxSize/srcHeight];ratio=Math.min(ratio[0],ratio[1]);retVal.height=srcHeight*ratio;retVal.width=srcWidth*ratio;}
return retVal;},convertToStyle:function(coordinates,originalSize,viewPort,offset){var coordinates_px=service.coordinatesToPixels(coordinates,originalSize,offset);var _offset=offset||0;var x=1-(coordinates.x1+Math.abs(coordinates.x2));var left_of_x=originalSize.width*x;var ratio=viewPort.width/left_of_x;var style={position:"absolute",top:-(coordinates_px.y1*ratio)+_offset,left:-(coordinates_px.x1*ratio)+_offset,width:Math.floor(originalSize.width*ratio),height:Math.floor(originalSize.height*ratio),originalWidth:originalSize.width,originalHeight:originalSize.height,ratio:ratio};return style;},coordinatesToPixels:function(coordinates,originalSize,offset){var coordinates_px={x1:Math.floor(coordinates.x1*originalSize.width),y1:Math.floor(coordinates.y1*originalSize.height),x2:Math.floor(coordinates.x2*originalSize.width),y2:Math.floor(coordinates.y2*originalSize.height)};return coordinates_px;},pixelsToCoordinates:function(image,width,height,offset){var x1_px=Math.abs(image.left-offset);var y1_px=Math.abs(image.top-offset);var x2_px=image.width-(x1_px+width);var y2_px=image.height-(y1_px+height);var crop={};crop.x1=x1_px/image.width;crop.y1=y1_px/image.height;crop.x2=x2_px/image.width;crop.y2=y2_px/image.height;for(var coord in crop){if(crop[coord]<0){crop[coord]=0;}}
return crop;},centerInsideViewPort:function(img,viewport){var left=viewport.width/2-img.width/2,top=viewport.height/2-img.height/2;return{left:left,top:top};},alignToCoordinates:function(image,center,viewport){var min_left=(image.width)-(viewport.width);var min_top=(image.height)-(viewport.height);var c_top=-(center.top*image.height)+(viewport.height/2);var c_left=-(center.left*image.width)+(viewport.width/2);if(c_top<-min_top){c_top=-min_top;}
if(c_top>0){c_top=0;}
if(c_left<-min_left){c_left=-min_left;}
if(c_left>0){c_left=0;}
return{left:c_left,top:c_top};},syncElements:function(source,target){target.height(source.height());target.width(source.width());target.css({"top":source[0].offsetTop,"left":source[0].offsetLeft});}};return service;}
angular.module('umbraco.services').factory('cropperHelper',cropperHelper);angular.module('umbraco.services').factory('dialogService',function($rootScope,$compile,$http,$timeout,$q,$templateCache,appState,eventsService){var dialogs=[];function removeAllDialogs(args){for(var i=0;i<dialogs.length;i++){var dialog=dialogs[i];if(!dialog.manualClose){dialog.close(args);}}}
function closeDialog(dialog){if(dialog.element){dialog.element.modal('hide');if(dialog.iframe){dialog.element.find("iframe").attr("src","about:blank");$timeout(function(){dialog.element.remove();$("#"+dialog.element.attr("id")).remove();dialog.scope.$destroy();},1000);}else{dialog.element.remove();$("#"+dialog.element.attr("id")).remove();dialog.scope.$destroy();}}
dialogs=_.reject(dialogs,function(i){return i===dialog;});}
function openDialog(options){var defaults={container:$("body"),animation:"fade",modalClass:"umb-modal",width:"100%",inline:false,iframe:false,show:true,template:"views/common/notfound.html",callback:undefined,closeCallback:undefined,element:undefined,dialogData:undefined};var dialog=angular.extend(defaults,options);var scope=options.scope||$rootScope.$new();dialog.element=$('<div ng-swipe-right="swipeHide($event)"  data-backdrop="false"></div>');var id=dialog.template.replace('.html','').replace('.aspx','').replace(/[\/|\.|:\&\?\=]/g,"-")+'-'+scope.$id;if(options.inline){dialog.animation="";}
else{dialog.element.addClass("modal");dialog.element.addClass("hide");}
dialog.element.attr('id',id).addClass(dialog.animation).addClass(dialog.modalClass);$timeout(function(){dialogs.push(dialog);},500);dialog.close=function(data){if(dialog.closeCallback){dialog.closeCallback(data);}
closeDialog(dialog);};if(dialog.iframe){var html=$("<iframe src='"+dialog.template+"' class='auto-expand' style='border: none; width: 100%; height: 100%;'></iframe>");dialog.element.html(html);dialog.container.append(dialog.element);$timeout(function(){$compile(dialog.element)(dialog.scope);});dialog.element.css("width",dialog.width);if(dialog.show){dialog.element.modal('show');}
dialog.scope=scope;return dialog;}
else{$q.when($templateCache.get(dialog.template)||$http.get(dialog.template,{cache:true}).then(function(res){return res.data;})).then(function onSuccess(template){dialog.element.html(template);dialog.container.append(dialog.element);$timeout(function(){$compile(dialog.element)(scope);});scope.dialogOptions=dialog;scope.dialogData=dialog.dialogData?dialog.dialogData:{};scope.dialogData.selection=[];scope.$modal=function(name){dialog.element.modal(name);};scope.swipeHide=function(e){if(appState.getGlobalState("touchDevice")){var selection=window.getSelection();if(selection.type!=="Range"){scope.hide();}}};scope.hide=function(){closeDialog(dialog);};scope.submit=function(data){if(dialog.callback){dialog.callback(data);}
closeDialog(dialog);};scope.close=function(data){dialog.close(data);};scope.show=function(){if(dialog.manualClose===true){dialog.element.modal({keyboard:false});}
else{dialog.element.modal('show');}};scope.select=function(item){var i=scope.dialogData.selection.indexOf(item);if(i<0){scope.dialogData.selection.push(item);}else{scope.dialogData.selection.splice(i,1);}};scope.dismiss=scope.hide;angular.forEach(['show','shown','hide','hidden'],function(name){dialog.element.on(name,function(ev){scope.$emit('modal-'+name,ev);});});dialog.element.on('shown',function(event){$('input[autofocus]',dialog.element).first().trigger('focus');});dialog.scope=scope;if(dialog.show){scope.show();}});return dialog;}}
eventsService.on("app.closeDialogs",function(evt,args){removeAllDialogs(args);});return{open:function(options){return openDialog(options);},close:function(dialog,args){if(dialog){dialog.close(args);}},closeAll:function(args){removeAllDialogs(args);},mediaPicker:function(options){options.template='views/common/dialogs/mediaPicker.html';options.show=true;return openDialog(options);},contentPicker:function(options){options.treeAlias="content";options.section="content";return this.treePicker(options);},linkPicker:function(options){options.template='views/common/dialogs/linkPicker.html';options.show=true;return openDialog(options);},macroPicker:function(options){options.template='views/common/dialogs/insertmacro.html';options.show=true;options.modalClass="span7 umb-modal";return openDialog(options);},memberPicker:function(options){options.treeAlias="member";options.section="member";return this.treePicker(options);},memberGroupPicker:function(options){options.template='views/common/dialogs/memberGroupPicker.html';options.show=true;return openDialog(options);},iconPicker:function(options){options.template='views/common/dialogs/iconPicker.html';options.show=true;return openDialog(options);},treePicker:function(options){options.template='views/common/dialogs/treePicker.html';options.show=true;return openDialog(options);},propertyDialog:function(options){options.template='views/common/dialogs/property.html';options.show=true;return openDialog(options);},embedDialog:function(options){options.template='views/common/dialogs/rteembed.html';options.show=true;return openDialog(options);},ysodDialog:function(ysodError){var newScope=$rootScope.$new();newScope.error=ysodError;return openDialog({modalClass:"umb-modal wide",scope:newScope,template:'views/common/dialogs/ysod.html',show:true});}};});function eventsService($q,$rootScope){return{emit:function(name,args){if(!$rootScope.$$listeners[name]){return;}
$rootScope.$emit(name,args);},on:function(name,callback){return $rootScope.$on(name,callback);},unsubscribe:function(handle){if(angular.isFunction(handle)){handle();}}};}
angular.module('umbraco.services').factory('eventsService',eventsService);function fileManager(){var fileCollection=[];return{setFiles:function(propertyAlias,files){fileCollection=_.reject(fileCollection,function(item){return item.alias===propertyAlias;});for(var i=0;i<files.length;i++){fileCollection.push({alias:propertyAlias,file:files[i]});}},getFiles:function(){return fileCollection;},clearFiles:function(){fileCollection=[];}};}
angular.module('umbraco.services').factory('fileManager',fileManager);function formHelper(angularHelper,serverValidationManager,$timeout,notificationsService,dialogService){return{submitForm:function(args){var currentForm;if(!args){throw"args cannot be null";}
if(!args.scope){throw"args.scope cannot be null";}
if(!args.formCtrl){currentForm=angularHelper.getRequiredCurrentForm(args.scope);}
else{currentForm=args.formCtrl;}
if(!args.statusPropertyName){args.statusPropertyName="formStatus";}
if(!args.statusTimeout){args.statusTimeout=2500;}
args.scope.$broadcast("formSubmitting",{scope:args.scope});if(!args.skipValidation){if(currentForm.$invalid){return false;}}
serverValidationManager.reset();if(args.statusMessage){args.scope[args.statusPropertyName]=args.statusMessage;$timeout(function(){args.scope[args.statusPropertyName]=undefined;},args.statusTimeout);}
return true;},resetForm:function(args){if(!args){throw"args cannot be null";}
if(!args.scope){throw"args.scope cannot be null";}
if(!args.statusPropertyName){args.statusPropertyName="formStatus";}
args.scope[args.statusPropertyName]=null;if(angular.isArray(args.notifications)){for(var i=0;i<args.notifications.length;i++){notificationsService.showNotification(args.notifications[i]);}}
args.scope.$broadcast("formSubmitted",{scope:args.scope});},handleError:function(err){if(err.status===400){if(err.data&&(err.data.ModelState)){this.handleServerValidation(err.data.ModelState);serverValidationManager.executeAndClearAllSubscriptions();}
else{dialogService.ysodDialog(err);}}
else{dialogService.ysodDialog(err);}},handleServerValidation:function(modelState){for(var e in modelState){var parts=e.split(".");if(parts.length>1){var propertyAlias=parts[1];if(parts.length>2){serverValidationManager.addPropertyError(propertyAlias,parts[2],modelState[e][0]);}
else{serverValidationManager.addPropertyError(propertyAlias,"",modelState[e][0]);}}
else{serverValidationManager.addFieldError(parts[0],modelState[e][0]);}
notificationsService.error("Validation",modelState[e][0]);}}};}
angular.module('umbraco.services').factory('formHelper',formHelper);angular.module('umbraco.services').factory('gridService',function($http,$q){var configPath="../config/grid.editors.config.js";var service={getGridEditors:function(){return $http.get(configPath);}};return service;});angular.module('umbraco.services').factory('helpService',function($http,$q){var helpTopics={};var defaultUrl="http://our.umbraco.org/rss/help";var tvUrl="http://umbraco.tv/feeds/help";function getCachedHelp(url){if(helpTopics[url]){return helpTopics[cacheKey];}else{return null;}}
function setCachedHelp(url,data){helpTopics[url]=data;}
function fetchUrl(url){var deferred=$q.defer();var found=getCachedHelp(url);if(found){deferred.resolve(found);}else{var proxyUrl="dashboard/feedproxy.aspx?url="+url;$http.get(proxyUrl).then(function(data){var feed=$(data.data);var topics=[];$('item',feed).each(function(i,item){var topic={};topic.thumbnail=$(item).find('thumbnail').attr('url');topic.title=$("title",item).text();topic.link=$("guid",item).text();topic.description=$("description",item).text();topics.push(topic);});setCachedHelp(topics);deferred.resolve(topics);});}
return deferred.promise;}
var service={findHelp:function(args){var url=service.getUrl(defaultUrl,args);return fetchUrl(url);},findVideos:function(args){var url=service.getUrl(tvUrl,args);return fetchUrl(url);},getUrl:function(url,args){return url+"?"+$.param(args);}};return service;});angular.module('umbraco.services').factory('historyService',function($rootScope,$timeout,angularHelper,eventsService){var nArray=[];function add(item){if(!item){return null;}
var listWithoutThisItem=_.reject(nArray,function(i){return i.link===item.link;});listWithoutThisItem.splice(0,0,item);nArray=listWithoutThisItem;return nArray[0];}
return{add:function(item){var icon=item.icon||"icon-file";angularHelper.safeApply($rootScope,function(){var result=add({name:item.name,icon:icon,link:item.link,time:new Date()});eventsService.emit("historyService.add",{added:result,all:nArray});return result;});},remove:function(index){angularHelper.safeApply($rootScope,function(){var result=nArray.splice(index,1);eventsService.emit("historyService.remove",{removed:result,all:nArray});});},removeAll:function(){angularHelper.safeApply($rootScope,function(){nArray=[];eventsService.emit("historyService.removeAll");});},getCurrent:function(){return nArray;}};});function iconHelper($q,$timeout){var converter=[{oldIcon:".sprNew",newIcon:"add"},{oldIcon:".sprDelete",newIcon:"remove"},{oldIcon:".sprMove",newIcon:"enter"},{oldIcon:".sprCopy",newIcon:"documents"},{oldIcon:".sprSort",newIcon:"navigation-vertical"},{oldIcon:".sprPublish",newIcon:"globe"},{oldIcon:".sprRollback",newIcon:"undo"},{oldIcon:".sprProtect",newIcon:"lock"},{oldIcon:".sprAudit",newIcon:"time"},{oldIcon:".sprNotify",newIcon:"envelope"},{oldIcon:".sprDomain",newIcon:"home"},{oldIcon:".sprPermission",newIcon:"lock"},{oldIcon:".sprRefresh",newIcon:"refresh"},{oldIcon:".sprBinEmpty",newIcon:"trash"},{oldIcon:".sprExportDocumentType",newIcon:"download-alt"},{oldIcon:".sprImportDocumentType",newIcon:"page-up"},{oldIcon:".sprLiveEdit",newIcon:"edit"},{oldIcon:".sprCreateFolder",newIcon:"add"},{oldIcon:".sprPackage2",newIcon:"box"},{oldIcon:".sprLogout",newIcon:"logout"},{oldIcon:".sprSave",newIcon:"save"},{oldIcon:".sprSendToTranslate",newIcon:"envelope-alt"},{oldIcon:".sprToPublish",newIcon:"mail-forward"},{oldIcon:".sprTranslate",newIcon:"comments"},{oldIcon:".sprUpdate",newIcon:"save"},{oldIcon:".sprTreeSettingDomain",newIcon:"icon-home"},{oldIcon:".sprTreeDoc",newIcon:"icon-document"},{oldIcon:".sprTreeDoc2",newIcon:"icon-diploma-alt"},{oldIcon:".sprTreeDoc3",newIcon:"icon-notepad"},{oldIcon:".sprTreeDoc4",newIcon:"icon-newspaper-alt"},{oldIcon:".sprTreeDoc5",newIcon:"icon-notepad-alt"},{oldIcon:".sprTreeDocPic",newIcon:"icon-picture"},{oldIcon:".sprTreeFolder",newIcon:"icon-folder"},{oldIcon:".sprTreeFolder_o",newIcon:"icon-folder"},{oldIcon:".sprTreeMediaFile",newIcon:"icon-music"},{oldIcon:".sprTreeMediaMovie",newIcon:"icon-movie"},{oldIcon:".sprTreeMediaPhoto",newIcon:"icon-picture"},{oldIcon:".sprTreeMember",newIcon:"icon-user"},{oldIcon:".sprTreeMemberGroup",newIcon:"icon-users"},{oldIcon:".sprTreeMemberType",newIcon:"icon-users"},{oldIcon:".sprTreeNewsletter",newIcon:"icon-file-text-alt"},{oldIcon:".sprTreePackage",newIcon:"icon-box"},{oldIcon:".sprTreeRepository",newIcon:"icon-server-alt"},{oldIcon:".sprTreeSettingDataType",newIcon:"icon-autofill"},{oldIcon:"folder.png",newIcon:"icon-folder"},{oldIcon:"mediaphoto.gif",newIcon:"icon-picture"},{oldIcon:"mediafile.gif",newIcon:"icon-document"},{oldIcon:".sprTreeDeveloperCacheItem",newIcon:"icon-box"},{oldIcon:".sprTreeDeveloperCacheTypes",newIcon:"icon-box"},{oldIcon:".sprTreeDeveloperMacro",newIcon:"icon-cogs"},{oldIcon:".sprTreeDeveloperRegistry",newIcon:"icon-windows"},{oldIcon:".sprTreeDeveloperPython",newIcon:"icon-linux"}];var imageConverter=[{oldImage:"contour.png",newIcon:"icon-umb-contour"}];var collectedIcons;return{formatContentTypeThumbnails:function(contentTypes){for(var i=0;i<contentTypes.length;i++){if(contentTypes[i].thumbnailIsClass===undefined||contentTypes[i].thumbnailIsClass){contentTypes[i].cssClass=this.convertFromLegacyIcon(contentTypes[i].thumbnail);}else{contentTypes[i].style="background-image: url('"+contentTypes[i].thumbnailFilePath+"');height:36px; background-position:4px 0px; background-repeat: no-repeat;background-size: 35px 35px;";contentTypes[i].cssClass="custom-file";}}
return contentTypes;},formatContentTypeIcons:function(contentTypes){for(var i=0;i<contentTypes.length;i++){contentTypes[i].icon=this.convertFromLegacyIcon(contentTypes[i].icon);if(contentTypes[i].icon.indexOf(".")>0){contentTypes[i].icon="icon-document-dashed-line";}}
return contentTypes;},isFileBasedIcon:function(icon){if(icon.startsWith('..')||(!icon.startsWith('.')&&icon.indexOf('.')>1)){return true;}
return false;},isLegacyIcon:function(icon){if(icon.startsWith('..')){return false;}
if(icon.startsWith('.')){return true;}
return false;},isLegacyTreeNodeIcon:function(treeNode){if(treeNode.iconIsClass){return this.isLegacyIcon(treeNode.icon);}
return false;},getIcons:function(){var deferred=$q.defer();$timeout(function(){if(collectedIcons){deferred.resolve(collectedIcons);}else{collectedIcons=[];var c=".icon-";for(var i=document.styleSheets.length-1;i>=0;i--){var classes=document.styleSheets[i].rules||document.styleSheets[i].cssRules;if(classes!==null){for(var x=0;x<classes.length;x++){var cur=classes[x];if(cur.selectorText&&cur.selectorText.indexOf(c)===0){var s=cur.selectorText.substring(1);var hasSpace=s.indexOf(" ");if(hasSpace>0){s=s.substring(0,hasSpace);}
var hasPseudo=s.indexOf(":");if(hasPseudo>0){s=s.substring(0,hasPseudo);}
if(collectedIcons.indexOf(s)<0){collectedIcons.push(s);}}}}}
deferred.resolve(collectedIcons);}},100);return deferred.promise;},convertFromLegacyIcon:function(icon){if(this.isLegacyIcon(icon)){var found=_.find(converter,function(item){return item.oldIcon.toLowerCase()===icon.toLowerCase();});return(found?found.newIcon:icon);}
return icon;},convertFromLegacyImage:function(icon){var found=_.find(imageConverter,function(item){return item.oldImage.toLowerCase()===icon.toLowerCase();});return(found?found.newIcon:undefined);},convertFromLegacyTreeNodeIcon:function(treeNode){if(this.isLegacyTreeNodeIcon(treeNode)){return this.convertFromLegacyIcon(treeNode.icon);}
return treeNode.icon;}};}
angular.module('umbraco.services').factory('iconHelper',iconHelper);function imageHelper(umbRequestHelper,mediaHelper){return{getImagePropertyValue:function(options){return mediaHelper.getImagePropertyValue(options);},getThumbnail:function(options){return mediaHelper.getThumbnail(options);},scaleToMaxSize:function(maxSize,width,height){return mediaHelper.scaleToMaxSize(maxSize,width,height);},getThumbnailFromPath:function(imagePath){return mediaHelper.getThumbnailFromPath(imagePath);},detectIfImageByExtension:function(imagePath){return mediaHelper.detectIfImageByExtension(imagePath);}};}
angular.module('umbraco.services').factory('imageHelper',imageHelper);angular.module('umbraco.services').factory('keyboardService',['$window','$timeout',function($window,$timeout){var keyboardManagerService={};var defaultOpt={'type':'keydown','propagate':false,'inputDisabled':false,'target':$window.document,'keyCode':false};var isMac=navigator.platform.toUpperCase().indexOf('MAC')>=0;keyboardManagerService.keyboardEvent={};keyboardManagerService.bind=function(label,callback,opt){if(isMac&&label!=="ctrl+space"){label=label.replace("ctrl","meta");}
keyboardManagerService.unbind(label);var fct,elt,code,k;opt=angular.extend({},defaultOpt,opt);label=label.toLowerCase();elt=opt.target;if(typeof opt.target==='string'){elt=document.getElementById(opt.target);}
fct=function(e){e=e||$window.event;if(opt['inputDisabled']){var elt;if(e.target){elt=e.target;}else if(e.srcElement){elt=e.srcElement;}
if(elt.nodeType===3){elt=elt.parentNode;}
if(elt.tagName==='INPUT'||elt.tagName==='TEXTAREA'){return;}}
if(e.keyCode){code=e.keyCode;}else if(e.which){code=e.which;}
var character=String.fromCharCode(code).toLowerCase();if(code===188){character=",";}
if(code===190){character=".";}
var keys=label.split("+");var kp=0;var shift_nums={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":"\"",",":"<",".":">","/":"?","\\":"|"};var special_keys={'esc':27,'escape':27,'tab':9,'space':32,'return':13,'enter':13,'backspace':8,'scrolllock':145,'scroll_lock':145,'scroll':145,'capslock':20,'caps_lock':20,'caps':20,'numlock':144,'num_lock':144,'num':144,'pause':19,'break':19,'insert':45,'home':36,'delete':46,'end':35,'pageup':33,'page_up':33,'pu':33,'pagedown':34,'page_down':34,'pd':34,'left':37,'up':38,'right':39,'down':40,'f1':112,'f2':113,'f3':114,'f4':115,'f5':116,'f6':117,'f7':118,'f8':119,'f9':120,'f10':121,'f11':122,'f12':123};var modifiers={shift:{wanted:false,pressed:e.shiftKey?true:false},ctrl:{wanted:false,pressed:e.ctrlKey?true:false},alt:{wanted:false,pressed:e.altKey?true:false},meta:{wanted:false,pressed:e.metaKey?true:false}};var l=keys.length;for(var i=0;i<l;i++){var k=keys[i];switch(k){case'ctrl':case'control':kp++;modifiers.ctrl.wanted=true;break;case'shift':case'alt':case'meta':kp++;modifiers[k].wanted=true;break;}
if(k.length>1){if(special_keys[k]===code){kp++;}}else if(opt['keyCode']){if(opt['keyCode']===code){kp++;}}else{if(character===k){kp++;}else{if(shift_nums[character]&&e.shiftKey){character=shift_nums[character];if(character===k){kp++;}}}}}
if(kp===keys.length&&modifiers.ctrl.pressed===modifiers.ctrl.wanted&&modifiers.shift.pressed===modifiers.shift.wanted&&modifiers.alt.pressed===modifiers.alt.wanted&&modifiers.meta.pressed===modifiers.meta.wanted){$timeout(function(){callback(e);},1);if(!opt['propagate']){e.cancelBubble=true;e.returnValue=false;if(e.stopPropagation){e.stopPropagation();e.preventDefault();}
return false;}}};keyboardManagerService.keyboardEvent[label]={'callback':fct,'target':elt,'event':opt['type']};if(elt.addEventListener){elt.addEventListener(opt['type'],fct,false);}else if(elt.attachEvent){elt.attachEvent('on'+opt['type'],fct);}else{elt['on'+opt['type']]=fct;}};keyboardManagerService.unbind=function(label){label=label.toLowerCase();var binding=keyboardManagerService.keyboardEvent[label];delete(keyboardManagerService.keyboardEvent[label]);if(!binding){return;}
var type=binding['event'],elt=binding['target'],callback=binding['callback'];if(elt.detachEvent){elt.detachEvent('on'+type,callback);}else if(elt.removeEventListener){elt.removeEventListener(type,callback,false);}else{elt['on'+type]=false;}};return keyboardManagerService;}]);angular.module('umbraco.services').factory('localizationService',function($http,$q,eventsService,$window,$filter,userService){var url="LocalizedText";var resourceFileLoadStatus="none";var resourceLoadingPromise=[];function _lookup(value,tokens,dictionary){if(value&&value[0]==="@"){value=value.substring(1);}
if(value&&value.indexOf("_")<0){value="general_"+value;}
var entry=dictionary[value];if(entry){if(tokens){for(var i=0;i<tokens.length;i++){entry=entry.replace("%"+i+"%",tokens[i]);}}
return entry;}
return"["+value+"]";}
var service={dictionary:[],initLocalizedResources:function(){var deferred=$q.defer();if(resourceFileLoadStatus==="loading"){resourceLoadingPromise.push(deferred);return deferred.promise;}
resourceFileLoadStatus="loading";$http({method:"GET",url:url,cache:false}).then(function(response){resourceFileLoadStatus="loaded";service.dictionary=response.data;eventsService.emit("localizationService.updated",response.data);deferred.resolve(response.data);for(var p in resourceLoadingPromise){resourceLoadingPromise[p].resolve(response.data);}},function(err){deferred.reject("Something broke");for(var p in resourceLoadingPromise){resourceLoadingPromise[p].reject("Something broke");}});return deferred.promise;},tokenize:function(value,scope){if(value){var localizer=value.split(':');var retval={tokens:undefined,key:localizer[0].substring(0)};if(localizer.length>1){retval.tokens=localizer[1].split(',');for(var x=0;x<retval.tokens.length;x++){retval.tokens[x]=scope.$eval(retval.tokens[x]);}}
return retval;}
return value;},localize:function(value,tokens){var deferred=$q.defer();if(resourceFileLoadStatus==="loaded"){var val=_lookup(value,tokens,service.dictionary);deferred.resolve(val);}else{service.initLocalizedResources().then(function(dic){var val=_lookup(value,tokens,dic);deferred.resolve(val);});}
return deferred.promise;},};service.initLocalizedResources();eventsService.on("app.authenticated",function(){resourceFileLoadStatus="none";resourceLoadingPromise=[];});return service;});function macroService(){return{parseMacroSyntax:function(syntax){var expression=/(<\?UMBRACO_MACRO macroAlias=["']([\w\.]+?)["'][\s\S]+?)(\/>|>.*?<\/\?UMBRACO_MACRO>)/i;var match=expression.exec(syntax);if(!match||match.length<3){return null;}
var alias=match[2];var paramsChunk=match[1].trim().replace(new RegExp("UMBRACO_MACRO macroAlias=[\"']"+alias+"[\"']"),"").trim();var paramExpression=/(\w+?)=['\"]([\s\S]*?)['\"]/g;var paramMatch;var returnVal={macroAlias:alias,macroParamsDictionary:{}};while(paramMatch=paramExpression.exec(paramsChunk)){returnVal.macroParamsDictionary[paramMatch[1]]=paramMatch[2];}
return returnVal;},generateMacroSyntax:function(args){var macroString='<?UMBRACO_MACRO macroAlias=\"'+args.macroAlias+"\" ";if(args.macroParamsDictionary){_.each(args.macroParamsDictionary,function(val,key){val=val?val:"";var keyVal;if(angular.isString(val)){keyVal=key+"=\""+(val?val:"")+"\" ";}
else{var json=angular.toJson(val);var encoded=encodeURIComponent(json);keyVal=key+"=\""+encoded+"\" ";}
macroString+=keyVal;});}
macroString+="/>";return macroString;},generateWebFormsSyntax:function(args){var macroString='<umbraco:Macro ';if(args.macroParamsDictionary){_.each(args.macroParamsDictionary,function(val,key){var keyVal=key+"=\""+(val?val:"")+"\" ";macroString+=keyVal;});}
macroString+="Alias=\""+args.macroAlias+"\" runat=\"server\"></umbraco:Macro>";return macroString;},generateMvcSyntax:function(args){var macroString="@Umbraco.RenderMacro(\""+args.macroAlias+"\"";var hasParams=false;var paramString;if(args.macroParamsDictionary){paramString=", new {";_.each(args.macroParamsDictionary,function(val,key){hasParams=true;var keyVal=key+"=\""+(val?val:"")+"\", ";paramString+=keyVal;});paramString=paramString.trimEnd(", ");paramString+="}";}
if(hasParams){macroString+=paramString;}
macroString+=")";return macroString;}};}
angular.module('umbraco.services').factory('macroService',macroService);function mediaHelper(umbRequestHelper){var _mediaFileResolvers={};return{getMediaPropertyValue:function(options){if(!options||!options.mediaModel){throw"The options objet does not contain the required parameters: mediaModel";}
var props=[];if(options.mediaModel.properties){props=options.mediaModel.properties;}else{$(options.mediaModel.tabs).each(function(i,tab){props=props.concat(tab.properties);});}
var mediaRoot=Umbraco.Sys.ServerVariables.umbracoSettings.mediaPath;var imageProp=_.find(props,function(item){if(item.alias==="umbracoFile"){return true;}
if(angular.isString(item.value)&&item.value.indexOf(mediaRoot)===0){return true;}
return false;});if(!imageProp){return"";}
var mediaVal;var split=imageProp.value.split(',');var self=this;mediaVal=_.map(split,function(item){return{file:item,isImage:self.detectIfImageByExtension(item)};});if(mediaVal.length&&mediaVal.length>0){if(!options.imageOnly||(options.imageOnly===true&&mediaVal[0].isImage)){return mediaVal[0].file;}}
return"";},getImagePropertyValue:function(options){if(!options||(!options.imageModel&&!options.mediaModel)){throw"The options objet does not contain the required parameters: imageModel";}
options.mediaModel=options.imageModel?options.imageModel:options.mediaModel;options.imageOnly=true;return this.getMediaPropertyValue(options);},getThumbnail:function(options){if(!options||!options.imageModel){throw"The options objet does not contain the required parameters: imageModel";}
var imagePropVal=this.getImagePropertyValue(options);if(imagePropVal!==""){return this.getThumbnailFromPath(imagePropVal);}
return"";},registerFileResolver:function(propertyEditorAlias,func){_mediaFileResolvers[propertyEditorAlias]=func;},resolveFileFromEntity:function(mediaEntity,thumbnail){if(!angular.isObject(mediaEntity.metaData)){throw"Cannot resolve the file url from the mediaEntity, it does not contain the required metaData";}
var values=_.values(mediaEntity.metaData);for(var i=0;i<values.length;i++){var val=values[i];if(angular.isObject(val)&&val.PropertyEditorAlias){for(var resolver in _mediaFileResolvers){if(val.PropertyEditorAlias===resolver){var property={value:val.Value};return _mediaFileResolvers[resolver](property,mediaEntity,thumbnail);}}}}
return"";},resolveFile:function(mediaItem,thumbnail){function iterateProps(props){var res=null;for(var resolver in _mediaFileResolvers){var property=_.find(props,function(prop){return prop.editor===resolver;});if(property){res=_mediaFileResolvers[resolver](property,mediaItem,thumbnail);break;}}
return res;}
var result="";if(mediaItem.properties){result=iterateProps(mediaItem.properties);}else if(mediaItem.tabs){for(var tab in mediaItem.tabs){if(mediaItem.tabs[tab].properties){result=iterateProps(mediaItem.tabs[tab].properties);if(result){break;}}}}
return result;},hasFilePropertyType:function(mediaItem){function iterateProps(props){var res=false;for(var resolver in _mediaFileResolvers){var property=_.find(props,function(prop){return prop.editor===resolver;});if(property){res=true;break;}}
return res;}
var result=false;if(mediaItem.properties){result=iterateProps(mediaItem.properties);}else if(mediaItem.tabs){for(var tab in mediaItem.tabs){if(mediaItem.tabs[tab].properties){result=iterateProps(mediaItem.tabs[tab].properties);if(result){break;}}}}
return result;},scaleToMaxSize:function(maxSize,width,height){var retval={width:width,height:height};var maxWidth=maxSize;var maxHeight=maxSize;var ratio=0;if(width>maxWidth){ratio=maxWidth/width;retval.width=maxWidth;retval.height=height*ratio;height=height*ratio;width=width*ratio;}
if(height>maxHeight){ratio=maxHeight/height;retval.height=maxHeight;retval.width=width*ratio;width=width*ratio;}
return retval;},getThumbnailFromPath:function(imagePath){if(!this.detectIfImageByExtension(imagePath)){return null;}
var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:imagePath}]);return thumbnailUrl;},detectIfImageByExtension:function(imagePath){var lowered=imagePath.toLowerCase();var ext=lowered.substr(lowered.lastIndexOf(".")+1);return(","+Umbraco.Sys.ServerVariables.umbracoSettings.imageFileTypes+",").indexOf(","+ext+",")!==-1;}};}
angular.module('umbraco.services').factory('mediaHelper',mediaHelper);function umbracoMenuActions($q,treeService,$location,navigationService,appState){return{"RefreshNode":function(args){var treeRoot=appState.getTreeState("currentRootNode");if(treeRoot&&treeRoot.root){var treeNode=treeService.getDescendantNode(treeRoot.root,args.entity.id,args.treeAlias);if(treeNode){treeService.loadNodeChildren({node:treeNode,section:args.section});}}},"CreateChildEntity":function(args){navigationService.hideNavigation();var route="/"+args.section+"/"+args.treeAlias+"/edit/"+args.entity.id;$location.path(route).search({create:true});}};}
angular.module('umbraco.services').factory('umbracoMenuActions',umbracoMenuActions);function navigationService($rootScope,$routeParams,$log,$location,$q,$timeout,$injector,dialogService,umbModelMapper,treeService,notificationsService,historyService,appState,angularHelper){var minScreenSize=1100;var currentDialog=null;var isTablet=false;var mainTreeEventHandler=null;var userDialog=null;function setTreeMode(){isTablet=($(window).width()<=minScreenSize);appState.setGlobalState("showNavigation",!isTablet);}
function setMode(mode){switch(mode){case'tree':appState.setGlobalState("navMode","tree");appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",false);appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showTray",false);break;case'menu':appState.setGlobalState("navMode","menu");appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",true);appState.setMenuState("showMenuDialog",false);appState.setGlobalState("stickyNavigation",true);break;case'dialog':appState.setGlobalState("navMode","dialog");appState.setGlobalState("stickyNavigation",true);appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",true);break;case'search':appState.setGlobalState("navMode","search");appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setSectionState("showSearchResults",true);appState.setMenuState("showMenuDialog",false);$timeout(function(){$("#search-field").focus();});break;default:appState.setGlobalState("navMode","default");appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",false);appState.setSectionState("showSearchResults",false);appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showTray",false);if(isTablet){appState.setGlobalState("showNavigation",false);}
break;}}
var service={init:function(){setTreeMode();$rootScope.$watch(function(){return $routeParams.section;},function(newVal,oldVal){appState.setSectionState("currentSection",newVal);});$(window).bind("resize",function(){setTreeMode();});},loadLegacyIFrame:function(source){$location.path("/"+appState.getSectionState("currentSection")+"/framed/"+encodeURIComponent(source));},changeSection:function(sectionAlias,force){setMode("default-opensection");if(force&&appState.getSectionState("currentSection")===sectionAlias){appState.setSectionState("currentSection","");}
appState.setSectionState("currentSection",sectionAlias);this.showTree(sectionAlias);$location.path(sectionAlias);},showTree:function(sectionAlias,syncArgs){if(sectionAlias!==appState.getSectionState("currentSection")){appState.setSectionState("currentSection",sectionAlias);if(syncArgs){this.syncTree(syncArgs);}}
setMode("tree");},showTray:function(){appState.setGlobalState("showTray",true);},hideTray:function(){appState.setGlobalState("showTray",false);},setupTreeEvents:function(treeEventHandler){mainTreeEventHandler=treeEventHandler;mainTreeEventHandler.bind("treeLoaded",function(ev,args){appState.setTreeState("currentRootNode",args.tree);});mainTreeEventHandler.bind("treeSynced",function(ev,args){if(args.activate===undefined||args.activate===true){appState.setTreeState("selectedNode",args.node);appState.setMenuState("currentNode",args.node);}});mainTreeEventHandler.bind("treeOptionsClick",function(ev,args){ev.stopPropagation();ev.preventDefault();appState.setMenuState("currentNode",args.node);if(args.event&&args.event.altKey){args.skipDefault=true;}
service.showMenu(ev,args);});mainTreeEventHandler.bind("treeNodeAltSelect",function(ev,args){ev.stopPropagation();ev.preventDefault();args.skipDefault=true;service.showMenu(ev,args);});mainTreeEventHandler.bind("treeNodeSelect",function(ev,args){var n=args.node;ev.stopPropagation();ev.preventDefault();if(n.metaData&&n.metaData["jsClickCallback"]&&angular.isString(n.metaData["jsClickCallback"])&&n.metaData["jsClickCallback"]!==""){var jsPrefix="javascript:";var js;if(n.metaData["jsClickCallback"].startsWith(jsPrefix)){js=n.metaData["jsClickCallback"].substr(jsPrefix.length);}
else{js=n.metaData["jsClickCallback"];}
try{var func=eval(js);if(func!=null&&(typeof func==="function")){func.call();}}
catch(ex){$log.error("Error evaluating js callback from legacy tree node: "+ex);}}
else if(n.routePath){historyService.add({name:n.name,link:n.routePath,icon:n.icon});appState.setTreeState("selectedNode",args.node);appState.setMenuState("currentNode",args.node);$location.path(n.routePath).search("");}
else if(args.element.section){$location.path(args.element.section).search("");}
service.hideNavigation();});},syncTree:function(args){if(!args){throw"args cannot be null";}
if(!args.path){throw"args.path cannot be null";}
if(!args.tree){throw"args.tree cannot be null";}
if(mainTreeEventHandler){return mainTreeEventHandler.syncTree(args);}
return angularHelper.rejectedPromise();},_syncPath:function(path,forceReload){if(mainTreeEventHandler){mainTreeEventHandler.syncTree({path:path,forceReload:forceReload});}},reloadNode:function(node){if(mainTreeEventHandler){mainTreeEventHandler.reloadNode(node);}},reloadSection:function(sectionAlias){if(mainTreeEventHandler){mainTreeEventHandler.clearCache({section:sectionAlias});mainTreeEventHandler.load(sectionAlias);}},_setActiveTreeType:function(treeAlias,loadChildren){if(mainTreeEventHandler){mainTreeEventHandler._setActiveTreeType(treeAlias,loadChildren);}},hideTree:function(){if(isTablet&&!appState.getGlobalState("stickyNavigation")){appState.setSectionState("currentSection",$routeParams.section);setMode("default-hidesectiontree");}},showMenu:function(event,args){var deferred=$q.defer();var self=this;treeService.getMenu({treeNode:args.node}).then(function(data){if(data.defaultAlias&&!args.skipDefault){var found=_.find(data.menuItems,function(item){return item.alias=data.defaultAlias;});if(found){appState.setMenuState("currentNode",args.node);if(currentDialog){dialogService.close(currentDialog);}
var dialog=self.showDialog({node:args.node,action:found,section:appState.getSectionState("currentSection")});deferred.resolve(dialog);return;}}
setMode("menu");appState.setMenuState("currentNode",args.node);appState.setMenuState("menuActions",data.menuItems);appState.setMenuState("dialogTitle",args.node.name);deferred.resolve(null);});return deferred.promise;},hideMenu:function(){appState.setMenuState("currentNode",null);appState.setMenuState("menuActions",[]);setMode("tree");},executeMenuAction:function(action,node,section){if(!action){throw"action cannot be null";}
if(!node){throw"node cannot be null";}
if(!section){throw"section cannot be null";}
if(action.metaData&&action.metaData["actionRoute"]&&angular.isString(action.metaData["actionRoute"])){var parts=action.metaData["actionRoute"].split("?");$location.path(parts[0]).search(parts.length>1?parts[1]:"");this.hideNavigation();return;}
else if(action.metaData&&action.metaData["jsAction"]&&angular.isString(action.metaData["jsAction"])){var menuAction=action.metaData["jsAction"].split('.');if(menuAction.length!==2){var js=action.metaData["jsAction"].replace("javascript:","");eval(js);}
else{var menuActionService=$injector.get(menuAction[0]);if(!menuActionService){throw"The angular service "+menuAction[0]+" could not be found";}
var method=menuActionService[menuAction[1]];if(!method){throw"The method "+menuAction[1]+" on the angular service "+menuAction[0]+" could not be found";}
method.apply(this,[{entity:umbModelMapper.convertToEntityBasic(node),action:action,section:section,treeAlias:treeService.getTreeAlias(node)}]);}}
else{service.showDialog({node:node,action:action,section:section});}},showUserDialog:function(){if(userDialog){userDialog.close();userDialog=null;}
userDialog=dialogService.open({template:"views/common/dialogs/user.html",modalClass:"umb-modal-left",show:true});return userDialog;},showHelpDialog:function(){if(service.helpDialog){service.helpDialog.close();service.helpDialog=undefined;}
service.helpDialog=dialogService.open({template:"views/common/dialogs/help.html",modalClass:"umb-modal-left",show:true});return service.helpDialog;},showDialog:function(args){if(!args){throw"showDialog is missing the args parameter";}
if(!args.action){throw"The args parameter must have an 'action' property as the clicked menu action object";}
if(!args.node){throw"The args parameter must have a 'node' as the active tree node";}
if(currentDialog){dialogService.close(currentDialog);}
setMode("dialog");var dialogScope=args.scope?args.scope.$new():$rootScope.$new();dialogScope.currentNode=args.node;dialogScope.currentAction=args.action;if(args.action.metaData["dialogTitle"]){appState.setMenuState("dialogTitle",args.action.metaData["dialogTitle"]);}
else{appState.setMenuState("dialogTitle",args.action.name);}
var templateUrl;var iframe;if(args.action.metaData["actionUrl"]){templateUrl=args.action.metaData["actionUrl"];iframe=true;}
else if(args.action.metaData["actionView"]){templateUrl=args.action.metaData["actionView"];iframe=false;}
else{var treeAlias=treeService.getTreeAlias(args.node);var packageTreeFolder=treeService.getTreePackageFolder(treeAlias);if(!treeAlias){throw"Could not get tree alias for node "+args.node.id;}
if(packageTreeFolder){templateUrl=Umbraco.Sys.ServerVariables.umbracoSettings.appPluginsPath+"/"+packageTreeFolder+"/backoffice/"+treeAlias+"/"+args.action.alias+".html";}
else{templateUrl="views/"+treeAlias+"/"+args.action.alias+".html";}
iframe=false;}
var dialog=dialogService.open({container:$("#dialog div.umb-modalcolumn-body"),scope:dialogScope,inline:true,show:true,iframe:iframe,modalClass:"umb-dialog",template:templateUrl,currentNode:args.node,currentAction:args.action,});currentDialog=dialog;return dialog;},hideDialog:function(showMenu){setMode("default");if(showMenu){this.showMenu(undefined,{skipDefault:true,node:appState.getMenuState("currentNode")});}},showSearch:function(){setMode("search");},hideSearch:function(){setMode("default-hidesearch");},hideNavigation:function(){appState.setMenuState("menuActions",[]);setMode("default");}};return service;}
angular.module('umbraco.services').factory('navigationService',navigationService);angular.module('umbraco.services').factory('notificationsService',function($rootScope,$timeout,angularHelper){var nArray=[];function setViewPath(view){if(view.indexOf('/')<0)
{view="views/common/notifications/"+view;}
if(view.indexOf('.html')<0)
{view=view+".html";}
return view;}
var service={add:function(item){angularHelper.safeApply($rootScope,function(){if(item.view){item.view=setViewPath(item.view);item.sticky=true;item.type="form";item.headline=null;}
if(item.message){item.headline+=": ";if(item.message.length>200){item.sticky=true;}}
item.id=String.CreateGuid();nArray.push(item);if(!item.sticky){$timeout(function(){var found=_.find(nArray,function(i){return i.id===item.id;});if(found){var index=nArray.indexOf(found);nArray.splice(index,1);}},7000);}
return item;});},hasView:function(view){if(!view){return _.find(nArray,function(notification){return notification.view;});}else{view=setViewPath(view).toLowerCase();return _.find(nArray,function(notification){return notification.view.toLowerCase()===view;});}},addView:function(view,args){var item={args:args,view:view};service.add(item);},showNotification:function(args){if(!args){throw"args cannot be null";}
if(args.type===undefined||args.type===null){throw"args.type cannot be null";}
if(!args.header){throw"args.header cannot be null";}
switch(args.type){case 0:this.success(args.header,args.message);break;case 1:this.success(args.header,args.message);break;case 2:this.error(args.header,args.message);break;case 3:this.success(args.header,args.message);break;case 4:this.warning(args.header,args.message);break;}},success:function(headline,message){return service.add({headline:headline,message:message,type:'success',time:new Date()});},error:function(headline,message){return service.add({headline:headline,message:message,type:'error',time:new Date()});},warning:function(headline,message){return service.add({headline:headline,message:message,type:'warning',time:new Date()});},info:function(headline,message){return service.add({headline:headline,message:message,type:'info',time:new Date()});},remove:function(index){if(angular.isObject(index)){var i=nArray.indexOf(index);angularHelper.safeApply($rootScope,function(){nArray.splice(i,1);});}else{angularHelper.safeApply($rootScope,function(){nArray.splice(index,1);});}},removeAll:function(){angularHelper.safeApply($rootScope,function(){nArray=[];});},current:nArray,getCurrent:function(){return nArray;}};return service;});angular.module('umbraco.services').factory('searchService',function($q,$log,entityResource,contentResource,umbRequestHelper){function configureMemberResult(member){member.menuUrl=umbRequestHelper.getApiUrl("memberTreeBaseUrl","GetMenu",[{id:member.id},{application:'member'}]);member.editorPath="member/member/edit/"+(member.key?member.key:member.id);angular.extend(member.metaData,{treeAlias:"member"});member.subTitle=member.metaData.Email;}
function configureMediaResult(media)
{media.menuUrl=umbRequestHelper.getApiUrl("mediaTreeBaseUrl","GetMenu",[{id:media.id},{application:'media'}]);media.editorPath="media/media/edit/"+media.id;angular.extend(media.metaData,{treeAlias:"media"});}
function configureContentResult(content){content.menuUrl=umbRequestHelper.getApiUrl("contentTreeBaseUrl","GetMenu",[{id:content.id},{application:'content'}]);content.editorPath="content/content/edit/"+content.id;angular.extend(content.metaData,{treeAlias:"content"});content.subTitle=content.metaData.Url;}
return{searchMembers:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Member",args.searchFrom).then(function(data){_.each(data,function(item){configureMemberResult(item);});return data;});},searchContent:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Document",args.searchFrom,args.canceler).then(function(data){_.each(data,function(item){configureContentResult(item);});return data;});},searchMedia:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Media",args.searchFrom).then(function(data){_.each(data,function(item){configureMediaResult(item);});return data;});},searchAll:function(args){if(!args.term){throw"args.term is required";}
return entityResource.searchAll(args.term,args.canceler).then(function(data){_.each(data,function(resultByType){switch(resultByType.type){case"Document":_.each(resultByType.results,function(item){configureContentResult(item);});break;case"Media":_.each(resultByType.results,function(item){configureMediaResult(item);});break;case"Member":_.each(resultByType.results,function(item){configureMemberResult(item);});break;}});return data;});},setCurrent:function(sectionAlias){var currentSection=sectionAlias;}};});function serverValidationManager($timeout){var callbacks=[];function executeCallback(self,errorsForCallback,callback){callback.apply(self,[false,errorsForCallback,self.items]);}
function getFieldErrors(self,fieldName){if(!angular.isString(fieldName)){throw"fieldName must be a string";}
return _.filter(self.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});}
function getPropertyErrors(self,propertyAlias,fieldName){if(!angular.isString(propertyAlias)){throw"propertyAlias must be a string";}
if(fieldName&&!angular.isString(fieldName)){throw"fieldName must be a string";}
return _.filter(self.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});}
return{executeAndClearAllSubscriptions:function(){var self=this;$timeout(function(){for(var cb in callbacks){if(callbacks[cb].propertyAlias===null){var fieldErrors=getFieldErrors(self,callbacks[cb].fieldName);if(fieldErrors.length>0){executeCallback(self,fieldErrors,callbacks[cb].callback);}}
else{var propErrors=getPropertyErrors(self,callbacks[cb].propertyAlias,callbacks[cb].fieldName);if(propErrors.length>0){executeCallback(self,propErrors,callbacks[cb].callback);}}}
self.clear();});},subscribe:function(propertyAlias,fieldName,callback){if(!callback){return;}
if(propertyAlias===null){var exists1=_.find(callbacks,function(item){return item.propertyAlias===null&&item.fieldName===fieldName;});if(!exists1){callbacks.push({propertyAlias:null,fieldName:fieldName,callback:callback});}}
else if(propertyAlias!==undefined){var exists2=_.find(callbacks,function(item){return item.propertyAlias===propertyAlias&&item.fieldName===fieldName;});if(!exists2){callbacks.push({propertyAlias:propertyAlias,fieldName:fieldName,callback:callback});}}},unsubscribe:function(propertyAlias,fieldName){if(propertyAlias===null){callbacks=_.reject(callbacks,function(item){return item.propertyAlias===null&&item.fieldName===fieldName;});}
else if(propertyAlias!==undefined){callbacks=_.reject(callbacks,function(item){return item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||((item.fieldName===undefined||item.fieldName==="")&&(fieldName===undefined||fieldName==="")));});}},getPropertyCallbacks:function(propertyAlias,fieldName){var found=_.filter(callbacks,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(item.fieldName===undefined||item.fieldName==="")));});return found;},getFieldCallbacks:function(fieldName){var found=_.filter(callbacks,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return found;},addFieldError:function(fieldName,errorMsg){if(!fieldName){return;}
if(!this.hasFieldError(fieldName)){this.items.push({propertyAlias:null,fieldName:fieldName,errorMsg:errorMsg});}
var errorsForCallback=getFieldErrors(this,fieldName);var cbs=this.getFieldCallbacks(fieldName);for(var cb in cbs){executeCallback(this,errorsForCallback,cbs[cb].callback);}},addPropertyError:function(propertyAlias,fieldName,errorMsg){if(!propertyAlias){return;}
if(!this.hasPropertyError(propertyAlias,fieldName)){this.items.push({propertyAlias:propertyAlias,fieldName:fieldName,errorMsg:errorMsg});}
var errorsForCallback=getPropertyErrors(this,propertyAlias,fieldName);var cbs=this.getPropertyCallbacks(propertyAlias,fieldName);for(var cb in cbs){executeCallback(this,errorsForCallback,cbs[cb].callback);}},removePropertyError:function(propertyAlias,fieldName){if(!propertyAlias){return;}
this.items=_.reject(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});},reset:function(){this.clear();for(var cb in callbacks){callbacks[cb].callback.apply(this,[true,[],[]]);}},clear:function(){this.items=[];},getPropertyError:function(propertyAlias,fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});return err;},getFieldError:function(fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return err;},hasPropertyError:function(propertyAlias,fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});return err?true:false;},hasFieldError:function(fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return err?true:false;},items:[]};}
angular.module('umbraco.services').factory('serverValidationManager',serverValidationManager);function tinyMceService(dialogService,$log,imageHelper,$http,$timeout,macroResource,macroService,$routeParams,umbRequestHelper,angularHelper,userService){return{configuration:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("rteApiBaseUrl","GetConfiguration"),{cache:true}),'Failed to retrieve tinymce configuration');},defaultPrevalues:function(){var cfg={};cfg.toolbar=["code","bold","italic","styleselect","alignleft","aligncenter","alignright","bullist","numlist","outdent","indent","link","image","umbmediapicker","umbembeddialog","umbmacro"];cfg.stylesheets=[];cfg.dimensions={height:500};cfg.maxImageSize=500;return cfg;},createInsertEmbeddedMedia:function(editor,$scope){editor.addButton('umbembeddialog',{icon:'custom icon-tv',tooltip:'Embed',onclick:function(){dialogService.embedDialog({callback:function(data){editor.insertContent(data);}});}});},createMediaPicker:function(editor){editor.addButton('umbmediapicker',{icon:'custom icon-picture',tooltip:'Media Picker',onclick:function(){var selectedElm=editor.selection.getNode(),currentTarget;if(selectedElm.nodeName==='IMG'){var img=$(selectedElm);currentTarget={altText:img.attr("alt"),url:img.attr("src"),id:img.attr("rel")};}
userService.getCurrentUser().then(function(userData){dialogService.mediaPicker({currentTarget:currentTarget,onlyImages:true,showDetails:true,startNodeId:userData.startMediaId,callback:function(img){if(img){var data={alt:img.altText||"",src:(img.url)?img.url:"nothing.jpg",rel:img.id,id:'__mcenew'};editor.insertContent(editor.dom.createHTML('img',data));$timeout(function(){var imgElm=editor.dom.get('__mcenew');var size=editor.dom.getSize(imgElm);if(editor.settings.maxImageSize&&editor.settings.maxImageSize!==0){var newSize=imageHelper.scaleToMaxSize(editor.settings.maxImageSize,size.w,size.h);var s="width: "+newSize.width+"px; height:"+newSize.height+"px;";editor.dom.setAttrib(imgElm,'style',s);editor.dom.setAttrib(imgElm,'id',null);if(img.url){var src=img.url+"?width="+newSize.width+"&height="+newSize.height;editor.dom.setAttrib(imgElm,'data-mce-src',src);}}},500);}}});});}});},createInsertMacro:function(editor,$scope){editor.on('preInit',function(args){editor.serializer.addRules('div');editor.serializer.addNodeFilter('div',function(nodes,name){for(var i=0;i<nodes.length;i++){if(nodes[i].attr("class")==="umb-macro-holder"&&nodes[i].parent&&nodes[i].parent.name.toUpperCase()==="P"){nodes[i].parent.unwrap();}}});});function getRealMacroElem(element){var e=$(element).closest(".umb-macro-holder");if(e.length>0){if(e.get(0).parentNode.nodeName==="P"){if(element.parentNode.childNodes.length===1){return e.get(0).parentNode;}}
return e.get(0);}
return null;}
function loadMacroContent($macroDiv,macroData){if(!macroData){var contents=$macroDiv.contents();var comment=_.find(contents,function(item){return item.nodeType===8;});if(!comment){throw"Cannot parse the current macro, the syntax in the editor is invalid";}
var syntax=comment.textContent.trim();var parsed=macroService.parseMacroSyntax(syntax);macroData=parsed;}
var $ins=$macroDiv.find("ins");$macroDiv.addClass("loading");var contentId=$routeParams.id;angularHelper.safeApply($scope,function(){macroResource.getMacroResultAsHtmlForEditor(macroData.macroAlias,contentId,macroData.macroParamsDictionary).then(function(htmlResult){$macroDiv.removeClass("loading");htmlResult=htmlResult.trim();if(htmlResult!==""){$ins.html(htmlResult);}});});}
editor.addButton('umbmacro',{icon:'custom icon-settings-alt',tooltip:'Insert macro',onPostRender:function(){var ctrl=this;var isOnMacroElement=false;function handleSelectionChange(){if(!editor.selection.isCollapsed()){var endSelection=tinymce.activeEditor.selection.getEnd();var startSelection=tinymce.activeEditor.selection.getStart();if(endSelection!==startSelection){var $testForMacro=$(endSelection).closest(".umb-macro-holder");if($testForMacro.length>0){var next=$testForMacro.next();if(next.length>0){editor.selection.setCursorLocation($testForMacro.next().get(0));}
else{selectMacroElement($testForMacro.get(0));}}}}}
function selectMacroElement(macroElement){editor.selection.select(macroElement);var currentSelection=editor.selection.getStart();if(tinymce.isIE){if(!editor.dom.hasClass(currentSelection,'umb-macro-holder')){while(!editor.dom.hasClass(currentSelection,'umb-macro-holder')&&currentSelection.parentNode){currentSelection=currentSelection.parentNode;}
editor.selection.select(currentSelection);}}}
function onNodeChanged(evt){var $macroElement=$(evt.element).closest(".umb-macro-holder");handleSelectionChange();ctrl.active($macroElement.length!==0);if($macroElement.length>0){var macroElement=$macroElement.get(0);editor.off('NodeChange',onNodeChanged);selectMacroElement(macroElement);isOnMacroElement=true;editor.on('NodeChange',onNodeChanged);}
else{isOnMacroElement=false;}}
editor.on("LoadContent",function(o){$(editor.dom.select(".umb-macro-holder.mceNonEditable")).each(function(){loadMacroContent($(this));});});editor.on('BeforeExecCommand',function(o){if(isOnMacroElement){if(o.preventDefault){o.preventDefault();}
if(o.stopImmediatePropagation){o.stopImmediatePropagation();}
return;}});editor.on("Paste",function(o){if(isOnMacroElement){if(o.preventDefault){o.preventDefault();}
if(o.stopImmediatePropagation){o.stopImmediatePropagation();}
return;}});editor.on('NodeChange',onNodeChanged);editor.on('KeyDown',function(e){if(isOnMacroElement){var macroElement=editor.selection.getNode();macroElement=getRealMacroElem(macroElement);e.preventDefault();e.stopPropagation();var moveSibling=function(element,isNext){var $e=$(element);var $sibling=isNext?$e.next():$e.prev();if($sibling.length>0){editor.selection.select($sibling.get(0));editor.selection.collapse(true);}
else{if(!isNext){moveSibling(element,true);return;}
editor.setContent(editor.getContent()+"<p>&nbsp;</p>");editor.selection.select($(editor.dom.getRoot()).children().last().get(0));editor.selection.collapse(true);}};if($.inArray(e.keyCode,[13,40,39])!==-1){moveSibling(macroElement,true);}
else if($.inArray(e.keyCode,[27,38,37])!==-1){moveSibling(macroElement,false);}
else if($.inArray(e.keyCode,[8,46])!==-1){moveSibling(macroElement,false);editor.dom.remove(macroElement);}
return;}});},onclick:function(){var dialogData={richTextEditor:true};var macroElement=editor.selection.getNode();macroElement=getRealMacroElem(macroElement);if(macroElement){var contents=$(macroElement).contents();var comment=_.find(contents,function(item){return item.nodeType===8;});if(!comment){throw"Cannot parse the current macro, the syntax in the editor is invalid";}
var syntax=comment.textContent.trim();var parsed=macroService.parseMacroSyntax(syntax);dialogData={macroData:parsed};}
dialogService.macroPicker({dialogData:dialogData,callback:function(data){var macroSyntaxComment="<!-- "+data.syntax+" -->";var uniqueId="umb-macro-"+editor.dom.uniqueId();var macroDiv=editor.dom.create('div',{'class':'umb-macro-holder '+data.macroAlias+' mceNonEditable '+uniqueId},macroSyntaxComment+'<ins>Macro alias: <strong>'+data.macroAlias+'</strong></ins>');editor.selection.setNode(macroDiv);var $macroDiv=$(editor.dom.select("div.umb-macro-holder."+uniqueId));loadMacroContent($macroDiv,data);}});}});}};}
angular.module('umbraco.services').factory('tinyMceService',tinyMceService);function treeService($q,treeResource,iconHelper,notificationsService,eventsService){var treeCache={};var standardCssClass='icon umb-tree-icon sprTree';function getCacheKey(args){if(!args||!args.cacheKey){return null;}
var cacheKey=args.cacheKey;cacheKey+="_"+args.section;return cacheKey;}
return{_getTreeCache:function(){return treeCache;},_formatNodeDataForUseInUI:function(parentNode,treeNodes,section,level){var childLevel=(level?level:1);if(!parentNode.section){parentNode.section=section;}
var funcParent=function(){return parentNode;};for(var i=0;i<treeNodes.length;i++){treeNodes[i].level=childLevel;treeNodes[i].parent=funcParent;treeNodes[i].section=section;if(!treeNodes[i].routePath){if(treeNodes[i].metaData&&treeNodes[i].metaData["treeAlias"]){treeNodes[i].routePath=section;}
else{var treeAlias=this.getTreeAlias(treeNodes[i]);treeNodes[i].routePath=section+"/"+treeAlias+"/edit/"+treeNodes[i].id;}}
if(treeNodes[i].iconIsClass===undefined||treeNodes[i].iconIsClass){var converted=iconHelper.convertFromLegacyTreeNodeIcon(treeNodes[i]);treeNodes[i].cssClass=standardCssClass+" "+converted;if(converted.startsWith('.')){treeNodes[i].style="height:16px;width:16px;";}
else{treeNodes[i].style="";}}
else{treeNodes[i].style="background-image: url('"+treeNodes[i].iconFilePath+"');";treeNodes[i].cssClass=standardCssClass+" legacy-custom-file";}}},getTreePackageFolder:function(treeAlias){if(Umbraco.Sys.ServerVariables.umbracoPlugins&&Umbraco.Sys.ServerVariables.umbracoPlugins.trees&&angular.isArray(Umbraco.Sys.ServerVariables.umbracoPlugins.trees)){var found=_.find(Umbraco.Sys.ServerVariables.umbracoPlugins.trees,function(item){return item.alias===treeAlias;});return found?found.packageFolder:undefined;}
return undefined;},clearCache:function(args){if(!args){treeCache={};}
else{if(args.section&&args.cacheKey){var cacheKey=getCacheKey(args);if(cacheKey&&treeCache&&treeCache[cacheKey]!=null){treeCache=_.omit(treeCache,cacheKey);}}
else if(args.childrenOf){if(!args.cacheKey){throw"args.cacheKey is required if args.childrenOf is supplied";}
var self=this;this.clearCache({cacheKey:args.cacheKey,filter:function(cc){var parent=self.getDescendantNode(cc.root,args.childrenOf);if(parent){parent.children=null;parent.expanded=false;}
return cc;}});}
else if(args.filter&&angular.isFunction(args.filter)){if(!args.cacheKey){throw"args.cacheKey is required if args.filter is supplied";}
var byKey=treeCache[args.cacheKey];if(byKey){var result=args.filter(byKey);if(result){treeCache[args.cacheKey]=result;}
else{treeCache=_.omit(treeCache,args.cacheKey);}}}
else if(args.cacheKey){var allKeys1=_.keys(treeCache);var toRemove1=_.filter(allKeys1,function(k){return k.startsWith(args.cacheKey+"_");});treeCache=_.omit(treeCache,toRemove1);}
else if(args.section){var allKeys2=_.keys(treeCache);var toRemove2=_.filter(allKeys2,function(k){return k.endsWith("_"+args.section);});treeCache=_.omit(treeCache,toRemove2);}}},loadNodeChildren:function(args){if(!args){throw"No args object defined for loadNodeChildren";}
if(!args.node){throw"No node defined on args object for loadNodeChildren";}
this.removeChildNodes(args.node);args.node.loading=true;return this.getChildren(args).then(function(data){args.node.loading=false;args.node.children=data;if(args.node.children&&args.node.children.length>0){args.node.expanded=true;args.node.hasChildren=true;}
return data;},function(reason){eventsService.emit("treeService.treeNodeLoadError",{error:reason});args.node.loading=false;notificationsService.error(reason);return reason;});},removeNode:function(treeNode){if(!angular.isFunction(treeNode.parent)){return;}
if(treeNode.parent()==null){throw"Cannot remove a node that doesn't have a parent";}
treeNode.parent().children.splice(treeNode.parent().children.indexOf(treeNode),1);},removeChildNodes:function(treeNode){treeNode.expanded=false;treeNode.children=[];treeNode.hasChildren=false;},getChildNode:function(treeNode,id){if(!treeNode.children){return null;}
var found=_.find(treeNode.children,function(child){return String(child.id).toLowerCase()===String(id).toLowerCase();});return found===undefined?null:found;},getDescendantNode:function(treeNode,id,treeAlias){if(treeNode.isContainer===true&&!treeAlias){throw"Cannot get a descendant node from a section container node without a treeAlias specified";}
if(treeNode.isContainer){var foundRoot=null;for(var c=0;c<treeNode.children.length;c++){if(this.getTreeAlias(treeNode.children[c])===treeAlias){foundRoot=treeNode.children[c];break;}}
if(!foundRoot){throw"Could not find a tree in the current section with alias "+treeAlias;}
treeNode=foundRoot;}
if(treeNode.id===id){return treeNode;}
var found=this.getChildNode(treeNode,id);if(found){return found;}
if(!treeNode.children){return null;}
for(var i=0;i<treeNode.children.length;i++){if(treeNode.children[i].children&&angular.isArray(treeNode.children[i].children)&&treeNode.children[i].children.length>0){found=this.getDescendantNode(treeNode.children[i],id);if(found){return found;}}}
return found===undefined?null:found;},getTreeRoot:function(treeNode){if(!treeNode){throw"treeNode cannot be null";}
var root=null;var current=treeNode;while(root===null&&current){if(current.metaData&&current.metaData["treeAlias"]){root=current;}
else if(angular.isFunction(current.parent)){current=current.parent();}
else{current=null;}}
return root;},getTreeAlias:function(treeNode){var root=this.getTreeRoot(treeNode);if(root){return root.metaData["treeAlias"];}
return"";},getTree:function(args){var deferred=$q.defer();if(!args){args={section:'content',cacheKey:null};}
else if(!args.section){args.section='content';}
var cacheKey=getCacheKey(args);if(cacheKey&&treeCache[cacheKey]!==undefined){deferred.resolve(treeCache[cacheKey]);return deferred.promise;}
var self=this;treeResource.loadApplication(args).then(function(data){var result={name:data.name,alias:args.section,root:data};self._formatNodeDataForUseInUI(result.root,result.root.children,args.section);if(cacheKey){treeCache[cacheKey]=result;deferred.resolve(treeCache[cacheKey]);}
deferred.resolve(result);});return deferred.promise;},getMenu:function(args){if(!args){throw"args cannot be null";}
if(!args.treeNode){throw"args.treeNode cannot be null";}
return treeResource.loadMenu(args.treeNode).then(function(data){for(var i=0;i<data.length;i++){data[i].cssclass=iconHelper.convertFromLegacyIcon(data[i].cssclass);}
return data;});},getChildren:function(args){if(!args){throw"No args object defined for getChildren";}
if(!args.node){throw"No node defined on args object for getChildren";}
var section=args.section||'content';var treeItem=args.node;var self=this;return treeResource.loadNodes({node:treeItem}).then(function(data){self._formatNodeDataForUseInUI(treeItem,data,section,treeItem.level+1);return data;});},reloadNode:function(node){if(!node){throw"node cannot be null";}
if(!node.parent()){throw"cannot reload a single node without a parent";}
if(!node.section){throw"cannot reload a single node without an assigned node.section";}
var deferred=$q.defer();node.loading=true;this.getChildren({node:node.parent(),section:node.section}).then(function(data){var found=_.find(data,function(item){return item.id===node.id;});if(found){var index=_.indexOf(node.parent().children,node);if(angular.isFunction(node.parent().children[index].updateNodeData)){node.parent().children[index].updateNodeData(found);}
else{_.extend(node.parent().children[index],found);}
node.parent().children[index].loading=false;deferred.resolve(node.parent().children[index]);}
else{deferred.reject();}},function(){deferred.reject();});return deferred.promise;},getPath:function(node){if(!node){throw"node cannot be null";}
if(!angular.isFunction(node.parent)){throw"node.parent is not a function, the path cannot be resolved";}
var reversePath=[];var current=node;while(current!=null){reversePath.push(current.id);if(current.metaData&&current.metaData["treeAlias"]){current=null;}
else{current=current.parent();}}
return reversePath.reverse();},syncTree:function(args){if(!args){throw"No args object defined for syncTree";}
if(!args.node){throw"No node defined on args object for syncTree";}
if(!args.path){throw"No path defined on args object for syncTree";}
if(!angular.isArray(args.path)){throw"Path must be an array";}
if(args.path.length<1){args.path.push("-1");}
var deferred=$q.defer();var root=this.getTreeRoot(args.node);if(!root){throw"Could not get the root tree node based on the node passed in";}
var currPathIndex=0;if(String(args.path[currPathIndex]).toLowerCase()===String(args.node.id).toLowerCase()){if(args.path.length===1){deferred.resolve(root);return deferred.promise;}
else{currPathIndex=1;}}
var self=this;var node=args.node;var doSync=function(){var child=self.getChildNode(node,args.path[currPathIndex]);if(child){if(args.path.length===(currPathIndex+1)){if(!args.forceReload){deferred.resolve(child);}
else{self.reloadNode(child).then(function(reloaded){deferred.resolve(reloaded);},function(){deferred.reject();});}}
else{currPathIndex++;node=child;doSync();}}
else{self.loadNodeChildren({node:node,section:node.section}).then(function(){var found=self.getChildNode(node,args.path[currPathIndex]);if(found){if(args.path.length===(currPathIndex+1)){deferred.resolve(found);}
else{currPathIndex++;node=found;doSync();}}
else{deferred.reject();}},function(){deferred.reject();});}};doSync();return deferred.promise;}};}
angular.module('umbraco.services').factory('treeService',treeService);function umbRequestHelper($http,$q,umbDataFormatter,angularHelper,dialogService,notificationsService){return{dictionaryToQueryString:function(queryStrings){if(angular.isArray(queryStrings)){return _.map(queryStrings,function(item){var key=null;var val=null;for(var k in item){key=k;val=item[k];break;}
if(key===null||val===null){throw"The object in the array was not formatted as a key/value pair";}
return encodeURIComponent(key)+"="+encodeURIComponent(val);}).join("&");}
else if(angular.isObject(queryStrings)){return decodeURIComponent($.param(queryStrings));}
throw"The queryString parameter is not an array or object of key value pairs";},getApiUrl:function(apiName,actionName,queryStrings){if(!Umbraco||!Umbraco.Sys||!Umbraco.Sys.ServerVariables||!Umbraco.Sys.ServerVariables["umbracoUrls"]){throw"No server variables defined!";}
if(!Umbraco.Sys.ServerVariables["umbracoUrls"][apiName]){throw"No url found for api name "+apiName;}
return Umbraco.Sys.ServerVariables["umbracoUrls"][apiName]+actionName+
(!queryStrings?"":"?"+(angular.isString(queryStrings)?queryStrings:this.dictionaryToQueryString(queryStrings)));},resourcePromise:function(httpPromise,opts){var deferred=$q.defer();function defaultSuccess(data,status,headers,config){return data;}
function defaultError(data,status,headers,config){return{errorMsg:(angular.isString(opts)?opts:'An error occurred!'),data:data,status:status};}
var callbacks={success:((!opts||!opts.success)?defaultSuccess:opts.success),error:((!opts||!opts.error)?defaultError:opts.error)};httpPromise.success(function(data,status,headers,config){var result=callbacks.success.apply(this,[data,status,headers,config]);deferred.resolve(result);}).error(function(data,status,headers,config){var result=callbacks.error.apply(this,[data,status,headers,config]);if(status>=500&&status<600){if(Umbraco.Sys.ServerVariables["isDebuggingEnabled"]===true){dialogService.ysodDialog({errorMsg:result.errorMsg,data:result.data});}
else{notificationsService.error("Server error","Contact administrator, see log for full details.<br/><i>"+result.errorMsg+"</i>");}}
else{deferred.reject({errorMsg:result.errorMsg,data:result.data,status:result.status});}});return deferred.promise;},postSaveContent:function(args){if(!args.restApiUrl){throw"args.restApiUrl is a required argument";}
if(!args.content){throw"args.content is a required argument";}
if(!args.action){throw"args.action is a required argument";}
if(!args.files){throw"args.files is a required argument";}
if(!args.dataFormatter){throw"args.dataFormatter is a required argument";}
var deferred=$q.defer();var activeTab=_.find(args.content.tabs,function(item){return item.active;});var activeTabIndex=(activeTab===undefined?0:_.indexOf(args.content.tabs,activeTab));this.postMultiPartRequest(args.restApiUrl,{key:"contentItem",value:args.dataFormatter(args.content,args.action)},function(data,formData){for(var f in args.files){formData.append("file_"+args.files[f].alias,args.files[f].file);}},function(data,status,headers,config){_.each(data.tabs,function(item){item.active=false;});data.tabs[activeTabIndex].active=true;deferred.resolve(data);},function(data,status,headers,config){if(status>=500&&status<600){if(data.indexOf("Maximum request length exceeded")>=0){notificationsService.error("Server error","The image file size was too big, check with your site administrator to adjust the maximum size allowed");}
else if(Umbraco.Sys.ServerVariables["isDebuggingEnabled"]===true){dialogService.ysodDialog({errorMsg:'An error occurred',data:data});}
else{notificationsService.error("Server error","Contact administrator, see log for full details.<br/><i>"+data.ExceptionMessage+"</i>");}}
else{deferred.reject({errorMsg:'An error occurred',data:data,status:status});}});return deferred.promise;},postMultiPartRequest:function(url,jsonData,transformCallback,successCallback,failureCallback){if(!jsonData){throw"jsonData cannot be null";}
if(angular.isArray(jsonData)){_.each(jsonData,function(item){if(!item.key||!item.value){throw"jsonData array item must have both a key and a value property";}});}
else if(!jsonData.key||!jsonData.value){throw"jsonData object must have both a key and a value property";}
$http({method:'POST',url:url,headers:{'Content-Type':false},transformRequest:function(data){var formData=new FormData();if(angular.isArray(data)){_.each(data,function(item){formData.append(item.key,!angular.isString(item.value)?angular.toJson(item.value):item.value);});}
else{formData.append(data.key,!angular.isString(data.value)?angular.toJson(data.value):data.value);}
if(transformCallback){transformCallback.apply(this,[data,formData]);}
return formData;},data:jsonData}).success(function(data,status,headers,config){if(successCallback){successCallback.apply(this,[data,status,headers,config]);}}).error(function(data,status,headers,config){if(failureCallback){failureCallback.apply(this,[data,status,headers,config]);}});}};}
angular.module('umbraco.services').factory('umbRequestHelper',umbRequestHelper);angular.module('umbraco.services').factory('userService',function($rootScope,eventsService,$q,$location,$log,securityRetryQueue,authResource,dialogService,$timeout,angularHelper){var currentUser=null;var lastUserId=null;var loginDialog=null;var lastServerTimeoutSet=null;function openLoginDialog(isTimedOut){if(!loginDialog){loginDialog=dialogService.open({manualClose:true,template:'views/common/dialogs/login.html',modalClass:"login-overlay",animation:"slide",show:true,callback:onLoginDialogClose,dialogData:{isTimedOut:isTimedOut}});}}
function onLoginDialogClose(success){loginDialog=null;if(success){securityRetryQueue.retryAll();}
else{securityRetryQueue.cancelAll();$location.path('/');}}
function setCurrentUser(usr){if(!usr.remainingAuthSeconds){throw"The user object is invalid, the remainingAuthSeconds is required.";}
currentUser=usr;lastServerTimeoutSet=new Date();countdownUserTimeout();}
function countdownUserTimeout(){$timeout(function(){if(currentUser){currentUser.remainingAuthSeconds-=2;if(currentUser.remainingAuthSeconds>30){if(lastServerTimeoutSet!=null){var now=new Date();var seconds=(now.getTime()-lastServerTimeoutSet.getTime())/1000;if(seconds>30){lastServerTimeoutSet=null;angularHelper.safeApply($rootScope,function(){authResource.getRemainingTimeoutSeconds().then(function(result){setUserTimeoutInternal(result);});});}}
countdownUserTimeout();}
else{if(Umbraco.Sys.ServerVariables.umbracoSettings.keepUserLoggedIn!==true){angularHelper.safeApply($rootScope,function(){userAuthExpired();});}
else{if(lastServerTimeoutSet!=null){lastServerTimeoutSet=null;angularHelper.safeApply($rootScope,function(){authResource.getRemainingTimeoutSeconds().then(function(result){setUserTimeoutInternal(result);});});}
countdownUserTimeout();}}}},2000,false);}
function setUserTimeoutInternal(newTimeout){var asNumber=parseFloat(newTimeout);if(!isNaN(asNumber)&&currentUser&&angular.isNumber(asNumber)){currentUser.remainingAuthSeconds=newTimeout;lastServerTimeoutSet=new Date();}}
function userAuthExpired(isLogout){if(currentUser&&currentUser.id!==undefined){lastUserId=currentUser.id;}
if(currentUser){currentUser.remainingAuthSeconds=0;}
lastServerTimeoutSet=null;currentUser=null;eventsService.emit("app.notAuthenticated");openLoginDialog(isLogout===undefined?true:!isLogout);}
securityRetryQueue.onItemAddedCallbacks.push(function(retryItem){if(securityRetryQueue.hasMore()){userAuthExpired();}});return{_showLoginDialog:function(){openLoginDialog();},isAuthenticated:function(){if(currentUser){var deferred=$q.defer();deferred.resolve(true);return deferred.promise;}
return authResource.isAuthenticated();},authenticate:function(login,password){return authResource.performLogin(login,password).then(function(data){setCurrentUser(data);var result={user:data,authenticated:true,lastUserId:lastUserId};eventsService.emit("app.authenticated",result);return result;});},logout:function(){return authResource.performLogout().then(function(data){userAuthExpired();return null;});},getCurrentUser:function(args){var deferred=$q.defer();if(!currentUser){authResource.getCurrentUser().then(function(data){var result={user:data,authenticated:true,lastUserId:lastUserId};if(Umbraco&&Umbraco.Sys&&Umbraco.Sys.ServerVariables){Umbraco.Sys.ServerVariables["security"]={startContentId:data.startContentId,startMediaId:data.startMediaId};}
if(args&&args.broadcastEvent){eventsService.emit("app.authenticated",result);}
setCurrentUser(data);currentUser.avatar='//www.gravatar.com/avatar/'+data.emailHash+'?s=40&d=404';deferred.resolve(currentUser);});}
else{deferred.resolve(currentUser);}
return deferred.promise;},setUserTimeout:function(newTimeout){setUserTimeoutInternal(newTimeout);}};});function packageHelper(assetsService,treeService,eventsService,$templateCache){return{packageInstalled:function(){treeService.clearCache();$templateCache.removeAll();eventsService.emit("app.reInitialize");}};}
angular.module('umbraco.services').factory('packageHelper',packageHelper);function umbPhotoFolderHelper($compile,$log,$timeout,$filter,imageHelper,mediaHelper,umbRequestHelper){return{setImageData:function(img){img.isFolder=!mediaHelper.hasFilePropertyType(img);if(!img.isFolder){img.thumbnail=mediaHelper.resolveFile(img,true);img.image=mediaHelper.resolveFile(img,false);}},setOriginalSize:function(img,maxHeight){img.originalWidth=maxHeight;img.originalHeight=maxHeight;var widthProp=_.find(img.properties,function(v){return(v.alias==="umbracoWidth");});if(widthProp&&widthProp.value){img.originalWidth=parseInt(widthProp.value,10);if(isNaN(img.originalWidth)){img.originalWidth=maxHeight;}}
var heightProp=_.find(img.properties,function(v){return(v.alias==="umbracoHeight");});if(heightProp&&heightProp.value){img.originalHeight=parseInt(heightProp.value,10);if(isNaN(img.originalHeight)){img.originalHeight=maxHeight;}}},setImageStyle:function(img,width,height,rightMargin,bottomMargin){img.style={width:width+"px",height:height+"px","margin-right":rightMargin+"px","margin-bottom":bottomMargin+"px"};img.thumbStyle={"background-image":"url('"+img.thumbnail+"')","background-repeat":"no-repeat","background-position":"center","background-size":Math.min(width,img.originalWidth)+"px "+Math.min(height,img.originalHeight)+"px"};},getScaledWidth:function(img,maxHeight){var scaled=img.originalWidth*maxHeight/img.originalHeight;return scaled;},getTargetWidth:function(imgsPerRow,maxRowWidth,margin){return(maxRowWidth-((imgsPerRow-1)*margin));},getRowHeightForImages:function(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin,targetHeight){var idealImages=imgs.slice(0,idealImgPerRow);var targetRowWidth=this.getTargetWidth(idealImages.length,maxRowWidth,margin);var maxScaleableHeight=this.getMaxScaleableHeight(idealImages,maxRowHeight);targetHeight=targetHeight!==undefined?targetHeight:Math.max(maxScaleableHeight,minDisplayHeight);var attemptedRowHeight=this.performGetRowHeight(idealImages,targetRowWidth,minDisplayHeight,targetHeight);if(attemptedRowHeight!=null){if(attemptedRowHeight<minDisplayHeight){if(idealImages.length>1){targetHeight+=Math.floor((maxRowHeight-targetHeight)/2);return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow-1,margin,targetHeight);}
else{return{height:minDisplayHeight,imgCount:1};}}
else{return{height:attemptedRowHeight,imgCount:idealImages.length};}}
if(idealImages.length===imgs.length){return{height:targetHeight,imgCount:idealImages.length};}
else if(idealImages.length===1){return{height:minDisplayHeight,imgCount:1};}
else if(idealImages.length===idealImgPerRow&&targetHeight<maxRowHeight){while(targetHeight<maxRowHeight&&(maxRowHeight-targetHeight)>5){targetHeight+=Math.floor((maxRowHeight-targetHeight)/2);attemptedRowHeight=this.performGetRowHeight(idealImages,targetRowWidth,minDisplayHeight,targetHeight);if(attemptedRowHeight!=null){return{height:attemptedRowHeight,imgCount:idealImages.length};}}
return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow-1,margin);}
else if(targetHeight===maxRowHeight){return{height:targetHeight,imgCount:idealImages.length};}
else{return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow+1,margin);}},performGetRowHeight:function(idealImages,targetRowWidth,minDisplayHeight,targetHeight){var currRowWidth=0;for(var i=0;i<idealImages.length;i++){var scaledW=this.getScaledWidth(idealImages[i],targetHeight);currRowWidth+=scaledW;}
if(currRowWidth>targetRowWidth){var newHeight=targetRowWidth*targetHeight/currRowWidth;return newHeight;}
else if(idealImages.length===1&&(currRowWidth<=targetRowWidth)&&!idealImages[0].isFolder){return targetHeight;}
else if(currRowWidth/targetRowWidth>0.90){return targetHeight;}
else{return null;}},buildRow:function(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin){var currRowWidth=0;var row={images:[]};var imageRowHeight=this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin);var targetWidth=this.getTargetWidth(imageRowHeight.imgCount,maxRowWidth,margin);var sizes=[];for(var i=0;i<imageRowHeight.imgCount;i++){var scaledWidth=Math.floor(this.getScaledWidth(imgs[i],imageRowHeight.height));if(currRowWidth+scaledWidth<=targetWidth){currRowWidth+=scaledWidth;sizes.push({width:scaledWidth,height:Math.round(imageRowHeight.height)});row.images.push(imgs[i]);}
else if(imageRowHeight.imgCount===1&&row.images.length===0){sizes.push({width:maxRowWidth,height:Math.round(imageRowHeight.height)});row.images.push(imgs[i]);}
else{break;}}
for(var j=0;j<row.images.length;j++){var bottomMargin=margin;if(j===(row.images.length-1)){margin=0;}
this.setImageStyle(row.images[j],sizes[j].width,sizes[j].height,margin,bottomMargin);}
if(row.images.length===1){row.images[0].style.width=maxRowWidth+"px";}
return row;},getMaxScaleableHeight:function(imgs,maxRowHeight){var smallestHeight=_.min(imgs,function(item){return item.originalHeight;}).originalHeight;if(smallestHeight>maxRowHeight){smallestHeight=maxRowHeight;}
return smallestHeight;},buildGrid:function(images,maxRowWidth,maxRowHeight,startingIndex,minDisplayHeight,idealImgPerRow,margin,imagesOnly){var rows=[];var imagesProcessed=0;for(var i=startingIndex;i<images.length;i++){var item=images[i];this.setImageData(item);this.setOriginalSize(item,maxRowHeight);if(imagesOnly&&!item.isFolder&&!item.thumbnail){images.splice(i,1);i--;}}
while((imagesProcessed+startingIndex)<images.length){var currImgs=images.slice(imagesProcessed);var row=this.buildRow(currImgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin);if(row.images.length>0){rows.push(row);imagesProcessed+=row.images.length;}
else{if(currImgs.length>0){throw"Could not fill grid with all images, images remaining: "+currImgs.length;}
break;}}
return rows;}};}
angular.module("umbraco.services").factory("umbPhotoFolderHelper",umbPhotoFolderHelper);function umbModelMapper(){return{convertToEntityBasic:function(source){var required=["id","name","icon","parentId","path"];_.each(required,function(k){if(!_.has(source,k)){throw"The source object does not contain the property "+k;}});var optional=["metaData","key","alias"];var result=_.pick(source,required.concat(optional));return result;}};}
angular.module('umbraco.services').factory('umbModelMapper',umbModelMapper);function umbSessionStorage($window){var storage=$window['sessionStorage']?$window['sessionStorage']:{};return{get:function(key){return angular.fromJson(storage["umb_"+key]);},set:function(key,value){storage["umb_"+key]=angular.toJson(value);}};}
angular.module('umbraco.services').factory('umbSessionStorage',umbSessionStorage);function updateChecker($http,umbRequestHelper){return{check:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("updateCheckApiBaseUrl","GetCheck")),'Failed to retrieve update status');}};}
angular.module('umbraco.services').factory('updateChecker',updateChecker);function umbPropEditorHelper(){return{getViewPath:function(input,isPreValue){var path=String(input);if(path.startsWith('/')){return path;}else{if(path.indexOf("/")>=0){return path;}else{if(!isPreValue){return"views/propertyeditors/"+path+"/"+path+".html";}else{return"views/prevalueeditors/"+path+".html";}}}}};}
angular.module('umbraco.services').factory('umbPropEditorHelper',umbPropEditorHelper);function umbDataFormatter(){return{formatDataTypePostData:function(displayModel,preValues,action){var saveModel={parentId:-1,id:displayModel.id,name:displayModel.name,selectedEditor:displayModel.selectedEditor,action:action,preValues:[]};for(var i=0;i<preValues.length;i++){saveModel.preValues.push({key:preValues[i].alias,value:preValues[i].value});}
return saveModel;},formatMemberPostData:function(displayModel,action){var saveModel=this.formatMediaPostData(displayModel,action);saveModel.key=displayModel.key;var genericTab=_.find(displayModel.tabs,function(item){return item.id===0;});var propLogin=_.find(genericTab.properties,function(item){return item.alias==="_umb_login";});var propEmail=_.find(genericTab.properties,function(item){return item.alias==="_umb_email";});var propPass=_.find(genericTab.properties,function(item){return item.alias==="_umb_password";});var propGroups=_.find(genericTab.properties,function(item){return item.alias==="_umb_membergroup";});saveModel.email=propEmail.value;saveModel.username=propLogin.value;saveModel.password=propPass.value;var selectedGroups=[];for(var n in propGroups.value){if(propGroups.value[n]===true){selectedGroups.push(n);}}
saveModel.memberGroups=selectedGroups;var memberProviderPropAliases=_.pairs(displayModel.fieldConfig);_.each(displayModel.tabs,function(tab){_.each(tab.properties,function(prop){var foundAlias=_.find(memberProviderPropAliases,function(item){return prop.alias===item[1];});if(foundAlias){switch(foundAlias[0]){case"umbracoMemberLockedOut":saveModel.isLockedOut=prop.value.toString()==="1"?true:false;break;case"umbracoMemberApproved":saveModel.isApproved=prop.value.toString()==="1"?true:false;break;case"umbracoMemberComments":saveModel.comments=prop.value;break;}}});});return saveModel;},formatMediaPostData:function(displayModel,action){var saveModel={id:displayModel.id,properties:[],name:displayModel.name,contentTypeAlias:displayModel.contentTypeAlias,parentId:displayModel.parentId,action:action};_.each(displayModel.tabs,function(tab){_.each(tab.properties,function(prop){if(!prop.alias.startsWith("_umb_")){saveModel.properties.push({id:prop.id,alias:prop.alias,value:prop.value});}});});return saveModel;},formatContentPostData:function(displayModel,action){var saveModel=this.formatMediaPostData(displayModel,action);var genericTab=_.find(displayModel.tabs,function(item){return item.id===0;});var propExpireDate=_.find(genericTab.properties,function(item){return item.alias==="_umb_expiredate";});var propReleaseDate=_.find(genericTab.properties,function(item){return item.alias==="_umb_releasedate";});var propTemplate=_.find(genericTab.properties,function(item){return item.alias==="_umb_template";});saveModel.expireDate=propExpireDate.value;saveModel.releaseDate=propReleaseDate.value;saveModel.templateAlias=propTemplate.value;return saveModel;}};}
angular.module('umbraco.services').factory('umbDataFormatter',umbDataFormatter);function xmlhelper($http){function X2JS(){var VERSION="1.0.11";var escapeMode=false;var DOMNodeTypes={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,DOCUMENT_NODE:9};function getNodeLocalName(node){var nodeLocalName=node.localName;if(nodeLocalName==null){nodeLocalName=node.baseName;}
if(nodeLocalName===null||nodeLocalName===""){nodeLocalName=node.nodeName;}
return nodeLocalName;}
function getNodePrefix(node){return node.prefix;}
function escapeXmlChars(str){if(typeof(str)==="string"){return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#x27;').replace(/\//g,'&#x2F;');}else{return str;}}
function unescapeXmlChars(str){return str.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,'\/');}
function parseDOMChildren(node){var result,child,childName;if(node.nodeType===DOMNodeTypes.DOCUMENT_NODE){result={};child=node.firstChild;childName=getNodeLocalName(child);result[childName]=parseDOMChildren(child);return result;}
else{if(node.nodeType===DOMNodeTypes.ELEMENT_NODE){result={};result.__cnt=0;var nodeChildren=node.childNodes;for(var cidx=0;cidx<nodeChildren.length;cidx++){child=nodeChildren.item(cidx);childName=getNodeLocalName(child);result.__cnt++;if(result[childName]===null){result[childName]=parseDOMChildren(child);result[childName+"_asArray"]=new Array(1);result[childName+"_asArray"][0]=result[childName];}
else{if(result[childName]!==null){if(!(result[childName]instanceof Array)){var tmpObj=result[childName];result[childName]=[];result[childName][0]=tmpObj;result[childName+"_asArray"]=result[childName];}}
var aridx=0;while(result[childName][aridx]!==null){aridx++;}
(result[childName])[aridx]=parseDOMChildren(child);}}
for(var aidx=0;aidx<node.attributes.length;aidx++){var attr=node.attributes.item(aidx);result.__cnt++;result["_"+attr.name]=attr.value;}
var nodePrefix=getNodePrefix(node);if(nodePrefix!==null&&nodePrefix!==""){result.__cnt++;result.__prefix=nodePrefix;}
if(result.__cnt===1&&result["#text"]!==null){result=result["#text"];}
if(result["#text"]!==null){result.__text=result["#text"];if(escapeMode){result.__text=unescapeXmlChars(result.__text);}
delete result["#text"];delete result["#text_asArray"];}
if(result["#cdata-section"]!=null){result.__cdata=result["#cdata-section"];delete result["#cdata-section"];delete result["#cdata-section_asArray"];}
if(result.__text!=null||result.__cdata!=null){result.toString=function(){return(this.__text!=null?this.__text:'')+(this.__cdata!=null?this.__cdata:'');};}
return result;}
else{if(node.nodeType===DOMNodeTypes.TEXT_NODE||node.nodeType===DOMNodeTypes.CDATA_SECTION_NODE){return node.nodeValue;}}}}
function startTag(jsonObj,element,attrList,closed){var resultStr="<"+((jsonObj!=null&&jsonObj.__prefix!=null)?(jsonObj.__prefix+":"):"")+element;if(attrList!=null){for(var aidx=0;aidx<attrList.length;aidx++){var attrName=attrList[aidx];var attrVal=jsonObj[attrName];resultStr+=" "+attrName.substr(1)+"='"+attrVal+"'";}}
if(!closed){resultStr+=">";}else{resultStr+="/>";}
return resultStr;}
function endTag(jsonObj,elementName){return"</"+(jsonObj.__prefix!==null?(jsonObj.__prefix+":"):"")+elementName+">";}
function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1;}
function jsonXmlSpecialElem(jsonObj,jsonObjField){if(endsWith(jsonObjField.toString(),("_asArray"))||jsonObjField.toString().indexOf("_")===0||(jsonObj[jsonObjField]instanceof Function)){return true;}else{return false;}}
function jsonXmlElemCount(jsonObj){var elementsCnt=0;if(jsonObj instanceof Object){for(var it in jsonObj){if(jsonXmlSpecialElem(jsonObj,it)){continue;}
elementsCnt++;}}
return elementsCnt;}
function parseJSONAttributes(jsonObj){var attrList=[];if(jsonObj instanceof Object){for(var ait in jsonObj){if(ait.toString().indexOf("__")===-1&&ait.toString().indexOf("_")===0){attrList.push(ait);}}}
return attrList;}
function parseJSONTextAttrs(jsonTxtObj){var result="";if(jsonTxtObj.__cdata!=null){result+="<![CDATA["+jsonTxtObj.__cdata+"]]>";}
if(jsonTxtObj.__text!=null){if(escapeMode){result+=escapeXmlChars(jsonTxtObj.__text);}else{result+=jsonTxtObj.__text;}}
return result;}
function parseJSONTextObject(jsonTxtObj){var result="";if(jsonTxtObj instanceof Object){result+=parseJSONTextAttrs(jsonTxtObj);}
else{if(jsonTxtObj!=null){if(escapeMode){result+=escapeXmlChars(jsonTxtObj);}else{result+=jsonTxtObj;}}}
return result;}
function parseJSONArray(jsonArrRoot,jsonArrObj,attrList){var result="";if(jsonArrRoot.length===0){result+=startTag(jsonArrRoot,jsonArrObj,attrList,true);}
else{for(var arIdx=0;arIdx<jsonArrRoot.length;arIdx++){result+=startTag(jsonArrRoot[arIdx],jsonArrObj,parseJSONAttributes(jsonArrRoot[arIdx]),false);result+=parseJSONObject(jsonArrRoot[arIdx]);result+=endTag(jsonArrRoot[arIdx],jsonArrObj);}}
return result;}
function parseJSONObject(jsonObj){var result="";var elementsCnt=jsonXmlElemCount(jsonObj);if(elementsCnt>0){for(var it in jsonObj){if(jsonXmlSpecialElem(jsonObj,it)){continue;}
var subObj=jsonObj[it];var attrList=parseJSONAttributes(subObj);if(subObj===null||subObj===undefined){result+=startTag(subObj,it,attrList,true);}else{if(subObj instanceof Object){if(subObj instanceof Array){result+=parseJSONArray(subObj,it,attrList);}else{var subObjElementsCnt=jsonXmlElemCount(subObj);if(subObjElementsCnt>0||subObj.__text!==null||subObj.__cdata!==null){result+=startTag(subObj,it,attrList,false);result+=parseJSONObject(subObj);result+=endTag(subObj,it);}else{result+=startTag(subObj,it,attrList,true);}}}else{result+=startTag(subObj,it,attrList,false);result+=parseJSONTextObject(subObj);result+=endTag(subObj,it);}}}}
result+=parseJSONTextObject(jsonObj);return result;}
this.parseXmlString=function(xmlDocStr){var xmlDoc;if(window.DOMParser){var parser=new window.DOMParser();xmlDoc=parser.parseFromString(xmlDocStr,"text/xml");}
else{if(xmlDocStr.indexOf("<?")===0){xmlDocStr=xmlDocStr.substr(xmlDocStr.indexOf("?>")+2);}
xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(xmlDocStr);}
return xmlDoc;};this.xml2json=function(xmlDoc){return parseDOMChildren(xmlDoc);};this.xml_str2json=function(xmlDocStr){var xmlDoc=this.parseXmlString(xmlDocStr);return this.xml2json(xmlDoc);};this.json2xml_str=function(jsonObj){return parseJSONObject(jsonObj);};this.json2xml=function(jsonObj){var xmlDocStr=this.json2xml_str(jsonObj);return this.parseXmlString(xmlDocStr);};this.getVersion=function(){return VERSION;};this.escapeMode=function(enabled){escapeMode=enabled;};}
var x2js=new X2JS();return{toJson:function(xml){var json=x2js.xml_str2json(xml);return json;},fromJson:function(json){var xml=x2js.json2xml_str(json);return xml;},parseFeed:function(url){return $http.jsonp('//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=50&callback=JSON_CALLBACK&q='+encodeURIComponent(url));}};}
angular.module('umbraco.services').factory('xmlhelper',xmlhelper);})();
;;;
(function(){angular.module('umbraco.security',['umbraco.security.retryQueue','umbraco.security.interceptor']);angular.module('umbraco.security.interceptor',['umbraco.security.retryQueue']).factory('securityInterceptor',['$injector','securityRetryQueue','notificationsService',function($injector,queue,notifications){return function(promise){return promise.then(function(originalResponse){var headers=originalResponse.headers();if(headers["x-umb-user-seconds"]){var userService=$injector.get('userService');userService.setUserTimeout(headers["x-umb-user-seconds"]);}
return promise;},function(originalResponse){if(originalResponse.status===401){promise=queue.pushRetryFn('unauthorized-server',function retryRequest(){return $injector.get('$http')(originalResponse.config);});}
else if(originalResponse.status===404){var errMsg="The URL returned a 404 (not found): <br/><i>"+originalResponse.config.url.split('?')[0]+"</i>";if(originalResponse.data&&originalResponse.data.ExceptionMessage){errMsg+="<br/> with error: <br/><i>"+originalResponse.data.ExceptionMessage+"</i>";}
if(originalResponse.config.data){errMsg+="<br/> with data: <br/><i>"+angular.toJson(originalResponse.config.data)+"</i><br/>Contact your administrator for information.";}
notifications.error("Request error",errMsg);}
else if(originalResponse.status===403){var msg="Unauthorized access to URL: <br/><i>"+originalResponse.config.url.split('?')[0]+"</i>";if(originalResponse.config.data){msg+="<br/> with data: <br/><i>"+angular.toJson(originalResponse.config.data)+"</i><br/>Contact your administrator for information.";}
notifications.error("Authorization error",msg);}
return promise;});};}]).config(['$httpProvider',function($httpProvider){$httpProvider.responseInterceptors.push('securityInterceptor');}]);angular.module('umbraco.security.retryQueue',[]).factory('securityRetryQueue',['$q','$log',function($q,$log){var retryQueue=[];var service={onItemAddedCallbacks:[],hasMore:function(){return retryQueue.length>0;},push:function(retryItem){retryQueue.push(retryItem);angular.forEach(service.onItemAddedCallbacks,function(cb){try{cb(retryItem);}catch(e){$log.error('securityRetryQueue.push(retryItem): callback threw an error'+e);}});},pushRetryFn:function(reason,retryFn){if(arguments.length===1){retryFn=reason;reason=undefined;}
var deferred=$q.defer();var retryItem={reason:reason,retry:function(){$q.when(retryFn()).then(function(value){deferred.resolve(value);},function(value){deferred.reject(value);});},cancel:function(){deferred.reject();}};service.push(retryItem);return deferred.promise;},retryReason:function(){return service.hasMore()&&retryQueue[0].reason;},cancelAll:function(){while(service.hasMore()){retryQueue.shift().cancel();}},retryAll:function(){while(service.hasMore()){retryQueue.shift().retry();}}};return service;}]);})();
;;;
(function(){function MainController($scope,$rootScope,$location,$routeParams,$timeout,$http,$log,appState,treeService,notificationsService,userService,navigationService,historyService,updateChecker,assetsService,eventsService,umbRequestHelper,tmhDynamicLocale){$scope.authenticated=null;$scope.avatar="assets/img/application/logo.png";$scope.touchDevice=appState.getGlobalState("touchDevice");$scope.notifications=notificationsService.current;$scope.$watch('notificationsService.current',function(newVal,oldVal,scope){if(newVal){$scope.notifications=newVal;}});$scope.removeNotification=function(index){notificationsService.remove(index);};$scope.closeDialogs=function(event){var el=event.target.nodeName;var els=["INPUT","A","BUTTON"];if(els.indexOf(el)>=0){return;}
var parents=$(event.target).parents("a,button");if(parents.length>0){return;}
var nav=$(event.target).parents("#dialog");if(nav.length===1){return;}
eventsService.emit("app.closeDialogs",event);};eventsService.on("app.notAuthenticated",function(){$scope.authenticated=null;$scope.user=null;});eventsService.on("app.ready",function(evt,data){$scope.authenticated=data.authenticated;$scope.user=data.user;updateChecker.check().then(function(update){if(update&&update!=="null"){if(update.type!=="None"){var notification={headline:"Update available",message:"Click to download",sticky:true,type:"info",url:update.url};notificationsService.add(notification);}}});if(data.lastUserId!==undefined&&data.lastUserId!==null&&data.lastUserId!==data.user.id){$location.path("/").search("");historyService.removeAll();treeService.clearCache();}
if($scope.user.locale){tmhDynamicLocale.set($scope.user.locale);}
if($scope.user.emailHash){$timeout(function(){$("#avatar-img").fadeTo(1000,0,function(){$timeout(function(){if($scope.user&&$scope.user.emailHash){$scope.avatar="//www.gravatar.com/avatar/"+$scope.user.emailHash+".jpg?s=64&d=mm";}});$("#avatar-img").fadeTo(1000,1);});},3000);}});}
angular.module('umbraco').controller("Umbraco.MainController",MainController).config(function(tmhDynamicLocaleProvider){tmhDynamicLocaleProvider.localeLocationPattern('lib/angular/1.1.5/i18n/angular-locale_{{locale}}.js');});function NavigationController($scope,$rootScope,$location,$log,$routeParams,$timeout,appState,navigationService,keyboardService,dialogService,historyService,eventsService,sectionResource,angularHelper){$scope.treeEventHandler=$({});navigationService.setupTreeEvents($scope.treeEventHandler);$scope.nav=navigationService;$rootScope.nav=navigationService;$scope.showContextMenuDialog=false;$scope.showContextMenu=false;$scope.showSearchResults=false;$scope.menuDialogTitle=null;$scope.menuActions=[];$scope.menuNode=null;$scope.currentSection=appState.getSectionState("currentSection");$scope.showNavigation=appState.getGlobalState("showNavigation");keyboardService.bind("ctrl+shift+s",function(){navigationService.showSearch();});keyboardService.bind("esc",function(){eventsService.emit("app.closeDialogs");});$scope.selectedId=navigationService.currentId;eventsService.on("appState.globalState.changed",function(e,args){if(args.key==="showNavigation"){$scope.showNavigation=args.value;}});eventsService.on("appState.menuState.changed",function(e,args){if(args.key==="showMenuDialog"){$scope.showContextMenuDialog=args.value;}
if(args.key==="showMenu"){$scope.showContextMenu=args.value;}
if(args.key==="dialogTitle"){$scope.menuDialogTitle=args.value;}
if(args.key==="menuActions"){$scope.menuActions=args.value;}
if(args.key==="currentNode"){$scope.menuNode=args.value;}});eventsService.on("appState.treeState.changed",function(e,args){var f=args;if(args.value.root&&args.value.root.metaData.containsTrees===false){$rootScope.emptySection=true;}else{$rootScope.emptySection=false;}});eventsService.on("appState.sectionState.changed",function(e,args){if(args.key==="currentSection"){$scope.currentSection=args.value;}
if(args.key==="showSearchResults"){$scope.showSearchResults=args.value;}});eventsService.on("app.closeDialogs",function(event){if(appState.getGlobalState("stickyNavigation")){navigationService.hideNavigation();angularHelper.safeApply($scope);}});eventsService.on("app.notAuthenticated",function(){$scope.authenticated=false;});eventsService.on("app.ready",function(evt,data){$scope.authenticated=true;});$scope.searchShowMenu=function(ev,args){args.skipDefault=true;navigationService.showMenu(ev,args);};$scope.searchHide=function(){navigationService.hideSearch();};var treeActive=false;$scope.enterTree=function(event){treeActive=true;};$scope.leaveTree=function(event){if(!event){return;}
if(!appState.getGlobalState("touchDevice")){treeActive=false;$timeout(function(){if(!treeActive){navigationService.hideTree();}},300);}};}
angular.module('umbraco').controller("Umbraco.NavigationController",NavigationController);function SearchController($scope,searchService,$log,$location,navigationService,$q){$scope.searchTerm=null;$scope.searchResults=[];$scope.isSearching=false;$scope.selectedResult=-1;$scope.navigateResults=function(ev){switch(ev.keyCode){case 38:iterateResults(true);break;case 40:iterateResults(false);break;case 13:if($scope.selectedItem){$location.path($scope.selectedItem.editorPath);navigationService.hideSearch();}
break;}};var group=undefined;var groupIndex=-1;var itemIndex=-1;$scope.selectedItem=undefined;function iterateResults(up){if(!group){group=$scope.groups[0];groupIndex=0;}
if(up){if(itemIndex===0){if(groupIndex===0){gotoGroup($scope.groups.length-1,true);}else{gotoGroup(groupIndex-1,true);}}else{gotoItem(itemIndex-1);}}else{if(itemIndex<group.results.length-1){gotoItem(itemIndex+1);}else{if(groupIndex===$scope.groups.length-1){gotoGroup(0);}else{gotoGroup(groupIndex+1);}}}}
function gotoGroup(index,up){groupIndex=index;group=$scope.groups[groupIndex];if(up){gotoItem(group.results.length-1);}else{gotoItem(0);}}
function gotoItem(index){itemIndex=index;$scope.selectedItem=group.results[itemIndex];}
var canceler=null;$scope.$watch("searchTerm",_.debounce(function(newVal,oldVal){$scope.$apply(function(){if($scope.searchTerm){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){$scope.isSearching=true;navigationService.showSearch();$scope.selectedItem=undefined;if(canceler){console.log("CANCELED!");canceler.resolve();canceler=$q.defer();}
else{canceler=$q.defer();}
searchService.searchAll({term:$scope.searchTerm,canceler:canceler}).then(function(result){$scope.groups=_.filter(result,function(group){return group.results.length>0;});canceler=null;});}}
else{$scope.isSearching=false;navigationService.hideSearch();$scope.selectedItem=undefined;}});},200));}
angular.module('umbraco').controller("Umbraco.SearchController",SearchController);function AuthorizeUpgradeController($scope,$window){$scope.submit=function(event){var qry=$window.location.search.trimStart("?").split("&");var redir=_.find(qry,function(item){return item.startsWith("redir=");});if(redir){$window.location=decodeURIComponent(redir.split("=")[1]);}
else{$window.location="/";}};}
angular.module('umbraco').controller("Umbraco.AuthorizeUpgradeController",AuthorizeUpgradeController);function DashboardController($scope,$routeParams,dashboardResource,localizationService){$scope.dashboard={};localizationService.localize("sections_"+$routeParams.section).then(function(name){$scope.dashboard.name=name;});dashboardResource.getDashboard($routeParams.section).then(function(tabs){$scope.dashboard.tabs=tabs;});}
angular.module('umbraco').controller("Umbraco.DashboardController",DashboardController);angular.module("umbraco").controller("Umbraco.Dialogs.ApprovedColorPickerController",function($scope,$http,umbPropEditorHelper,assetsService){assetsService.loadJs("lib/cssparser/cssparser.js").then(function(){var cssPath=$scope.dialogData.cssPath;$scope.cssClass=$scope.dialogData.cssClass;$scope.classes=[];$scope.change=function(newClass){$scope.model.value=newClass;}
$http.get(cssPath).success(function(data){var parser=new CSSParser();$scope.classes=parser.parse(data,false,false).cssRules;$scope.classes.splice(0,0,"noclass");})
assetsService.loadCss("/App_Plugins/Lecoati.uSky.Grid/lib/uSky.Grid.ApprovedColorPicker.css");assetsService.loadCss(cssPath);});});function ContentEditDialogController($scope,editorState,$routeParams,$q,$timeout,$window,appState,contentResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,treeService,fileManager,formHelper,umbRequestHelper,umbModelMapper,$http){$scope.defaultButton=null;$scope.subButtons=[];var dialogOptions=$scope.$parent.dialogOptions;function performSave(args){contentEditingHelper.contentEditorPerformSave({statusMessage:args.statusMessage,saveMethod:args.saveMethod,scope:$scope,content:$scope.content}).then(function(content){if(dialogOptions.closeOnSave){$scope.submit(content);}},function(err){});}
function filterTabs(entity,blackList){if(blackList){_.each(entity.tabs,function(tab){tab.hide=_.contains(blackList,tab.alias);});}
return entity;};function init(content){var buttons=contentEditingHelper.configureContentEditorButtons({create:$routeParams.create,content:content,methods:{saveAndPublish:$scope.saveAndPublish,sendToPublish:$scope.sendToPublish,save:$scope.save,unPublish:angular.noop}});$scope.defaultButton=buttons.defaultButton;$scope.subButtons=buttons.subButtons;$scope.content.isDialogEditor=true;editorState.set($scope.content);}
if(angular.isObject(dialogOptions.entity)){$scope.loaded=true;$scope.content=filterTabs(dialogOptions.entity,dialogOptions.tabFilter);init($scope.content);}
else{contentResource.getById(dialogOptions.id).then(function(data){$scope.loaded=true;$scope.content=filterTabs(data,dialogOptions.tabFilter);init($scope.content);serverValidationManager.executeAndClearAllSubscriptions();});}
$scope.sendToPublish=function(){performSave({saveMethod:contentResource.sendToPublish,statusMessage:"Sending..."});};$scope.saveAndPublish=function(){performSave({saveMethod:contentResource.publish,statusMessage:"Publishing..."});};$scope.save=function(){performSave({saveMethod:contentResource.save,statusMessage:"Saving..."});};$scope.performAction=function(btn){if(!btn||!angular.isFunction(btn.handler)){throw"btn.handler must be a function reference";}
if(!$scope.busy){btn.handler.apply(this);}};}
angular.module("umbraco").controller("Umbraco.Dialogs.Content.EditController",ContentEditDialogController);angular.module("umbraco").controller("Umbraco.Dialogs.HelpController",function($scope,$location,$routeParams,helpService,userService){$scope.section=$routeParams.section;$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;if(!$scope.section){$scope.section="content";}
var rq={};rq.section=$scope.section;userService.getCurrentUser().then(function(user){rq.usertype=user.userType;rq.lang=user.locale;if($routeParams.url){rq.path=decodeURIComponent($routeParams.url);if(rq.path.indexOf(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath)===0){rq.path=rq.path.substring(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath.length);}
if(rq.path.indexOf(".aspx")>0){rq.path=rq.path.substring(0,rq.path.indexOf(".aspx"));}}else{rq.path=rq.section+"/"+$routeParams.tree+"/"+$routeParams.method;}
helpService.findHelp(rq).then(function(topics){$scope.topics=topics;});helpService.findVideos(rq).then(function(videos){$scope.videos=videos;});});});angular.module("umbraco").controller("Umbraco.Dialogs.IconPickerController",function($scope,iconHelper){iconHelper.getIcons().then(function(icons){$scope.icons=icons;});$scope.submitClass=function(icon){if($scope.color)
{$scope.submit(icon+" "+$scope.color);}else{$scope.submit(icon);}};});function InsertMacroController($scope,entityResource,macroResource,umbPropEditorHelper,macroService,formHelper){function editParams(){macroResource.getMacroParameters($scope.selectedMacro.id).then(function(data){if(!angular.isArray(data)||data.length===0){submitForm();}else{$scope.wizardStep="paramSelect";$scope.macroParams=data;if($scope.dialogData&&$scope.dialogData.macroData&&$scope.dialogData.macroData.macroParamsDictionary){_.each($scope.dialogData.macroData.macroParamsDictionary,function(val,key){var prop=_.find($scope.macroParams,function(item){return item.alias==key;});if(prop){if(_.isString(val)){val=_.unescape(val);if(val.detectIsJson()){try{prop.value=angular.fromJson(val);}
catch(e){prop.value=val;}}
else{prop.value=val;}}
else{prop.value=val;}}});}}});}
function submitForm(){var paramDictionary={};_.each($scope.macroParams,function(item){var val=item.value;if(!_.isString(item.value)){try{val=angular.toJson(val);}
catch(e){}}
paramDictionary[item.alias]=_.escape(val);});var macroAlias=$scope.selectedMacro.alias;var syntax;if($scope.dialogData.renderingEngine&&$scope.dialogData.renderingEngine==="WebForms"){syntax=macroService.generateWebFormsSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else if($scope.dialogData.renderingEngine&&$scope.dialogData.renderingEngine==="Mvc"){syntax=macroService.generateMvcSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else{syntax=macroService.generateMacroSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
$scope.submit({syntax:syntax,macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
$scope.macros=[];$scope.selectedMacro=null;$scope.wizardStep="macroSelect";$scope.macroParams=[];$scope.submitForm=function(){if(formHelper.submitForm({scope:$scope})){formHelper.resetForm({scope:$scope});if($scope.wizardStep==="macroSelect"){editParams();}
else{submitForm();}}};if($scope.dialogData&&$scope.dialogData.macroData){$scope.wizardStep="paramSelect";}
entityResource.getAll("Macro",($scope.dialogData&&$scope.dialogData.richTextEditor&&$scope.dialogData.richTextEditor===true)?"UseInEditor=true":null).then(function(data){if(angular.isArray($scope.dialogData.allowedMacros)&&$scope.dialogData.allowedMacros.length>0){$scope.macros=_.filter(data,function(d){return _.contains($scope.dialogData.allowedMacros,d.alias);});}
else{$scope.macros=data;}
if($scope.dialogData&&$scope.dialogData.macroData&&$scope.dialogData.macroData.macroAlias){var found=_.find(data,function(item){return item.alias===$scope.dialogData.macroData.macroAlias;});if(found){$scope.selectedMacro=found;editParams();return;}}
$scope.wizardStep="macroSelect";});}
angular.module("umbraco").controller("Umbraco.Dialogs.InsertMacroController",InsertMacroController);function LegacyDeleteController($scope,legacyResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;legacyResource.deleteItem({nodeId:$scope.currentNode.id,nodeType:$scope.currentNode.nodeType,alias:$scope.currentNode.name,}).then(function(){$scope.currentNode.loading=false;treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Dialogs.LegacyDeleteController",LegacyDeleteController);angular.module("umbraco").controller("Umbraco.Dialogs.LinkPickerController",function($scope,eventsService,dialogService,entityResource,contentResource,mediaHelper,userService,localizationService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.dialogTreeEventHandler=$({});$scope.target={};$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
if(dialogOptions.currentTarget){$scope.target=dialogOptions.currentTarget;if($scope.target.id){if(!$scope.target.path){entityResource.getPath($scope.target.id,"Document").then(function(path){$scope.target.path=path;$scope.dialogTreeEventHandler.syncTree({path:$scope.target.path,tree:"content"});});}
contentResource.getNiceUrl($scope.target.id).then(function(url){$scope.target.url=url;});}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("dialogs.linkPicker.select",args);if($scope.currentNode){$scope.currentNode.selected=false;}
$scope.currentNode=args.node;$scope.currentNode.selected=true;$scope.target.id=args.node.id;$scope.target.name=args.node.name;if(args.node.id<0){$scope.target.url="/";}
else{contentResource.getNiceUrl(args.node.id).then(function(url){$scope.target.url=url;});}
if(!angular.isUndefined($scope.target.isMedia)){delete $scope.target.isMedia;}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.switchToMediaPicker=function(){userService.getCurrentUser().then(function(userData){dialogService.mediaPicker({startNodeId:userData.startMediaId,callback:function(media){$scope.target.id=media.id;$scope.target.isMedia=true;$scope.target.name=media.name;$scope.target.url=mediaHelper.resolveFile(media);}});});};$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.LoginController",function($scope,localizationService,userService){var d=new Date();localizationService.localize("login_greeting"+d.getDay()).then(function(label){$scope.greeting=label;});$scope.errorMsg="";$scope.loginSubmit=function(login,password){if(login&&password&&login.length>0&&password.length>0){$scope.loginForm.username.$setValidity('auth',true);$scope.loginForm.password.$setValidity('auth',true);}
if($scope.loginForm.$invalid){return;}
userService.authenticate(login,password).then(function(data){$scope.submit(true);},function(reason){$scope.errorMsg=reason.errorMsg;$scope.loginForm.username.$setValidity("auth",false);$scope.loginForm.password.$setValidity("auth",false);});$scope.loginForm.username.$viewChangeListeners.push(function(){if($scope.loginForm.username.$invalid){$scope.loginForm.username.$setValidity('auth',true);}});$scope.loginForm.password.$viewChangeListeners.push(function(){if($scope.loginForm.password.$invalid){$scope.loginForm.password.$setValidity('auth',true);}});};});angular.module("umbraco").controller("Umbraco.Dialogs.MacroPickerController",function($scope,macroFactory,umbPropEditorHelper){$scope.macros=macroFactory.all(true);$scope.dialogMode="list";$scope.configureMacro=function(macro){$scope.dialogMode="configure";$scope.dialogData.macro=macroFactory.getMacro(macro.alias);for(var i=0;i<dialogData.macro.properties.length;i++){dialogData.macro.properties[i].editorView=umbPropEditorHelper.getViewPath(dialogData.macro.properties[i].view);}};});angular.module("umbraco").controller("Umbraco.Dialogs.MediaPickerController",function($scope,mediaResource,umbRequestHelper,entityResource,$log,mediaHelper,eventsService,treeService,$cookies,$element,$timeout){var dialogOptions=$scope.dialogOptions;$scope.onlyImages=dialogOptions.onlyImages;$scope.showDetails=dialogOptions.showDetails;$scope.multiPicker=(dialogOptions.multiPicker&&dialogOptions.multiPicker!=="0")?true:false;$scope.startNodeId=dialogOptions.startNodeId?dialogOptions.startNodeId:-1;$scope.cropSize=dialogOptions.cropSize;$scope.filesUploading=0;$scope.dropping=false;$scope.progress=0;$scope.options={url:umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostAddFile")+"?origin=blueimp",autoUpload:true,dropZone:$element.find(".umb-dialogs-mediapicker.browser"),fileInput:$element.find("input.uploader"),formData:{currentFolder:-1}};$scope.target=undefined;if(dialogOptions.currentTarget){$scope.target=dialogOptions.currentTarget;}
$scope.submitFolder=function(e){if(e.keyCode===13){e.preventDefault();$scope.showFolderInput=false;mediaResource.addFolder($scope.newFolderName,$scope.options.formData.currentFolder).then(function(data){treeService.clearCache({cacheKey:"__media",childrenOf:data.parentId});$scope.gotoFolder(data);});}};$scope.gotoFolder=function(folder){if(!folder){folder={id:-1,name:"Media",icon:"icon-folder"};}
if(folder.id>0){entityResource.getAncestors(folder.id,"media").then(function(anc){$scope.path=_.filter(anc,function(f){return f.path.indexOf($scope.startNodeId)!==-1;});});}
else{$scope.path=[];}
mediaResource.getChildren(folder.id).then(function(data){$scope.searchTerm="";$scope.images=data.items?data.items:[];});$scope.options.formData.currentFolder=folder.id;$scope.currentFolder=folder;};$scope.$on('fileuploadadd',function(e,data){$scope.$apply(function(){$scope.filesUploading++;});});$scope.$on('fileuploaddone',function(e,data){$scope.filesUploading--;if($scope.filesUploading==0){$scope.$apply(function(){$scope.progress=0;$scope.gotoFolder($scope.currentFolder);});}});$scope.$on('fileuploaddragover',function(e,data){if(!$scope.dragClearTimeout){$scope.$apply(function(){$scope.dropping=true;});}
else{$timeout.cancel($scope.dragClearTimeout);}
$scope.dragClearTimeout=$timeout(function(){$scope.dropping=null;$scope.dragClearTimeout=null;},300);});$scope.clickHandler=function(image,ev,select){ev.preventDefault();if(image.isFolder&&!select){$scope.gotoFolder(image);}else{eventsService.emit("dialogs.mediaPicker.select",image);if($scope.multiPicker){$scope.select(image);image.cssclass=($scope.dialogData.selection.indexOf(image)>-1)?"selected":"";}else if($scope.showDetails){$scope.target=image;$scope.target.url=mediaHelper.resolveFile(image);}else{$scope.submit(image);}}};$scope.exitDetails=function(){if(!$scope.currentFolder){$scope.gotoFolder();}
$scope.target=undefined;};if(!$scope.target){$scope.gotoFolder({id:$scope.startNodeId,name:"Media",icon:"icon-folder"});}});angular.module("umbraco").controller("Umbraco.Dialogs.MemberGroupPickerController",function($scope,eventsService,entityResource,searchService,$log){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});$scope.multiPicker=dialogOptions.multiPicker;function select(text,id){if(dialogOptions.multiPicker){$scope.select(id);}
else{$scope.submit(id);}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();eventsService.emit("dialogs.memberGroupPicker.select",args);select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.RteEmbedController",function($scope,$http,umbRequestHelper){$scope.form={};$scope.form.url="";$scope.form.width=360;$scope.form.height=240;$scope.form.constrain=true;$scope.form.preview="";$scope.form.success=false;$scope.form.info="";$scope.form.supportsDimensions=false;var origWidth=500;var origHeight=300;$scope.showPreview=function(){if($scope.form.url){$scope.form.show=true;$scope.form.preview="<div class=\"umb-loader\" style=\"height: 10px; margin: 10px 0px;\"></div>";$scope.form.info="";$scope.form.success=false;$http({method:'GET',url:umbRequestHelper.getApiUrl("embedApiBaseUrl","GetEmbed"),params:{url:$scope.form.url,width:$scope.form.width,height:$scope.form.height}}).success(function(data){$scope.form.preview="";switch(data.Status){case 0:$scope.form.info="Not supported";break;case 1:$scope.form.info="Computer says no";break;case 2:$scope.form.preview=data.Markup;$scope.form.supportsDimensions=data.SupportsDimensions;$scope.form.success=true;break;}}).error(function(){$scope.form.supportsDimensions=false;$scope.form.preview="";$scope.form.info="Computer says no";});}else{$scope.form.supportsDimensions=false;$scope.form.preview="";$scope.form.info="Please enter a URL";}};$scope.changeSize=function(type){var width,height;if($scope.form.constrain){width=parseInt($scope.form.width,10);height=parseInt($scope.form.height,10);if(type=='width'){origHeight=Math.round((width/origWidth)*height);$scope.form.height=origHeight;}else{origWidth=Math.round((height/origHeight)*width);$scope.form.width=origWidth;}}
if($scope.form.url!=""){$scope.showPreview();}};$scope.insert=function(){$scope.submit($scope.form.preview);};});angular.module("umbraco").controller('Umbraco.Dialogs.Template.QueryBuilderController',function($scope,$http,dialogService){$http.get("backoffice/UmbracoApi/TemplateQuery/GetAllowedProperties").then(function(response){$scope.properties=response.data;});$http.get("backoffice/UmbracoApi/TemplateQuery/GetContentTypes").then(function(response){$scope.contentTypes=response.data;});$http.get("backoffice/UmbracoApi/TemplateQuery/GetFilterConditions").then(function(response){$scope.conditions=response.data;});$scope.query={contentType:{name:"Everything"},source:{name:"My website"},filters:[{property:undefined,operator:undefined}],sort:{property:{alias:"",name:"",},direction:"Ascending"}};$scope.chooseSource=function(query){dialogService.contentPicker({callback:function(data){if(data.id>0){query.source={id:data.id,name:data.name};}else{query.source.name="My website";delete query.source.id;}}});};var throttledFunc=_.throttle(function(){$http.post("backoffice/UmbracoApi/TemplateQuery/PostTemplateQuery",$scope.query).then(function(response){$scope.result=response.data;});},200);$scope.$watch("query",function(value){throttledFunc();},true);$scope.getPropertyOperators=function(property){var conditions=_.filter($scope.conditions,function(condition){var index=condition.appliesTo.indexOf(property.type);return index>=0;});return conditions;};$scope.addFilter=function(query){query.filters.push({});};$scope.trashFilter=function(query){query.filters.splice(query,1);};$scope.changeSortOrder=function(query){if(query.sort.direction==="ascending"){query.sort.direction="descending";}else{query.sort.direction="ascending";}};$scope.setSortProperty=function(query,property){query.sort.property=property;if(property.type==="datetime"){query.sort.direction="descending";}else{query.sort.direction="ascending";}};});angular.module("umbraco").controller("Umbraco.Dialogs.TreePickerController",function($scope,entityResource,eventsService,$log,searchService,angularHelper,$timeout,localizationService,treeService){var tree=null;var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});$scope.section=dialogOptions.section;$scope.treeAlias=dialogOptions.treeAlias;$scope.multiPicker=dialogOptions.multiPicker;$scope.hideHeader=true;$scope.searchInfo={searchFromId:dialogOptions.startNodeId,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
$scope.customTreeParams=dialogOptions.startNodeId?"startNodeId="+dialogOptions.startNodeId:"";$scope.customTreeParams+=dialogOptions.customTreeParams?"&"+dialogOptions.customTreeParams:"";var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});var entityType="Document";if(dialogOptions.minNumber){dialogOptions.minNumber=parseInt(dialogOptions.minNumber,10);}
if(dialogOptions.maxNumber){dialogOptions.maxNumber=parseInt(dialogOptions.maxNumber,10);}
if(dialogOptions.section==="member"){entityType="Member";}
else if(dialogOptions.section==="media"){entityType="Media";}
if(dialogOptions.filter){dialogOptions.filterExclude=false;dialogOptions.filterAdvanced=false;if(angular.isFunction(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else if(angular.isObject(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else{if(dialogOptions.filter.startsWith("!")){dialogOptions.filterExclude=true;dialogOptions.filter=dialogOptions.filter.substring(1);}
if(dialogOptions.filter.startsWith("{")){dialogOptions.filterAdvanced=true;dialogOptions.filter=angular.fromJson(dialogOptions.filter);}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,parent:function(){return child;},name:searchText,metaData:{listViewNode:child,},cssClass:"icon-search",cssClasses:["not-published"]}];child.cssClasses.push("tree-node-slide-up");var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return child;}});});}
var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}});performFiltering(args.children);}}
function treeLoadedHandler(ev,args){tree=args.tree;}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;var listViewNode=args.node.parent();listViewNode.cssClasses.push('tree-node-slide-up-hide-active');}
else if(args.node.metaData.isSearchResult){select(args.node.name,args.node.id);var listView=args.node.parent();listView.children=_.reject(listView.children,function(child){return child.id==args.node.id;});$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==args.node.id;});}
else{eventsService.emit("dialogs.treePickerController.select",args);if(args.node.filtered){return;}
select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}}
function select(text,id,entity){if(id<0){if($scope.multiPicker){$scope.select(id);}
else{var node={alias:null,icon:"icon-folder",id:id,name:text};$scope.submit(node);}}
else{if($scope.multiPicker){$scope.select(Number(id));}
else{$scope.hideSearch();if(entity){$scope.submit(entity);}else{entityResource.getById(id,entityType).then(function(ent){$scope.submit(ent);});}}}}
function performFiltering(nodes){if(!dialogOptions.filter){return;}
nodes=_.filter(nodes,function(n){return!angular.isObject(n.metaData.listViewNode);});if(dialogOptions.filterAdvanced){var filtered=angular.isFunction(dialogOptions.filter)?_.filter(nodes,dialogOptions.filter):_.where(nodes,dialogOptions.filter);angular.forEach(filtered,function(value,key){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}});}else{var a=dialogOptions.filter.toLowerCase().split(',');angular.forEach(nodes,function(value,key){var found=a.indexOf(value.metaData.contentType.toLowerCase())>=0;if(!dialogOptions.filterExclude&&!found||dialogOptions.filterExclude&&found){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}}});}}
$scope.multiSubmit=function(result){entityResource.getByIds(result,entityType).then(function(ents){$scope.submit(ents);});};$scope.selectResult=function(evt,result){if(result.filtered){return;}
result.selected=result.selected===true?false:true;select(result.name,result.id,result);if(result.selected){$scope.searchInfo.selectedSearchResults.push(result);}
else{$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==result.id;});}
if(tree){var found=treeService.getDescendantNode(tree.root,result.id);if(found){found.selected=result.selected;}}};$scope.hideSearch=function(){if(tree){function checkChildren(children){_.each(children,function(child){var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}
else if(child.metaData.isSearchResult){var listView=child.parent();listView.children=_.reject(listView.children,function(c){return c.id==child.id;});}
if(child.metaData.isContainer){child.cssClasses=_.reject(child.cssClasses,function(c){return c==='tree-node-slide-up-hide-active';});var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){var childExists=_.find(child.children,function(c){return c.id==item.id;});if(!childExists){var parent=child;child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return parent;}});}});}
if(child.children&&child.children.length>0){checkChildren(child.children);}});}
checkChildren(tree.root.children);}
$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=dialogOptions.startNodeId;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.onSearchResults=function(results){performFiltering(results);results=_.filter(results,function(item){return!item.filtered;});$scope.searchInfo.results=results;_.each($scope.searchInfo.results,function(result){var exists=_.find($scope.dialogData.selection,function(selectedId){return result.id==selectedId;});if(exists){result.selected=true;}});$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.UserController",function($scope,$location,$timeout,userService,historyService,eventsService){$scope.user=userService.getCurrentUser();$scope.history=historyService.getCurrent();$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;var evtHandlers=[];evtHandlers.push(eventsService.on("historyService.add",function(e,args){$scope.history=args.all;}));evtHandlers.push(eventsService.on("historyService.remove",function(e,args){$scope.history=args.all;}));evtHandlers.push(eventsService.on("historyService.removeAll",function(e,args){$scope.history=[];}));$scope.logout=function(){var pendingChangeEvent=eventsService.on("valFormManager.pendingChanges",function(e,args){pendingChangeEvent();$scope.close();});$scope.close();$location.path("/logout");};$scope.gotoHistory=function(link){$location.path(link);$scope.close();};function updateTimeout(){$timeout(function(){if($scope.remainingAuthSeconds>0){$scope.remainingAuthSeconds--;$scope.$digest();updateTimeout();}},1000,false);}
userService.getCurrentUser().then(function(user){$scope.user=user;if($scope.user){$scope.remainingAuthSeconds=$scope.user.remainingAuthSeconds;$scope.canEditProfile=_.indexOf($scope.user.allowedSections,"users")>-1;updateTimeout();}});$scope.$on('$destroy',function(){for(var i=0;i<evtHandlers.length;i++){evtHandlers[i]();}});});function YsodController($scope,legacyResource,treeService,navigationService){if($scope.error&&$scope.error.data&&$scope.error.data.StackTrace){$scope.error.data.StackTrace=$scope.error.data.StackTrace.trim();}
$scope.closeDialog=function(){$scope.dismiss();};}
angular.module("umbraco").controller("Umbraco.Dialogs.YsodController",YsodController);function LegacyController($scope,$routeParams,$element){$scope.legacyPath=decodeURIComponent($routeParams.url);}
angular.module("umbraco").controller('Umbraco.LegacyController',LegacyController);angular.module('umbraco').controller("Umbraco.LoginController",function(eventsService,$scope,userService,$location){userService._showLoginDialog();eventsService.on("app.ready",function(){$scope.avatar="assets/img/application/logo.png";$location.path("/").search("");});});angular.module("umbraco").controller("Umbraco.Notifications.ConfirmRouteChangeController",function($scope,$location,$log,notificationsService){$scope.discard=function(not){not.args.listener();$location.search("");var parts=not.args.path.split("?");var query={};if(parts.length>1){_.each(parts[1].split("&"),function(q){var keyVal=q.split("=");query[keyVal[0]]=keyVal[1];});}
$location.path(parts[0]).search(query);notificationsService.remove(not);};$scope.stay=function(not){notificationsService.remove(not);};});angular.module("umbraco").controller("Umbraco.Editors.Content.CopyController",function($scope,eventsService,contentResource,navigationService,appState,treeService,localizationService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.relateToOriginal=false;$scope.dialogTreeEventHandler=$({});$scope.busy=false;$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("editors.content.copyController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.copy=function(){$scope.busy=true;$scope.error=false;contentResource.copy({parentId:$scope.target.id,id:node.id,relateToOriginal:$scope.relateToOriginal}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"content",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"content",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});function contentCreateController($scope,$routeParams,contentTypeResource,iconHelper){contentTypeResource.getAllowedTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Content.CreateController",contentCreateController);function ContentDeleteController($scope,contentResource,treeService,navigationService,editorState,$location){$scope.performDelete=function(){$scope.currentNode.loading=true;contentResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);if(rootNode){var recycleBin=treeService.getDescendantNode(rootNode,-20);if(recycleBin){recycleBin.hasChildren=true;}}
if(editorState.current&&editorState.current.id==$scope.currentNode.id){$location.path("/content/content/edit/"+$scope.currentNode.parentId);}
navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Content.DeleteController",ContentDeleteController);function ContentEditController($scope,$rootScope,$routeParams,$q,$timeout,$window,appState,contentResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,treeService,fileManager,formHelper,umbRequestHelper,keyboardService,umbModelMapper,editorState,$http){$scope.defaultButton=null;$scope.subButtons=[];$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;$scope.isNew=$routeParams.create;function init(content){var buttons=contentEditingHelper.configureContentEditorButtons({create:$routeParams.create,content:content,methods:{saveAndPublish:$scope.saveAndPublish,sendToPublish:$scope.sendToPublish,save:$scope.save,unPublish:$scope.unPublish}});$scope.defaultButton=buttons.defaultButton;$scope.subButtons=buttons.subButtons;editorState.set($scope.content);if(!$routeParams.create){if(content.parentId&&content.parentId!=-1){entityResource.getAncestors(content.id,"document").then(function(anc){$scope.ancestors=anc.reverse();});}}}
function syncTreeNode(content,path,initialLoad){if(!$scope.content.isChildOfListView){navigationService.syncTree({tree:"content",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});}
else if(initialLoad===true){navigationService.syncTree({tree:"content",path:path.substring(0,path.lastIndexOf(",")).split(","),forceReload:initialLoad!==true});umbRequestHelper.resourcePromise($http.get(content.treeNodeUrl),'Failed to retrieve data for child node '+content.id).then(function(node){$scope.currentNode=node;});}}
function performSave(args){var deferred=$q.defer();contentEditingHelper.contentEditorPerformSave({statusMessage:args.statusMessage,saveMethod:args.saveMethod,scope:$scope,content:$scope.content}).then(function(data){init($scope.content);syncTreeNode($scope.content,data.path);deferred.resolve(data);},function(err){if(err){editorState.set($scope.content);}
deferred.reject(err);});return deferred.promise;}
function resetLastListPageNumber(content){if(!content.isChildOfListView&&!content.isContainer){$rootScope.lastListViewPageViewed=null;}}
if($routeParams.create){contentResource.getScaffold($routeParams.id,$routeParams.doctype).then(function(data){$scope.loaded=true;$scope.content=data;init($scope.content);resetLastListPageNumber($scope.content);});}
else{contentResource.getById($routeParams.id).then(function(data){$scope.loaded=true;$scope.content=data;if(data.isChildOfListView&&data.trashed===false){$scope.listViewPath=($routeParams.page)?"/content/content/edit/"+data.parentId+"?page="+$routeParams.page:"/content/content/edit/"+data.parentId;}
init($scope.content);serverValidationManager.executeAndClearAllSubscriptions();syncTreeNode($scope.content,data.path,true);resetLastListPageNumber($scope.content);});}
$scope.unPublish=function(){if(formHelper.submitForm({scope:$scope,statusMessage:"Unpublishing...",skipValidation:true})){contentResource.unPublish($scope.content.id).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});init($scope.content);syncTreeNode($scope.content,data.path);});}};$scope.sendToPublish=function(){return performSave({saveMethod:contentResource.sendToPublish,statusMessage:"Sending..."});};$scope.saveAndPublish=function(){return performSave({saveMethod:contentResource.publish,statusMessage:"Publishing..."});};$scope.save=function(){return performSave({saveMethod:contentResource.save,statusMessage:"Saving..."});};$scope.preview=function(content){if(!$scope.busy){var previewWindow=$window.open('preview/?id='+content.id,'umbpreview');$scope.save().then(function(data){var redirect=Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath+'/preview/?id='+data.id;previewWindow.location.href=redirect;});}};$scope.performAction=function(btn){if(!btn||!angular.isFunction(btn.handler)){throw"btn.handler must be a function reference";}
if(!$scope.busy){btn.handler.apply(this);}};}
angular.module("umbraco").controller("Umbraco.Editors.Content.EditController",ContentEditController);function ContentEmptyRecycleBinController($scope,contentResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;contentResource.emptyRecycleBin($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeChildNodes($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Content.EmptyRecycleBinController",ContentEmptyRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.Content.MoveController",function($scope,eventsService,contentResource,navigationService,appState,treeService,localizationService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.dialogTreeEventHandler=$({});$scope.busy=false;$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("editors.content.moveController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.move=function(){$scope.busy=true;$scope.error=false;contentResource.move({parentId:$scope.target.id,id:node.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"content",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"content",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});function ContentRecycleBinController($scope,$routeParams,dataTypeResource){$scope.listViewPath=null;$routeParams.id="-20";dataTypeResource.getById(-95).then(function(result){_.each(result.preValues,function(i){$scope.model.config[i.key]=i.value;});$scope.listViewPath='views/propertyeditors/listview/listview.html';});$scope.model={config:{entityType:$routeParams.section}};}
angular.module('umbraco').controller("Umbraco.Editors.Content.RecycleBinController",ContentRecycleBinController);function ContentTypeEditController($scope,$routeParams,$log,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,entityResource){$scope.tabs=[];$scope.page={};$scope.contentType={tabs:[],name:"My content type",alias:"myType",icon:"icon-folder",allowedChildren:[],allowedTemplate:[]};$scope.contentType.tabs=[{name:"Content",properties:[{name:"test"}]},{name:"Generic Properties",properties:[]}];$scope.dataTypesOptions={group:"properties",onDropHandler:function(item,args){args.sourceScope.move(args);},onReleaseHandler:function(item,args){var a=args;}};$scope.tabOptions={group:"tabs",drop:false,nested:true,onDropHandler:function(item,args){},onReleaseHandler:function(item,args){}};$scope.propertiesOptions={group:"properties",onDropHandler:function(item,args){},onReleaseHandler:function(item,args){},};$scope.omg=function(){alert("wat");};entityResource.getAll("Datatype").then(function(data){$scope.page.datatypes=data;});}
angular.module("umbraco").controller("Umbraco.Editors.ContentType.EditController",ContentTypeEditController);function startUpVideosDashboardController($scope,xmlhelper,$log,$http){$scope.videos=[];$scope.init=function(url){var proxyUrl="dashboard/feedproxy.aspx?url="+url;$http.get(proxyUrl).then(function(data){var feed=$(data.data);$('item',feed).each(function(i,item){var video={};video.thumbnail=$(item).find('thumbnail').attr('url');video.title=$("title",item).text();video.link=$("guid",item).text();$scope.videos.push(video);});});};}
angular.module("umbraco").controller("Umbraco.Dashboard.StartupVideosController",startUpVideosDashboardController);function FormsController($scope,$route,$cookieStore,packageResource){$scope.installForms=function(){$scope.state="Installng package";packageResource.fetch("CD44CF39-3D71-4C19-B6EE-948E1FAF0525").then(function(pack){$scope.state="importing";return packageResource.import(pack);},$scope.error).then(function(pack){$scope.state="Installing";return packageResource.installFiles(pack);},$scope.error).then(function(pack){$scope.state="Restarting, please hold...";return packageResource.installData(pack);},$scope.error).then(function(pack){$scope.state="All done, your browser will now refresh";return packageResource.cleanUp(pack);},$scope.error).then($scope.complete,$scope.error);};$scope.complete=function(result){var url=window.location.href+"?init=true";$cookieStore.put("umbPackageInstallId",result.packageGuid);window.location.reload(true);};$scope.error=function(err){$scope.state=undefined;$scope.error=err;};function Video_player(videoId){this.container=document.getElementById(videoId);this.video=this.container.getElementsByTagName('video')[0];this.controls=document.createElement('div');this.controls.className="video-controls";this.seek_bar=document.createElement('input');this.seek_bar.className="seek-bar";this.seek_bar.type="range";this.seek_bar.setAttribute('value','0');this.loader=document.createElement('div');this.loader.className="loader";this.progress_bar=document.createElement('span');this.progress_bar.className="progress-bar";this.controls.appendChild(this.seek_bar);this.container.appendChild(this.controls);this.controls.appendChild(this.loader);this.loader.appendChild(this.progress_bar);}
Video_player.prototype.seeking=function(){var time=this.video.duration*(this.seek_bar.value/100);this.video.currentTime=time;};Video_player.prototype.start_seek=function(){this.video.pause();};Video_player.prototype.stop_seek=function(){this.video.play();};Video_player.prototype.update_progress_bar=function(){var value=(100/this.video.duration)*this.video.currentTime;this.progress_bar.style.width=value+'%';};Video_player.prototype.handle_mouse_move=function(event){var pos=this.progress_bar.getBoundingClientRect().left;event=event||window.event;this.progress_bar.style.width=(event.clientX-pos)+"px";};Video_player.prototype.video_event_handler=function(videoPlayer,interval){var animate_progress_bar=setInterval(function(){videoPlayer.update_progress_bar();},interval);videoPlayer.seek_bar.addEventListener("change",function(){videoPlayer.seeking();});videoPlayer.seek_bar.addEventListener("mousedown",function(clickEvent){videoPlayer.start_seek();clearInterval(animate_progress_bar);videoPlayer.handle_mouse_move(clickEvent);window.onmousemove=function(moveEvent){videoPlayer.handle_mouse_move(moveEvent);};});videoPlayer.seek_bar.addEventListener("mouseup",function(){window.onmousemove=null;videoPlayer.stop_seek();animate_progress_bar=setInterval(function(){videoPlayer.update_progress_bar();},interval);});};var videoPlayer=new Video_player('video_1');videoPlayer.video_event_handler(videoPlayer,17);}
angular.module("umbraco").controller("Umbraco.Dashboard.FormsDashboardController",FormsController);function startupLatestEditsController($scope){}
angular.module("umbraco").controller("Umbraco.Dashboard.StartupLatestEditsController",startupLatestEditsController);function MediaFolderBrowserDashboardController($rootScope,$scope,assetsService,$routeParams,$timeout,$element,$location,umbRequestHelper,navigationService,mediaResource,$cookies){var dialogOptions=$scope.dialogOptions;$scope.filesUploading=[];$scope.nodeId=-1;$scope.onUploadComplete=function(){navigationService.reloadSection("media");}}
angular.module("umbraco").controller("Umbraco.Dashboard.MediaFolderBrowserDashboardController",MediaFolderBrowserDashboardController);function ChangePasswordDashboardController($scope,xmlhelper,$log,currentUserResource,formHelper){$scope.changePasswordModel={alias:"_umb_password",view:"changepassword",config:{},value:{}};currentUserResource.getMembershipProviderConfig().then(function(data){$scope.changePasswordModel.config=data;$scope.changePasswordModel.config.hasPassword=true;$scope.changePasswordModel.config.disableToggle=true;});$scope.changePassword=function(){if(formHelper.submitForm({scope:$scope})){currentUserResource.changePassword($scope.changePasswordModel.value).then(function(data){if(data.value){$scope.changePasswordModel.value.generatedPassword=data.value;}
formHelper.resetForm({scope:$scope,notifications:data.notifications});},function(err){formHelper.handleError(err);});}};}
angular.module("umbraco").controller("Umbraco.Dashboard.StartupChangePasswordController",ChangePasswordDashboardController);function examineMgmtController($scope,umbRequestHelper,$log,$http,$q,$timeout){$scope.indexerDetails=[];$scope.searcherDetails=[];$scope.loading=true;function checkProcessing(indexer,checkActionName){umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl",checkActionName,{indexerName:indexer.name})),'Failed to check index processing').then(function(data){if(data){for(var k in data){indexer[k]=data[k];}
indexer.isProcessing=false;}
else{$timeout(function(){if(indexer.processingAttempts<100){checkProcessing(indexer,checkActionName);indexer.processingAttempts++;}
else{indexer.isProcessing=false;}},1000);}});}
$scope.search=function(searcher,e){if(e&&e.keyCode!==13){return;}
umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetSearchResults",{searcherName:searcher.name,query:searcher.searchText,queryType:searcher.searchType})),'Failed to search').then(function(searchResults){searcher.isSearching=true;searcher.searchResults=searchResults;});}
$scope.toggle=function(provider,propName){if(provider[propName]!==undefined){provider[propName]=!provider[propName];}
else{provider[propName]=true;}}
$scope.rebuildIndex=function(indexer){if(confirm("This will cause the index to be rebuilt. "+"Depending on how much content there is in your site this could take a while. "+"It is not recommended to rebuild an index during times of high website traffic "+"or when editors are editing content.")){indexer.isProcessing=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","PostRebuildIndex",{indexerName:indexer.name})),'Failed to rebuild index').then(function(){$timeout(function(){checkProcessing(indexer,"PostCheckRebuildIndex");},1000);});}}
$scope.optimizeIndex=function(indexer){if(confirm("This will cause the index to be optimized which will improve its performance. "+"It is not recommended to optimize an index during times of high website traffic "+"or when editors are editing content.")){indexer.isProcessing=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","PostOptimizeIndex",{indexerName:indexer.name})),'Failed to optimize index').then(function(){$timeout(function(){checkProcessing(indexer,"PostCheckOptimizeIndex");},1000);});}}
$scope.closeSearch=function(searcher){searcher.isSearching=true;}
$q.all([umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetIndexerDetails")),'Failed to retrieve indexer details').then(function(data){$scope.indexerDetails=data;}),umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetSearcherDetails")),'Failed to retrieve searcher details').then(function(data){$scope.searcherDetails=data;for(var s in $scope.searcherDetails){$scope.searcherDetails[s].searchType="text";}})]).then(function(){$scope.loading=false;});}
angular.module("umbraco").controller("Umbraco.Dashboard.ExamineMgmtController",examineMgmtController);function xmlDataIntegrityReportController($scope,umbRequestHelper,$log,$http,$q,$timeout){function check(item){var action=item.check;umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("xmlDataIntegrityBaseUrl",action)),'Failed to retrieve data integrity status').then(function(result){item.checking=false;item.invalid=result==="false";});}
$scope.fix=function(item){var action=item.fix;if(item.fix){if(confirm("This will cause all xml structures for this type to be rebuilt. "+"Depending on how much content there is in your site this could take a while. "+"It is not recommended to rebuild xml structures if they are not out of sync, during times of high website traffic "+"or when editors are editing content.")){item.fixing=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("xmlDataIntegrityBaseUrl",action)),'Failed to retrieve data integrity status').then(function(result){item.fixing=false;item.invalid=result==="false";});}}}
$scope.items={"contentXml":{label:"Content in the cmsContentXml table",checking:true,fixing:false,fix:"FixContentXmlTable",check:"CheckContentXmlTable"},"mediaXml":{label:"Media in the cmsContentXml table",checking:true,fixing:false,fix:"FixMediaXmlTable",check:"CheckMediaXmlTable"},"memberXml":{label:"Members in the cmsContentXml table",checking:true,fixing:false,fix:"FixMembersXmlTable",check:"CheckMembersXmlTable"}};for(var i in $scope.items){check($scope.items[i]);}}
angular.module("umbraco").controller("Umbraco.Dashboard.XmlDataIntegrityReportController",xmlDataIntegrityReportController);function DataTypeDeleteController($scope,dataTypeResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;dataTypeResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.DataType.DeleteController",DataTypeDeleteController);function DataTypeEditController($scope,$routeParams,$location,appState,navigationService,treeService,dataTypeResource,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,formHelper,editorState){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;function createPreValueProps(preVals){$scope.preValues=[];for(var i=0;i<preVals.length;i++){$scope.preValues.push({hideLabel:preVals[i].hideLabel,alias:preVals[i].key,description:preVals[i].description,label:preVals[i].label,view:preVals[i].view,value:preVals[i].value});}}
$scope.properties={selectedEditor:{alias:"selectedEditor",description:"Select a property editor",label:"Property editor"},selectedEditorId:{alias:"selectedEditorId",label:"Property editor alias"}};$scope.preValues=[];if($routeParams.create){dataTypeResource.getScaffold().then(function(data){$scope.loaded=true;$scope.preValuesLoaded=true;$scope.content=data;editorState.set($scope.content);});}
else{dataTypeResource.getById($routeParams.id).then(function(data){$scope.loaded=true;$scope.preValuesLoaded=true;$scope.content=data;createPreValueProps($scope.content.preValues);editorState.set($scope.content);serverValidationManager.executeAndClearAllSubscriptions();navigationService.syncTree({tree:"datatype",path:[String(data.id)]}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});});}
$scope.$watch("content.selectedEditor",function(newVal,oldVal){if(newVal&&(newVal!=oldVal&&(oldVal||$routeParams.create))){var currDataTypeId=$routeParams.create?undefined:$routeParams.id;dataTypeResource.getPreValues(newVal,currDataTypeId).then(function(data){$scope.preValuesLoaded=true;$scope.content.preValues=data;createPreValueProps($scope.content.preValues);editorState.set($scope.content);});}});$scope.save=function(){if(formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){dataTypeResource.save($scope.content,$scope.preValues,$routeParams.create).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:function(){createPreValueProps(data.preValues);}});editorState.set($scope.content);navigationService.syncTree({tree:"datatype",path:[String(data.id)],forceReload:true}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});},function(err){contentEditingHelper.handleSaveError({redirectOnFailure:false,err:err});editorState.set($scope.content);});}};}
angular.module("umbraco").controller("Umbraco.Editors.DataType.EditController",DataTypeEditController);function mediaCreateController($scope,$routeParams,mediaTypeResource,iconHelper){mediaTypeResource.getAllowedTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Media.CreateController",mediaCreateController);function MediaDeleteController($scope,mediaResource,treeService,navigationService,editorState,$location){$scope.performDelete=function(){$scope.currentNode.loading=true;mediaResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);if(rootNode){var recycleBin=treeService.getDescendantNode(rootNode,-21);if(recycleBin){recycleBin.hasChildren=true;}}
if(editorState.current&&editorState.current.id==$scope.currentNode.id){$location.path("/media/media/edit/"+$scope.currentNode.parentId);}
navigationService.hideMenu();},function(){$scope.currentNode.loading=false;});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Media.DeleteController",MediaDeleteController);function mediaEditController($scope,$routeParams,appState,mediaResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,treeService,formHelper,umbModelMapper,editorState,umbRequestHelper,$http){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;function syncTreeNode(content,path,initialLoad){if(!$scope.content.isChildOfListView){navigationService.syncTree({tree:"media",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});}
else if(initialLoad===true){navigationService.syncTree({tree:"media",path:path.substring(0,path.lastIndexOf(",")).split(","),forceReload:initialLoad!==true});umbRequestHelper.resourcePromise($http.get(content.treeNodeUrl),'Failed to retrieve data for child node '+content.id).then(function(node){$scope.currentNode=node;});}}
if($routeParams.create){mediaResource.getScaffold($routeParams.id,$routeParams.doctype).then(function(data){$scope.loaded=true;$scope.content=data;editorState.set($scope.content);});}
else{mediaResource.getById($routeParams.id).then(function(data){$scope.loaded=true;$scope.content=data;if(data.isChildOfListView&&data.trashed===false){$scope.listViewPath=($routeParams.page)?"/media/media/edit/"+data.parentId+"?page="+$routeParams.page:"/media/media/edit/"+data.parentId;}
editorState.set($scope.content);serverValidationManager.executeAndClearAllSubscriptions();syncTreeNode($scope.content,data.path,true);if($scope.content.parentId&&$scope.content.parentId!=-1){entityResource.getAncestors($routeParams.id,"media").then(function(anc){$scope.ancestors=anc.reverse();});}});}
$scope.save=function(){if(!$scope.busy&&formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){$scope.busy=true;mediaResource.save($scope.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});editorState.set($scope.content);$scope.busy=false;syncTreeNode($scope.content,data.path);},function(err){contentEditingHelper.handleSaveError({err:err,redirectOnFailure:true,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,err.data)});editorState.set($scope.content);$scope.busy=false;});}else{$scope.busy=false;}};}
angular.module("umbraco").controller("Umbraco.Editors.Media.EditController",mediaEditController);function MediaEmptyRecycleBinController($scope,mediaResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;mediaResource.emptyRecycleBin($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeChildNodes($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Media.EmptyRecycleBinController",MediaEmptyRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.Media.MoveController",function($scope,eventsService,mediaResource,appState,treeService,navigationService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();eventsService.emit("editors.media.moveController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.move=function(){mediaResource.move({parentId:$scope.target.id,id:node.id}).then(function(path){$scope.error=false;$scope.success=true;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"media",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"media",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;});};$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});function MediaRecycleBinController($scope,$routeParams,dataTypeResource){$scope.listViewPath=null;$routeParams.id="-21";dataTypeResource.getById(-96).then(function(result){_.each(result.preValues,function(i){$scope.model.config[i.key]=i.value;});$scope.listViewPath='views/propertyeditors/listview/listview.html';});$scope.model={config:{entityType:$routeParams.section}};}
angular.module('umbraco').controller("Umbraco.Editors.Media.RecycleBinController",MediaRecycleBinController);function memberCreateController($scope,$routeParams,memberTypeResource,iconHelper){memberTypeResource.getTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Member.CreateController",memberCreateController);function MemberDeleteController($scope,memberResource,treeService,navigationService,editorState,$location,$routeParams){$scope.performDelete=function(){$scope.currentNode.loading=true;memberResource.deleteByKey($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeNode($scope.currentNode);if(editorState.current&&editorState.current.key==$scope.currentNode.id){$location.path("/member/member/list/"+($routeParams.listName?$routeParams.listName:'all-members'));}
navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Member.DeleteController",MemberDeleteController);function MemberEditController($scope,$routeParams,$location,$q,$window,appState,memberResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,formHelper,umbModelMapper,editorState,umbRequestHelper,$http){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;$scope.listViewPath=($routeParams.page&&$routeParams.listName)?"/member/member/list/"+$routeParams.listName+"?page="+$routeParams.page:null;function buildTreePath(data){return $routeParams.listName?"-1,"+$routeParams.listName:"-1";}
if($routeParams.create){if($routeParams.doctype){memberResource.getScaffold($routeParams.doctype).then(function(data){$scope.loaded=true;$scope.content=data;editorState.set($scope.content);});}
else{memberResource.getScaffold().then(function(data){$scope.loaded=true;$scope.content=data;editorState.set($scope.content);});}}
else{if($routeParams.id&&$routeParams.id.length<9){entityResource.getById($routeParams.id,"Member").then(function(entity){$location.path("member/member/edit/"+entity.key);});}
else{memberResource.getByKey($routeParams.id).then(function(data){$scope.loaded=true;$scope.content=data;editorState.set($scope.content);var path=buildTreePath(data);navigationService.syncTree({tree:"member",path:path.split(",")});umbRequestHelper.resourcePromise($http.get(data.treeNodeUrl),'Failed to retrieve data for child node '+data.key).then(function(node){$scope.currentNode=node;});serverValidationManager.executeAndClearAllSubscriptions();});}}
$scope.save=function(){if(!$scope.busy&&formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){$scope.busy=true;memberResource.save($scope.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,redirectId:data.key,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});editorState.set($scope.content);$scope.busy=false;var path=buildTreePath(data);navigationService.syncTree({tree:"member",path:path.split(","),forceReload:true});},function(err){contentEditingHelper.handleSaveError({redirectOnFailure:false,err:err,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,err.data)});editorState.set($scope.content);$scope.busy=false;});}else{$scope.busy=false;}};}
angular.module("umbraco").controller("Umbraco.Editors.Member.EditController",MemberEditController);function MemberListController($scope,$routeParams,$location,$q,$window,appState,memberResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,formHelper,umbModelMapper,editorState){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;memberResource.getListNode($routeParams.id).then(function(data){$scope.loaded=true;$scope.content=data;editorState.set($scope.content);navigationService.syncTree({tree:"member",path:data.path.split(",")}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});serverValidationManager.executeAndClearAllSubscriptions();});}
angular.module("umbraco").controller("Umbraco.Editors.Member.ListController",MemberListController);function imageFilePickerController($scope,dialogService,mediaHelper){$scope.pick=function(){dialogService.mediaPicker({multiPicker:false,callback:function(data){$scope.model.value=mediaHelper.resolveFile(data,false);}});};}
angular.module('umbraco').controller("Umbraco.PrevalueEditors.ImageFilePickerController",imageFilePickerController);function mediaPickerController($scope,dialogService,entityResource,$log,iconHelper){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];var dialogOptions={multiPicker:false,entityType:"Media",section:"media",treeAlias:"media",callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}
else{$scope.clear();$scope.add(data);}}};$scope.openContentPicker=function(){var d=dialogService.treePicker(dialogOptions);};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.clear=function(){$scope.renderModel=[];};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});}};$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,dialogOptions.entityType).then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
angular.module('umbraco').controller("Umbraco.PrevalueEditors.MediaPickerController",mediaPickerController);angular.module("umbraco").controller("Umbraco.PrevalueEditors.MultiValuesController",function($scope,$timeout){$scope.newItem="";$scope.hasError=false;if(!angular.isArray($scope.model.value)){var items=[];for(var i in $scope.model.value){items.push({value:$scope.model.value[i].value,sortOrder:$scope.model.value[i].sortOrder,id:i});}
items.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.value=items;}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.value===item.value;});};$scope.add=function(evt){evt.preventDefault();if($scope.newItem){if(!_.contains($scope.model.value,$scope.newItem)){$scope.model.value.push({value:$scope.newItem});$scope.newItem="";$scope.hasError=false;return;}}
$scope.hasError=true;};$scope.sortableOptions={axis:'y',containment:'parent',cursor:'move',items:'> div.control-group',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedPrevalueText=$('input[type="text"]',ui.item).val();var originalIndex=getElementIndexByPrevalueText(movedPrevalueText);if(originalIndex>-1){var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);}}};function getElementIndexByPrevalueText(value){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].value===value){return i;}}
return-1;}});angular.module('umbraco').controller("Umbraco.PrevalueEditors.TreePickerController",function($scope,dialogService,entityResource,$log,iconHelper){$scope.renderModel=[];$scope.ids=[];var config={multiPicker:false,entityType:"Document",type:"content",treeAlias:"content"};if($scope.model.value){$scope.ids=$scope.model.value.split(',');entityResource.getByIds($scope.ids,config.entityType).then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
$scope.openContentPicker=function(){var d=dialogService.treePicker({section:config.type,treeAlias:config.type,multiPicker:config.multiPicker,callback:populate});};$scope.remove=function(index){$scope.renderModel.splice(index,1);$scope.ids.splice(index,1);$scope.model.value=trim($scope.ids.join(),",");};$scope.clear=function(){$scope.model.value="";$scope.renderModel=[];$scope.ids=[];};$scope.add=function(item){if($scope.ids.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.ids.push(item.id);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});$scope.model.value=trim($scope.ids.join(),",");}};$scope.$on("formSubmitting",function(ev,args){$scope.model.value=trim($scope.ids.join(),",");});function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
function populate(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}}});angular.module('umbraco').controller("Umbraco.PrevalueEditors.TreeSourceController",function($scope,dialogService,entityResource,$log,iconHelper){if(!$scope.model){$scope.model={};}
if(!$scope.model.value){$scope.model.value={type:"content"};}
if($scope.model.value.id&&$scope.model.value.type!=="member"){var ent="Document";if($scope.model.value.type==="media"){ent="Media";}
entityResource.getById($scope.model.value.id,ent).then(function(item){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;});}
$scope.openContentPicker=function(){var d=dialogService.treePicker({section:$scope.model.value.type,treeAlias:$scope.model.value.type,multiPicker:false,callback:populate});};$scope.clear=function(){$scope.model.value.id=undefined;$scope.node=undefined;$scope.model.value.query=undefined;};$scope.$on("formSubmitting",function(ev,args){if($scope.model.value.type==="member"){$scope.model.value.id=-1;$scope.model.value.query="";}});function populate(item){$scope.clear();item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;$scope.model.value.id=item.id;}});function booleanEditorController($scope,$rootScope,assetsService){function setupViewModel(){$scope.renderModel={value:false};if($scope.model&&$scope.model.value&&($scope.model.value.toString()==="1"||angular.lowercase($scope.model.value)==="true")){$scope.renderModel.value=true;}}
setupViewModel();$scope.$watch("renderModel.value",function(newVal){$scope.model.value=newVal===true?"1":"0";});$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};}
angular.module("umbraco").controller("Umbraco.PropertyEditors.BooleanController",booleanEditorController);angular.module("umbraco").controller("Umbraco.PropertyEditors.ChangePasswordController",function($scope,$routeParams){function resetModel(isNew){if(!$scope.model.config||$scope.model.config.disableToggle===undefined){$scope.model.config.disableToggle=false;}
if(!$scope.model.config||$scope.model.config.hasPassword===undefined){$scope.model.config.hasPassword=false;}
if(!$scope.model.config||$scope.model.config.enablePasswordRetrieval===undefined){$scope.model.config.enablePasswordRetrieval=true;}
if(!$scope.model.config||$scope.model.config.requiresQuestionAnswer===undefined){$scope.model.config.requiresQuestionAnswer=false;}
if(!$scope.model.config||$scope.model.config.enableReset===undefined){$scope.model.config.enableReset=true;}
if(!$scope.model.config||$scope.model.config.minPasswordLength===undefined){$scope.model.config.minPasswordLength=0;}
if(!angular.isObject($scope.model.value)){$scope.model.value={newPassword:null,oldPassword:null,reset:null,answer:null};}
else{if(!isNew){$scope.model.value.newPassword=null;$scope.model.value.oldPassword=null;}
$scope.model.value.reset=null;$scope.model.value.answer=null;}
if(!isNew){$scope.model.confirm="";}
else if($scope.model.value.newPassword.length>0){$scope.model.confirm=$scope.model.value.newPassword;}}
resetModel($routeParams.create);$scope.changing=$scope.model.config.disableToggle===true||!$scope.model.config.hasPassword;if(!$scope.changing){$scope.model.value=null;}
$scope.doChange=function(){resetModel();$scope.changing=true;$scope.model.value.generatedPassword=null;};$scope.cancelChange=function(){$scope.changing=false;$scope.model.value=null;};$scope.$on("formSubmitted",function(){if($scope.model.config.disableToggle===false){$scope.changing=false;}});$scope.$on("formSubmitting",function(){if($scope.changing&&$scope.model.value){$scope.model.value.generatedPassword=null;}
else if(!$scope.changing){$scope.model.value=null;}});$scope.showReset=function(){return $scope.model.config.hasPassword&&$scope.model.config.enableReset;};$scope.showOldPass=function(){return $scope.model.config.hasPassword&&!$scope.model.config.allowManuallyChangingPassword&&!$scope.model.config.enablePasswordRetrieval&&!$scope.model.value.reset;};$scope.showNewPass=function(){return!$scope.model.value.reset;};$scope.showConfirmPass=function(){return!$scope.model.value.reset;};$scope.showCancelBtn=function(){return $scope.model.config.disableToggle!==true&&$scope.model.config.hasPassword;};});angular.module("umbraco").controller("Umbraco.PropertyEditors.CheckboxListController",function($scope){if(angular.isObject($scope.model.config.items)){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:vals[i].value});}
newItems.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.config.items=newItems;}
function setupViewModel(){$scope.selectedItems=[];if($scope.model.value===null||$scope.model.value===undefined){$scope.model.value=[];}
for(var i=0;i<$scope.model.config.items.length;i++){var isChecked=_.contains($scope.model.value,$scope.model.config.items[i].id);$scope.selectedItems.push({checked:isChecked,key:$scope.model.config.items[i].id,val:$scope.model.config.items[i].value});}}
setupViewModel();$scope.$watch("selectedItems",function(newVal,oldVal){$scope.model.value=[];for(var x=0;x<$scope.selectedItems.length;x++){if($scope.selectedItems[x].checked){$scope.model.value.push($scope.selectedItems[x].key);}}},true);$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};});function ColorPickerController($scope){$scope.toggleItem=function(color){if($scope.model.value==color){$scope.model.value="";$scope.propertyForm.modelValue.$setViewValue($scope.model.value);}
else{$scope.model.value=color;$scope.propertyForm.modelValue.$setViewValue($scope.model.value);}};$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||($scope.model.value!=null&&$scope.model.value!=""),errorMsg:"Value cannot be empty",errorKey:"required"};}
$scope.isConfigured=$scope.model.config&&$scope.model.config.items&&_.keys($scope.model.config.items).length>0;}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ColorPickerController",ColorPickerController);angular.module("umbraco").controller("Umbraco.PrevalueEditors.MultiColorPickerController",function($scope,$timeout,assetsService,angularHelper,$element){var defaultColor="000000";$scope.newColor=defaultColor;$scope.hasError=false;assetsService.load(["lib/spectrum/spectrum.js"]).then(function(){var elem=$element.find("input");elem.spectrum({color:null,showInitial:false,chooseText:"choose",cancelText:"cancel",preferredFormat:"hex",showInput:true,clickoutFiresChange:true,hide:function(color){$element.find(".btn.add").show();},change:function(color){angularHelper.safeApply($scope,function(){$scope.newColor=color.toHexString().trimStart("#");});},show:function(){$element.find(".btn.add").hide();}});});if(!angular.isArray($scope.model.value)){var items=[];for(var i in $scope.model.value){items.push({value:$scope.model.value[i],id:i});}
$scope.model.value=items;}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.value===item.value;});};$scope.add=function(evt){evt.preventDefault();if($scope.newColor){var exists=_.find($scope.model.value,function(item){return item.value.toUpperCase()==$scope.newColor.toUpperCase();});if(!exists){$scope.model.value.push({value:$scope.newColor});$scope.hasError=false;return;}
$scope.hasError=true;}};assetsService.loadCss("lib/spectrum/spectrum.css");});function contentPickerController($scope,dialogService,entityResource,editorState,$log,iconHelper,$routeParams,fileManager,contentEditingHelper){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
function startWatch(){$scope.$watch(function(){return _.map($scope.renderModel,function(i){return i.id;}).join();},function(newVal){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");if($scope.model.config&&$scope.model.config.minNumber&&parseInt($scope.model.config.minNumber)>$scope.renderModel.length){$scope.contentPickerForm.minCount.$setValidity("minCount",false);}
else{$scope.contentPickerForm.minCount.$setValidity("minCount",true);}
if($scope.model.config&&$scope.model.config.maxNumber&&parseInt($scope.model.config.maxNumber)<$scope.renderModel.length){$scope.contentPickerForm.maxCount.$setValidity("maxCount",false);}
else{$scope.contentPickerForm.maxCount.$setValidity("maxCount",true);}});}
$scope.renderModel=[];$scope.dialogEditor=editorState&&editorState.current&&editorState.current.isDialogEditor===true;var defaultConfig={multiPicker:false,showEditButton:false,startNode:{query:"",type:"content",id:-1}};if($scope.model.config){$scope.model.config=angular.extend(defaultConfig,$scope.model.config);}
$scope.model.config.multiPicker=($scope.model.config.multiPicker==="1"?true:false);$scope.model.config.showEditButton=($scope.model.config.showEditButton==="1"?true:false);var entityType=$scope.model.config.startNode.type==="member"?"Member":$scope.model.config.startNode.type==="media"?"Media":"Document";var dialogOptions={multiPicker:$scope.model.config.multiPicker,entityType:entityType,filterCssClass:"not-allowed not-published",startNodeId:null,callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}},treeAlias:$scope.model.config.startNode.type,section:$scope.model.config.startNode.type};angular.extend(dialogOptions,$scope.model.config);if(entityType==="Member"){dialogOptions.filterCssClass="not-allowed";var currFilter=dialogOptions.filter;dialogOptions.filter=function(i){if(i.metaData.isContainer){return true;}
if(!currFilter){return false;}
var filterItem=currFilter.toLowerCase().split(',');var found=filterItem.indexOf(i.metaData.contentType.toLowerCase())>=0;if(!currFilter.startsWith("!")&&!found||currFilter.startsWith("!")&&found){return true;}
return false;}}
if($scope.model.config.startNode.query){var rootId=$routeParams.id;entityResource.getByQuery($scope.model.config.startNode.query,rootId,"Document").then(function(ent){dialogOptions.startNodeId=ent.id;});}else{dialogOptions.startNodeId=$scope.model.config.startNode.id;}
$scope.openContentPicker=function(){var d=dialogService.treePicker(dialogOptions);};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});}};$scope.clear=function(){$scope.renderModel=[];};$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,entityType).then(function(data){_.each(modelIds,function(id,i){var entity=_.find(data,function(d){return d.id==id;});entity.icon=iconHelper.convertFromLegacyIcon(entity.icon);$scope.renderModel.push({name:entity.name,id:entity.id,icon:entity.icon});});startWatch();});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.ContentPickerController",contentPickerController);function dateTimePickerController($scope,notificationsService,assetsService,angularHelper,userService,$element){var config={pickDate:true,pickTime:true,useSeconds:true,format:"YYYY-MM-DD HH:mm:ss",icons:{time:"icon-time",date:"icon-calendar",up:"icon-chevron-up",down:"icon-chevron-down"}};$scope.model.config=angular.extend(config,$scope.model.config);$scope.hidePicker=function(){$element.find("div:first").datetimepicker("hide");};$(document).bind("click",$scope.hidePicker);function applyDate(e){angularHelper.safeApply($scope,function(){if(e.date){if($scope.model.config.pickTime){$scope.model.value=e.date.format("YYYY-MM-DD HH:mm:ss");}
else{$scope.model.value=e.date.format("YYYY-MM-DD");}}
if(!$scope.model.config.pickTime){$element.find("div:first").datetimepicker("hide",0);}});}
userService.getCurrentUser().then(function(user){assetsService.loadCss('lib/datetimepicker/bootstrap-datetimepicker.min.css').then(function(){var filesToLoad=["lib/moment/moment-with-locales.js","lib/datetimepicker/bootstrap-datetimepicker.js"];$scope.model.config.language=user.locale;assetsService.load(filesToLoad).then(function(){var pickerId=$scope.model.alias;$element.find("div:first").datetimepicker($scope.model.config).on("dp.change",applyDate);$element.find("div:first").datetimepicker("setValue",$scope.model.value?$scope.model.value:null);$scope.$on('$destroy',function(){$element.find("div:first").datetimepicker("destroy");});});});});$scope.$on('$destroy',function(){$(document).unbind("click",$scope.hidePicker);});}
angular.module("umbraco").controller("Umbraco.PropertyEditors.DatepickerController",dateTimePickerController);angular.module("umbraco").controller("Umbraco.PropertyEditors.DropdownController",function($scope){var config={items:[],multiple:false};angular.extend(config,$scope.model.config);$scope.model.config=config;function convertArrayToDictionaryArray(model){var newItems=[];for(var i=0;i<model.length;i++){newItems.push({id:model[i],sortOrder:0,value:model[i]});}
return newItems;}
function convertObjectToDictionaryArray(model){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){var label=vals[i].value?vals[i].value:vals[i];newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:label});}
return newItems;}
if(angular.isArray($scope.model.config.items)){if(!angular.isObject($scope.model.config.items[0])){$scope.model.config.items=convertArrayToDictionaryArray($scope.model.config.items);}}
else if(angular.isObject($scope.model.config.items)){$scope.model.config.items=convertObjectToDictionaryArray($scope.model.config.items);}
else{throw"The items property must be either an array or a dictionary";}
$scope.model.config.items.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});if($scope.model.value===null||$scope.model.value===undefined){if($scope.model.config.multiple){$scope.model.value=[];}
else{$scope.model.value="";}}});function entityPicker($scope,entityResource){if(!$scope.model.config.entityType){$scope.model.config.entityType="DocumentType";}
if(!$scope.model.config.publishBy){$scope.selectOptions="entity.id as entity.name for entity in entities";}
else{$scope.selectOptions="entity."+$scope.model.config.publishBy+" as entity.name for entity in entities";}
entityResource.getAll($scope.model.config.entityType).then(function(data){_.each(data,function(d){d.id=d.id.toString();});$scope.entities=data;});if($scope.model.value===null||$scope.model.value===undefined){if($scope.model.config.multiple){$scope.model.value=[];}
else{$scope.model.value="";}}
else{if($scope.model.config.multiple==="1"){if(_.isString($scope.model.value)){$scope.model.value=$scope.model.value.split(',');}}}}
angular.module('umbraco').controller("Umbraco.PropertyEditors.EntityPickerController",entityPicker);function fileUploadController($scope,$element,$compile,imageHelper,fileManager,umbRequestHelper,mediaHelper){function clearFiles(){fileManager.setFiles($scope.model.alias,[]);$scope.files=[];if($scope.propertyForm.fileCount){$scope.propertyForm.fileCount.$setViewValue($scope.files.length);}}
function initialize(index){clearFiles();if(!index){index=1;}
$scope.rebuildInput={index:index};$scope.files=[];$scope.originalValue=$scope.model.value;if($scope.model.value!=""){var images=$scope.model.value.split(",");$scope.persistedFiles=_.map(images,function(item){return{file:item,isImage:imageHelper.detectIfImageByExtension(item)};});}
else{$scope.persistedFiles=[];}
_.each($scope.persistedFiles,function(file){var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:file.file}]);file.thumbnail=thumbnailUrl;});$scope.clearFiles=false;}
initialize();$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||((($scope.persistedFiles!=null&&$scope.persistedFiles.length>0)||($scope.files!=null&&$scope.files.length>0))&&!$scope.clearFiles),errorMsg:"Value cannot be empty",errorKey:"required"};}
$scope.$watch("clearFiles",function(isCleared){if(isCleared==true){$scope.model.value={clearFiles:true};clearFiles();}
else{$scope.model.value=$scope.originalValue;$scope.propertyForm.fileCount.$setViewValue($scope.files.length);}});$scope.$on("filesSelected",function(event,args){$scope.$apply(function(){fileManager.setFiles($scope.model.alias,args.files);$scope.files=[];var newVal="";for(var i=0;i<args.files.length;i++){$scope.files.push({alias:$scope.model.alias,file:args.files[i]});newVal+=args.files[i].name+",";}
$scope.propertyForm.fileCount.$setViewValue($scope.files.length);$scope.clearFiles=false;$scope.model.value={selectedFiles:newVal.trimEnd(",")};});});$scope.$watch("model.value",function(newVal,oldVal){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){if(newVal.clearFiles!==true&&newVal!==$scope.originalValue&&!newVal.selectedFiles){initialize($scope.rebuildInput.index+1);}}});};angular.module("umbraco").controller('Umbraco.PropertyEditors.FileUploadController',fileUploadController).run(function(mediaHelper,umbRequestHelper){if(mediaHelper&&mediaHelper.registerFileResolver){mediaHelper.registerFileResolver("Umbraco.UploadField",function(property,entity,thumbnail){if(thumbnail){if(mediaHelper.detectIfImageByExtension(property.value)){var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:property.value}]);return thumbnailUrl;}
else{return null;}}
else{return property.value;}});}});angular.module("umbraco").controller("Umbraco.PropertyEditors.FolderBrowserController",function($rootScope,$scope,$routeParams,$timeout,editorState,navigationService){var dialogOptions=$scope.dialogOptions;$scope.creating=$routeParams.create;$scope.nodeId=$routeParams.id;$scope.onUploadComplete=function(){var path=editorState.current.path;navigationService.syncTree({tree:"media",path:path,forceReload:false}).then(function(syncArgs){navigationService.reloadNode(syncArgs.node);});}});angular.module("umbraco").controller("Umbraco.PropertyEditors.GoogleMapsController",function($rootScope,$scope,notificationsService,dialogService,assetsService,$log,$timeout){assetsService.loadJs('http://www.google.com/jsapi').then(function(){google.load("maps","3",{callback:initMap,other_params:"sensor=false"});});function initMap(){var valueArray=$scope.model.value.split(',');var latLng=new google.maps.LatLng(valueArray[0],valueArray[1]);var mapDiv=document.getElementById($scope.model.alias+'_map');var mapOptions={zoom:$scope.model.config.zoom,center:latLng,mapTypeId:google.maps.MapTypeId[$scope.model.config.mapType]};var geocoder=new google.maps.Geocoder();var map=new google.maps.Map(mapDiv,mapOptions);var marker=new google.maps.Marker({map:map,position:latLng,draggable:true});google.maps.event.addListener(map,'click',function(event){dialogService.mediaPicker({callback:function(data){var image=data.selection[0].src;var latLng=event.latLng;var marker=new google.maps.Marker({map:map,icon:image,position:latLng,draggable:true});google.maps.event.addListener(marker,"dragend",function(e){var newLat=marker.getPosition().lat();var newLng=marker.getPosition().lng();codeLatLng(marker.getPosition(),geocoder);$scope.model.vvalue=newLat+","+newLng;});}});});$('a[data-toggle="tab"]').on('shown',function(e){google.maps.event.trigger(map,'resize');});}
function codeLatLng(latLng,geocoder){geocoder.geocode({'latLng':latLng},function(results,status){if(status==google.maps.GeocoderStatus.OK){var location=results[0].formatted_address;$rootScope.$apply(function(){notificationsService.success("Peter just went to: ",location);});}});}
$scope.model.onValueChanged=function(newVal,oldVal){initMap();};});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridController.Dialogs.Config",function($scope,$http){var placeHolder="{0}";var addModifier=function(val,modifier){if(!modifier||modifier.indexOf(placeHolder)<0){return val;}else{return modifier.replace(placeHolder,val);}}
var stripModifier=function(val,modifier){if(!val||!modifier||modifier.indexOf(placeHolder)<0){return val;}else{var paddArray=modifier.split(placeHolder);if(paddArray.length==1){if(modifier.indexOf(placeHolder)===0){return val.slice(0,-paddArray[0].length);}else{return val.slice(paddArray[0].length,0);}}else{return val.slice(paddArray[0].length,-paddArray[1].length);}}}
$scope.styles=_.filter(angular.copy($scope.dialogOptions.config.items.styles),function(item){return(item.applyTo===undefined||item.applyTo===$scope.dialogOptions.itemType);});$scope.config=_.filter(angular.copy($scope.dialogOptions.config.items.config),function(item){return(item.applyTo===undefined||item.applyTo===$scope.dialogOptions.itemType);});var element=$scope.dialogOptions.gridItem;if(angular.isObject(element.config)){_.each($scope.config,function(cfg){var val=element.config[cfg.key];if(val){cfg.value=stripModifier(val,cfg.modifier);}});}
if(angular.isObject(element.styles)){_.each($scope.styles,function(style){var val=element.styles[style.key];if(val){style.value=stripModifier(val,style.modifier);}});}
$scope.saveAndClose=function(){var styleObject={};var configObject={};_.each($scope.styles,function(style){if(style.value){styleObject[style.key]=addModifier(style.value,style.modifier);}});_.each($scope.config,function(cfg){if(cfg.value){configObject[cfg.key]=addModifier(cfg.value,cfg.modifier);}});$scope.submit({config:configObject,styles:styleObject});};});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditorController.Dialogs.EditConfig",function($scope,$http){$scope.renderModel={};$scope.renderModel.name=$scope.dialogOptions.name;$scope.renderModel.config=$scope.dialogOptions.config;$scope.saveAndClose=function(isValid){if(isValid){$scope.submit($scope.renderModel.config);}};});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditor.LayoutConfigController",function($scope){$scope.currentLayout=$scope.dialogOptions.currentLayout;$scope.columns=$scope.dialogOptions.columns;$scope.rows=$scope.dialogOptions.rows;$scope.scaleUp=function(section,max,overflow){var add=1;if(overflow!==true){add=(max>1)?1:max;}
section.grid=section.grid+add;};$scope.scaleDown=function(section){var remove=(section.grid>1)?1:section.grid;section.grid=section.grid-remove;};$scope.percentage=function(spans){return((spans/$scope.columns)*100).toFixed(1);};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}else{delete collection;}};$scope.configureSection=function(section,template){if(section===undefined){var space=($scope.availableLayoutSpace>4)?4:$scope.availableLayoutSpace;section={grid:space};template.sections.push(section);}
$scope.currentSection=section;};$scope.deleteSection=function(index){$scope.currentTemplate.sections.splice(index,1);};$scope.closeSection=function(){$scope.currentSection=undefined;};$scope.$watch("currentLayout",function(layout){if(layout){var total=0;_.forEach(layout.sections,function(section){total=(total+section.grid);});$scope.availableLayoutSpace=$scope.columns-total;}},true);});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditor.RowConfigController",function($scope){$scope.currentRow=$scope.dialogOptions.currentRow;$scope.editors=$scope.dialogOptions.editors;$scope.columns=$scope.dialogOptions.columns;$scope.scaleUp=function(section,max,overflow){var add=1;if(overflow!==true){add=(max>1)?1:max;}
section.grid=section.grid+add;};$scope.scaleDown=function(section){var remove=(section.grid>1)?1:section.grid;section.grid=section.grid-remove;};$scope.percentage=function(spans){return((spans/$scope.columns)*100).toFixed(1);};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}else{delete collection;}};$scope.configureCell=function(cell,row){if($scope.currentCell&&$scope.currentCell===cell){delete $scope.currentCell;}else{if(cell===undefined){var available=$scope.availableRowSpace;var space=4;if(available<4&&available>0){space=available;}
cell={grid:space};row.areas.push(cell);}
$scope.currentCell=cell;}};$scope.deleteArea=function(index){$scope.currentRow.areas.splice(index,1);};$scope.closeArea=function(){$scope.currentCell=undefined;};$scope.$watch("currentRow",function(row){if(row){var total=0;_.forEach(row.areas,function(area){total=(total+area.grid);});$scope.availableRowSpace=$scope.columns-total;}},true);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.EmbedController",function($scope,$rootScope,$timeout,dialogService){$scope.setEmbed=function(){dialogService.embedDialog({callback:function(data){$scope.control.value=data;}});};$timeout(function(){if($scope.control.$initializing){$scope.setEmbed();}},200);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.MacroController",function($scope,$rootScope,$timeout,dialogService,macroResource,macroService,$routeParams){$scope.title="Click to insert macro";$scope.setMacro=function(){dialogService.macroPicker({dialogData:{richTextEditor:true,macroData:$scope.control.value},callback:function(data){$scope.control.value={macroAlias:data.macroAlias,macroParamsDictionary:data.macroParamsDictionary};$scope.setPreview($scope.control.value);}});};$scope.setPreview=function(macro){var contentId=$routeParams.id;macroResource.getMacroResultAsHtmlForEditor(macro.macroAlias,contentId,macro.macroParamsDictionary).then(function(htmlResult){$scope.title=macro.macroAlias;if(htmlResult.trim().length>0&&htmlResult.indexOf("Macro:")<0){$scope.preview=htmlResult;}});};$timeout(function(){if($scope.control.$initializing){$scope.setMacro();}else if($scope.control.value){$scope.setPreview($scope.control.value);}},200);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.MediaController",function($scope,$rootScope,$timeout,dialogService){$scope.setImage=function(){dialogService.mediaPicker({startNodeId:$scope.control.editor.config&&$scope.control.editor.config.startNodeId?$scope.control.editor.config.startNodeId:undefined,multiPicker:false,cropSize:$scope.control.editor.config&&$scope.control.editor.config.size?$scope.control.editor.config.size:undefined,showDetails:true,callback:function(data){$scope.control.value={focalPoint:data.focalPoint,id:data.id,image:data.image};$scope.setUrl();}});};$scope.setUrl=function(){if($scope.control.value.image){var url=$scope.control.value.image;if($scope.control.editor.config&&$scope.control.editor.config.size){url+="?width="+$scope.control.editor.config.size.width;url+="&height="+$scope.control.editor.config.size.height;if($scope.control.value.focalPoint){url+="&center="+$scope.control.value.focalPoint.top+","+$scope.control.value.focalPoint.left;url+="&mode=crop";}}
$scope.url=url;}};$timeout(function(){if($scope.control.$initializing){$scope.setImage();}else{$scope.setUrl();}},200);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.TextStringController",function($scope,$rootScope,$timeout,dialogService){});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridController",function($scope,$http,assetsService,$rootScope,dialogService,gridService,mediaResource,imageHelper,$timeout){$scope.currentRow=null;$scope.currentCell=null;$scope.currentToolsControl=null;$scope.currentControl=null;$scope.openRTEToolbarId=null;$scope.hasSettings=false;$scope.sortableOptions={distance:10,cursor:"move",placeholder:'ui-sortable-placeholder',handle:'.cell-tools-move',forcePlaceholderSize:true,tolerance:"pointer",zIndex:999999999999999999,scrollSensitivity:100,cursorAt:{top:45,left:90},sort:function(event,ui){var max=$(".usky-grid").width()-150;if(parseInt(ui.helper.css('left'))>max){ui.helper.css({'left':max+"px"})}
if(parseInt(ui.helper.css('left'))<20){ui.helper.css({'left':20})}},start:function(e,ui){ui.item.find('.mceNoEditor').each(function(){tinyMCE.execCommand('mceRemoveEditor',false,$(this).attr('id'));});},stop:function(e,ui){ui.item.parents(".usky-column").find('.mceNoEditor').each(function(){tinyMCE.execCommand('mceRemoveEditor',false,$(this).attr('id'));tinyMCE.execCommand('mceAddEditor',false,$(this).attr('id'));});}};var notIncludedRte=[];var cancelMove=false;$scope.sortableOptionsCell={distance:10,cursor:"move",placeholder:"ui-sortable-placeholder",handle:'.cell-tools-move',connectWith:".usky-cell",forcePlaceholderSize:true,tolerance:"pointer",zIndex:999999999999999999,scrollSensitivity:100,cursorAt:{top:45,left:90},sort:function(event,ui){var position=parseInt(ui.item.parent().offset().left)+parseInt(ui.helper.css('left'))-parseInt($(".usky-grid").offset().left);var max=$(".usky-grid").width()-220;if(position>max){ui.helper.css({'left':max-parseInt(ui.item.parent().offset().left)+parseInt($(".usky-grid").offset().left)+"px"})}
if(position<0){ui.helper.css({'left':0-parseInt(ui.item.parent().offset().left)+parseInt($(".usky-grid").offset().left)+"px"})}},over:function(event,ui){allowedEditors=$(event.target).scope().area.allowed;if($.inArray(ui.item.scope().control.editor.alias,allowedEditors)<0&&allowedEditors){ui.placeholder.hide();cancelMove=true;}
else{ui.placeholder.show();cancelMove=false;}},update:function(event,ui){if(!ui.sender){if(cancelMove){ui.item.sortable.cancel();}
ui.item.parents(".usky-cell").find('.mceNoEditor').each(function(){if($.inArray($(this).attr('id'),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr('id'));}});}
else{$(event.target).find('.mceNoEditor').each(function(){if($.inArray($(this).attr('id'),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr('id'));}});}},start:function(e,ui){ui.item.find('.mceNoEditor').each(function(){notIncludedRte=[];tinyMCE.execCommand('mceRemoveEditor',false,$(this).attr('id'));});},stop:function(e,ui){ui.item.parents(".usky-cell").find('.mceNoEditor').each(function(){if($.inArray($(this).attr('id'),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr('id'));}});$timeout(function(){_.forEach(notIncludedRte,function(id){tinyMCE.execCommand('mceRemoveEditor',false,id);tinyMCE.execCommand('mceAddEditor',false,id);console.info("stop "+id);});},500,false);}};$scope.overlayMenu={show:false,style:{},area:undefined,key:undefined};$scope.addItemOverlay=function(event,area,index,key){$scope.overlayMenu.area=area;$scope.overlayMenu.index=index;$scope.overlayMenu.style={};$scope.overlayMenu.key=key;var offset=$(event.target).offset();var height=$(window).height();var width=$(window).width();if((height-offset.top)<250){$scope.overlayMenu.style.bottom=0;$scope.overlayMenu.style.top="initial";}else if(offset.top<300){$scope.overlayMenu.style.top=190;}
$scope.overlayMenu.show=true;};$scope.closeItemOverlay=function(){$scope.currentControl=null;$scope.overlayMenu.show=false;$scope.overlayMenu.key=undefined;};$scope.addTemplate=function(template){$scope.model.value=angular.copy(template);_.forEach($scope.model.value.sections,function(section){$scope.initSection(section);});};$scope.setCurrentRow=function(row){$scope.currentRow=row;};$scope.disableCurrentRow=function(){$scope.currentRow=null;};$scope.setWarnighlightRow=function(row){$scope.currentWarnhighlightRow=row;};$scope.disableWarnhighlightRow=function(){$scope.currentWarnhighlightRow=null;};$scope.setInfohighlightRow=function(row){$scope.currentInfohighlightRow=row;};$scope.disableInfohighlightRow=function(){$scope.currentInfohighlightRow=null;};$scope.getAllowedLayouts=function(column){var layouts=$scope.model.config.items.layouts;if(column.allowed&&column.allowed.length>0){return _.filter(layouts,function(layout){return _.indexOf(column.allowed,layout.name)>=0;});}else{return layouts;}};$scope.addRow=function(section,layout){var row=angular.copy(layout);row=$scope.initRow(row);if(row){section.rows.push(row);}};$scope.removeRow=function(section,$index){if(section.rows.length>0){section.rows.splice($index,1);$scope.currentRow=null;$scope.openRTEToolbarId=null;$scope.initContent();}};$scope.editGridItemSettings=function(gridItem,itemType){dialogService.open({template:"views/propertyeditors/grid/dialogs/config.html",gridItem:gridItem,config:$scope.model.config,itemType:itemType,callback:function(data){gridItem.styles=data.styles;gridItem.config=data.config;}});};$scope.setCurrentCell=function(cell){$scope.currentCell=cell;};$scope.disableCurrentCell=function(){$scope.currentCell=null;};$scope.cellPreview=function(cell){if(cell&&cell.$allowedEditors){var editor=cell.$allowedEditors[0];return editor.icon;}else{return"icon-layout";}};$scope.setInfohighlightArea=function(cell){$scope.currentInfohighlightArea=cell;};$scope.disableInfohighlightArea=function(){$scope.currentInfohighlightArea=null;};$scope.setCurrentControl=function(Control){$scope.currentControl=Control;};$scope.disableCurrentControl=function(Control){$scope.currentControl=null;};$scope.setCurrentToolsControl=function(Control){$scope.currentToolsControl=Control;};$scope.disableCurrentToolsControl=function(Control){$scope.currentToolsControl=null;};$scope.setWarnhighlightControl=function(Control){$scope.currentWarnhighlightControl=Control;};$scope.disableWarnhighlightControl=function(Control){$scope.currentWarnhighlightControl=null;};$scope.setInfohighlightControl=function(Control){$scope.currentInfohighlightControl=Control;};$scope.disableInfohighlightControl=function(Control){$scope.currentInfohighlightControl=null;};$scope.setUniqueId=function(cell,index){return guid();};var guid=(function(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return function(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+
s4()+'-'+s4()+s4()+s4();};})();$scope.addControl=function(editor,cell,index){$scope.closeItemOverlay();var newControl={value:null,editor:editor,$initializing:true};if(index===undefined){index=cell.controls.length;}
$scope.initControl(newControl,index+1);cell.controls.splice(index+1,0,newControl);};$scope.addTinyMce=function(cell){var rte=$scope.getEditor("rte");$scope.addControl(rte,cell);};$scope.getEditor=function(alias){return _.find($scope.availableEditors,function(editor){return editor.alias===alias;});};$scope.removeControl=function(cell,$index){$scope.currentControl=null;cell.controls.splice($index,1);};$scope.percentage=function(spans){return((spans/$scope.model.config.items.columns)*100).toFixed(1);};$scope.clearPrompt=function(scopedObject,e){scopedObject.deletePrompt=false;e.preventDefault();e.stopPropagation();}
$scope.showPrompt=function(scopedObject){scopedObject.deletePrompt=true;}
$scope.initContent=function(){var clear=true;if($scope.model.config.items.config||$scope.model.config.items.styles){$scope.hasSettings=true;}
if($scope.model.config.items.columns&&angular.isString($scope.model.config.items.columns)){$scope.model.config.items.columns=parseInt($scope.model.config.items.columns);}else{$scope.model.config.items.columns=12;}
if($scope.model.value&&$scope.model.value.sections&&$scope.model.value.sections.length>0){_.forEach($scope.model.value.sections,function(section,index){if(section.grid>0){$scope.initSection(section);if(section.rows.length>0){clear=false;}}else{$scope.model.value.sections.splice(index,1);}});}else if($scope.model.config.items.templates&&$scope.model.config.items.templates.length===1){$scope.addTemplate($scope.model.config.items.templates[0]);}
if(clear){$scope.model.value=undefined;}};$scope.initSection=function(section){section.$percentage=$scope.percentage(section.grid);var layouts=$scope.model.config.items.layouts;if(section.allowed&&section.allowed.length>0){section.$allowedLayouts=_.filter(layouts,function(layout){return _.indexOf(section.allowed,layout.name)>=0;});}else{section.$allowedLayouts=layouts;}
if(!section.rows){section.rows=[];}else{_.forEach(section.rows,function(row,index){if(!row.$initialized){var initd=$scope.initRow(row);if(!initd){section.rows.splice(index,1);}else{section.rows[index]=initd;}}});}};$scope.initRow=function(row){var original=_.find($scope.model.config.items.layouts,function(o){return o.name===row.name;});if(!original){return null;}else{original=angular.copy(original);original.styles=row.styles;original.config=row.config;_.each(original.areas,function(area,areaIndex){if(area.grid>0){var currentArea=row.areas[areaIndex];if(currentArea){area.config=currentArea.config;area.styles=currentArea.styles;}
if(row.areas.length>areaIndex&&row.areas[areaIndex].controls){area.controls=currentArea.controls;_.forEach(area.controls,function(control,controlIndex){$scope.initControl(control,controlIndex);});}else{area.controls=[];}
area.$percentage=$scope.percentage(area.grid);area.$uniqueId=$scope.setUniqueId();if(!area.allowed||area.allowAll===true){area.$allowedEditors=$scope.availableEditors;area.$allowsRTE=true;}else{area.$allowedEditors=_.filter($scope.availableEditors,function(editor){return _.indexOf(area.allowed,editor.alias)>=0;});if(_.indexOf(area.allowed,"rte")>=0){area.$allowsRTE=true;}}}else{original.areas.splice(areaIndex,1);}});original.$initialized=true;original.$uniqueId=$scope.setUniqueId();original.id=!row.id?$scope.setUniqueId():row.id;return original;}};$scope.initControl=function(control,index){control.$index=index;control.$uniqueId=$scope.setUniqueId();if(!control.$editorPath){var editorConfig=$scope.getEditor(control.editor.alias);control.editor=editorConfig;if(_.indexOf(control.editor.view,"/")>=0){control.$editorPath=control.editor.view;}else{control.$editorPath="views/propertyeditors/grid/editors/"+control.editor.view+".html";}}};gridService.getGridEditors().then(function(response){$scope.availableEditors=response.data;$scope.contentReady=true;$scope.initContent();});});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditorController",function($scope,$http,assetsService,$rootScope,dialogService,mediaResource,gridService,imageHelper,$timeout){var emptyModel={styles:[{label:"Set a background image",description:"Set a row background",key:"background-image",view:"imagepicker",modifier:"url({0})"}],config:[{label:"Class",description:"Set a css class",key:"class",view:"textstring"}],columns:12,templates:[{name:"1 column layout",sections:[{grid:12,}]},{name:"2 column layout",sections:[{grid:4,},{grid:8}]}],layouts:[{name:"Headline",areas:[{grid:12,editors:["headline"]}]},{name:"Article",areas:[{grid:4},{grid:8}]}]};$scope.configureTemplate=function(template){if(template===undefined){template={name:"",sections:[]};$scope.model.value.templates.push(template);}
dialogService.open({template:"views/propertyEditors/grid/dialogs/layoutconfig.html",currentLayout:template,rows:$scope.model.value.layouts,columns:$scope.model.value.columns});};$scope.deleteTemplate=function(index){$scope.model.value.templates.splice(index,1);};$scope.configureLayout=function(layout){if(layout===undefined){layout={name:"",areas:[]};$scope.model.value.layouts.push(layout);}
dialogService.open({template:"views/propertyEditors/grid/dialogs/rowconfig.html",currentRow:layout,editors:$scope.editors,columns:$scope.model.value.columns});};$scope.deleteLayout=function(index){$scope.model.value.layouts.splice(index,1);};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}else{delete collection;}};$scope.percentage=function(spans){return((spans/$scope.model.value.columns)*100).toFixed(1);};$scope.zeroWidthFilter=function(cell){return cell.grid>0;};$scope.removeConfigValue=function(collection,index){collection.splice(index,1);};var editConfigCollection=function(configValues,title,callbackOnSave){dialogService.open({template:"views/propertyeditors/grid/dialogs/editconfig.html",config:configValues,name:title,callback:function(data){callbackOnSave(data);}});};$scope.editConfig=function(){editConfigCollection($scope.model.value.config,"Settings",function(data){$scope.model.value.config=data;});};$scope.editStyles=function(){editConfigCollection($scope.model.value.styles,"Styling",function(data){$scope.model.value.styles=data;});};gridService.getGridEditors().then(function(response){$scope.editors=response.data;});if(!$scope.model.value||$scope.model.value===""||!$scope.model.value.templates){$scope.model.value=emptyModel;}else{if(!$scope.model.value.columns){$scope.model.value.columns=emptyModel.columns;}
if(!$scope.model.value.config){$scope.model.value.config=[];}
if(!$scope.model.value.styles){$scope.model.value.styles=[];}}
$scope.$on("formSubmitting",function(ev,args){var ts=$scope.model.value.templates;var ls=$scope.model.value.layouts;_.each(ts,function(t){_.each(t.sections,function(section,index){if(section.grid===0){t.sections.splice(index,1);}});});_.each(ls,function(l){_.each(l.areas,function(area,index){if(area.grid===0){l.areas.splice(index,1);}});});});});angular.module('umbraco').controller("Umbraco.PropertyEditors.ImageCropperController",function($rootScope,$routeParams,$scope,$log,mediaHelper,cropperHelper,$timeout,editorState,umbRequestHelper,fileManager){var config=angular.copy($scope.model.config);if($scope.model.value){if(angular.isString($scope.model.value)){config.src=$scope.model.value;$scope.model.value=config;}else if($scope.model.value.crops){_.each($scope.model.value.crops,function(saved){var configured=_.find(config.crops,function(item){return item.alias===saved.alias});if(configured&&configured.height===saved.height&&configured.width===saved.width){configured.coordinates=saved.coordinates;}});$scope.model.value.crops=config.crops;if(!$scope.model.value.focalPoint){$scope.model.value.focalPoint={left:0.5,top:0.5};}}
$scope.imageSrc=$scope.model.value.src;}
$scope.crop=function(crop){$scope.currentCrop=crop;$scope.currentPoint=undefined;};$scope.done=function(){$scope.currentCrop=undefined;$scope.currentPoint=undefined;};$scope.clear=function(crop){fileManager.setFiles($scope.model.alias,[]);$scope.imageSrc=undefined;if($scope.model.value){delete $scope.model.value;}};$scope.togglePreviews=function(){if($scope.showPreviews){$scope.showPreviews=false;$scope.tempShowPreviews=false;}else{$scope.showPreviews=true;}};$scope.$on("filesSelected",function(ev,args){$scope.model.value=config;if(args.files&&args.files[0]){fileManager.setFiles($scope.model.alias,args.files);var reader=new FileReader();reader.onload=function(e){$scope.$apply(function(){$scope.imageSrc=e.target.result;});};reader.readAsDataURL(args.files[0]);}});$scope.model.onValueChanged=function(newVal,oldVal){fileManager.setFiles($scope.model.alias,[]);};var unsubscribe=$scope.$on("formSubmitting",function(){$scope.done();});$scope.$on('$destroy',function(){unsubscribe();});}).run(function(mediaHelper,umbRequestHelper){if(mediaHelper&&mediaHelper.registerFileResolver){mediaHelper.registerFileResolver("Umbraco.ImageCropper",function(property,entity,thumbnail){if(property.value.src){if(thumbnail===true){return property.value.src+"?width=500&mode=max";}
else{return property.value.src;}}
else if(angular.isString(property.value)){if(thumbnail){if(mediaHelper.detectIfImageByExtension(property.value)){var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:property.value}]);return thumbnailUrl;}
else{return null;}}
else{return property.value;}}
return null;});}});angular.module("umbraco").controller("Umbraco.PrevalueEditors.CropSizesController",function($scope,$timeout){if(!$scope.model.value){$scope.model.value=[];}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.alias===item.alias;});};$scope.edit=function(item,evt){evt.preventDefault();$scope.newItem=item;};$scope.cancel=function(evt){evt.preventDefault();$scope.newItem=null;};$scope.add=function(evt){evt.preventDefault();if($scope.newItem&&$scope.newItem.alias&&angular.isNumber($scope.newItem.width)&&angular.isNumber($scope.newItem.height)&&$scope.newItem.width>0&&$scope.newItem.height>0){var exists=_.find($scope.model.value,function(item){return $scope.newItem.alias===item.alias;});if(!exists){$scope.model.value.push($scope.newItem);$scope.newItem={};$scope.hasError=false;return;}}
$scope.hasError=true;};});function includePropsPreValsController($rootScope,$scope,localizationService,contentTypeResource){if(!$scope.model.value){$scope.model.value=[];}
$scope.propertyAliases=[];$scope.selectedField=null;$scope.systemFields=[{value:"sortOrder"},{value:"updateDate"},{value:"updater"},{value:"createDate"},{value:"owner"},{value:"published"},{value:"contentTypeAlias"},{value:"email"},{value:"username"}];$scope.getLocalizedKey=function(alias){switch(alias){case"name":return"general_name";case"sortOrder":return"general_sort";case"updateDate":return"content_updateDate";case"updater":return"content_updatedBy";case"createDate":return"content_createDate";case"owner":return"content_createBy";case"published":return"content_isPublished";case"contentTypeAlias":return"content_documentType";case"email":return"general_email";case"username":return"general_username";}
return alias;}
$scope.removeField=function(e){$scope.model.value=_.reject($scope.model.value,function(x){return x.alias===e.alias;});}
_.each($scope.systemFields,function(e,i){var key=$scope.getLocalizedKey(e.value);localizationService.localize(key).then(function(v){e.name=v;switch(e.value){case"updater":e.name+=" (Content only)";break;case"published":e.name+=" (Content only)";break;case"email":e.name+=" (Members only)";break;case"username":e.name+=" (Members only)";break;}});});var fixHelper=function(e,ui){var h=ui.clone();h.children().each(function(){$(this).width($(this).width());});h.css("background-color","lightgray");return h;};$scope.sortableOptions={helper:fixHelper,handle:".handle",opacity:0.5,axis:'y',containment:'parent',cursor:'move',items:'> tr',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedAlias=$('.alias-value',ui.item).text().trim();var originalIndex=getAliasIndexByText(movedAlias);if(originalIndex>-1){var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);}}};contentTypeResource.getAllPropertyTypeAliases().then(function(data){$scope.propertyAliases=data;});$scope.addField=function(){var val=$scope.selectedField;var isSystem=val.startsWith("_system_");if(isSystem){val=val.trimStart("_system_");}
var exists=_.find($scope.model.value,function(i){return i.alias===val;});if(!exists){$scope.model.value.push({alias:val,isSystem:isSystem?1:0});}}
function getAliasIndexByText(value){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].alias===value){return i;}}
return-1;}}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.IncludePropertiesListViewController",includePropsPreValsController);function listViewController($rootScope,$scope,$routeParams,$injector,notificationsService,iconHelper,dialogService,editorState,localizationService,$location,appState){if($routeParams.create){$scope.isNew=true;return;}
var contentResource,getContentTypesCallback,getListResultsCallback,deleteItemCallback,getIdCallback,createEditUrlCallback;if(($scope.model.config.entityType&&$scope.model.config.entityType==="member")||(appState.getSectionState("currentSection")==="member")){$scope.entityType="member";contentResource=$injector.get('memberResource');getContentTypesCallback=$injector.get('memberTypeResource').getTypes;getListResultsCallback=contentResource.getPagedResults;deleteItemCallback=contentResource.deleteByKey;getIdCallback=function(selected){return selected.key;};createEditUrlCallback=function(item){return"/"+$scope.entityType+"/"+$scope.entityType+"/edit/"+item.key+"?page="+$scope.options.pageNumber+"&listName="+$scope.contentId;};}
else{if(($scope.model.config.entityType&&$scope.model.config.entityType==="media")||(appState.getSectionState("currentSection")==="media")){$scope.entityType="media";contentResource=$injector.get('mediaResource');getContentTypesCallback=$injector.get('mediaTypeResource').getAllowedTypes;}
else{$scope.entityType="content";contentResource=$injector.get('contentResource');getContentTypesCallback=$injector.get('contentTypeResource').getAllowedTypes;}
getListResultsCallback=contentResource.getChildren;deleteItemCallback=contentResource.deleteById;getIdCallback=function(selected){return selected.id;};createEditUrlCallback=function(item){return"/"+$scope.entityType+"/"+$scope.entityType+"/edit/"+item.id+"?page="+$scope.options.pageNumber;};}
$scope.pagination=[];$scope.isNew=false;$scope.actionInProgress=false;$scope.listViewResultSet={totalPages:0,items:[]};$scope.options={pageSize:$scope.model.config.pageSize?$scope.model.config.pageSize:10,pageNumber:($routeParams.page&&Number($routeParams.page)!=NaN&&Number($routeParams.page)>0)?$routeParams.page:1,filter:'',orderBy:($scope.model.config.orderBy?$scope.model.config.orderBy:'VersionDate').trim(),orderDirection:$scope.model.config.orderDirection?$scope.model.config.orderDirection.trim():"desc",includeProperties:$scope.model.config.includeProperties?$scope.model.config.includeProperties:[{alias:'updateDate',header:'Last edited',isSystem:1},{alias:'updater',header:'Last edited by',isSystem:1}],allowBulkPublish:true,allowBulkUnpublish:true,allowBulkDelete:true,};_.each($scope.options.includeProperties,function(e,i){if(e.isSystem){if(e.alias!="contentTypeAlias"){e.allowSorting=true;}
var key=getLocalizedKey(e.alias);localizationService.localize(key).then(function(v){e.header=v;});}});$scope.isSortDirection=function(col,direction){return $scope.options.orderBy.toUpperCase()==col.toUpperCase()&&$scope.options.orderDirection==direction;}
$scope.next=function(){if($scope.options.pageNumber<$scope.listViewResultSet.totalPages){$scope.options.pageNumber++;$scope.reloadView($scope.contentId);}};$scope.goToPage=function(pageNumber){$scope.options.pageNumber=pageNumber+1;$scope.reloadView($scope.contentId);};$scope.sort=function(field,allow){if(allow){$scope.options.orderBy=field;if($scope.options.orderDirection==="desc"){$scope.options.orderDirection="asc";}
else{$scope.options.orderDirection="desc";}
$scope.reloadView($scope.contentId);}};$scope.prev=function(){if($scope.options.pageNumber>1){$scope.options.pageNumber--;$scope.reloadView($scope.contentId);}};$scope.reloadView=function(id){getListResultsCallback(id,$scope.options).then(function(data){$scope.listViewResultSet=data;if($scope.listViewResultSet.items){_.each($scope.listViewResultSet.items,function(e,index){setPropertyValues(e);});}
if($scope.options.pageNumber>$scope.listViewResultSet.totalPages){$scope.options.pageNumber=$scope.listViewResultSet.totalPages;$scope.reloadView(id);}
$scope.pagination=[];if($scope.listViewResultSet.totalPages<=10){for(var i=0;i<$scope.listViewResultSet.totalPages;i++){$scope.pagination.push({val:(i+1),isActive:$scope.options.pageNumber==(i+1)});}}
else{var maxIndex=$scope.listViewResultSet.totalPages-10;var start=Math.max($scope.options.pageNumber-5,0);start=Math.min(maxIndex,start);for(var i=start;i<(10+start);i++){$scope.pagination.push({val:(i+1),isActive:$scope.options.pageNumber==(i+1)});}
if(start>0){$scope.pagination.unshift({name:"First",val:1,isActive:false},{val:"...",isActive:false});}
if(start<maxIndex){$scope.pagination.push({val:"...",isActive:false},{name:"Last",val:$scope.listViewResultSet.totalPages,isActive:false});}}});};$scope.search=_.debounce(function(){$scope.options.pageNumber=1;$scope.reloadView($scope.contentId);},100);$scope.enterSearch=function($event){$($event.target).next().focus();}
$scope.selectAll=function($event){var checkbox=$event.target;if(!angular.isArray($scope.listViewResultSet.items)){return;}
for(var i=0;i<$scope.listViewResultSet.items.length;i++){var entity=$scope.listViewResultSet.items[i];entity.selected=checkbox.checked;}};$scope.isSelectedAll=function(){if(!angular.isArray($scope.listViewResultSet.items)){return false;}
return _.every($scope.listViewResultSet.items,function(item){return item.selected;});};$scope.isAnythingSelected=function(){if(!angular.isArray($scope.listViewResultSet.items)){return false;}
return _.some($scope.listViewResultSet.items,function(item){return item.selected;});};$scope.getIcon=function(entry){return iconHelper.convertFromLegacyIcon(entry.icon);};$scope.delete=function(){var selected=_.filter($scope.listViewResultSet.items,function(item){return item.selected;});var total=selected.length;if(total===0){return;}
if(confirm("Sure you want to delete?")==true){$scope.actionInProgress=true;$scope.bulkStatus="Starting with delete";var current=1;var pluralSuffix=total==1?"":"s";for(var i=0;i<selected.length;i++){$scope.bulkStatus="Deleted item "+current+" out of "+total+" item"+pluralSuffix;deleteItemCallback(getIdCallback(selected[i])).then(function(data){if(current===total){notificationsService.success("Bulk action","Deleted "+total+" item"+pluralSuffix);$scope.bulkStatus="";$scope.reloadView($scope.contentId);$scope.actionInProgress=false;}
current++;});}}};$scope.publish=function(){var selected=_.filter($scope.listViewResultSet.items,function(item){return item.selected;});var total=selected.length;if(total===0){return;}
$scope.actionInProgress=true;$scope.bulkStatus="Starting with publish";var current=1;var pluralSuffix=total==1?"":"s";for(var i=0;i<selected.length;i++){$scope.bulkStatus="Publishing "+current+" out of "+total+" document"+pluralSuffix;contentResource.publishById(getIdCallback(selected[i])).then(function(content){if(current==total){notificationsService.success("Bulk action","Published "+total+" document"+pluralSuffix);$scope.bulkStatus="";$scope.reloadView($scope.contentId);$scope.actionInProgress=false;}
current++;},function(err){$scope.bulkStatus="";$scope.reloadView($scope.contentId);$scope.actionInProgress=false;if(err.status===400&&err.data&&err.data.Message){notificationsService.error("Publish error",err.data.Message);}
else{dialogService.ysodDialog(err);}});}};$scope.unpublish=function(){var selected=_.filter($scope.listViewResultSet.items,function(item){return item.selected;});var total=selected.length;if(total===0){return;}
$scope.actionInProgress=true;$scope.bulkStatus="Starting with publish";var current=1;var pluralSuffix=total==1?"":"s";for(var i=0;i<selected.length;i++){$scope.bulkStatus="Unpublishing "+current+" out of "+total+" document"+pluralSuffix;contentResource.unPublish(getIdCallback(selected[i])).then(function(content){if(current==total){notificationsService.success("Bulk action","Unpublished "+total+" document"+pluralSuffix);$scope.bulkStatus="";$scope.reloadView($scope.contentId);$scope.actionInProgress=false;}
current++;});}};function getCustomPropertyValue(alias,properties){var value='';var index=0;var foundAlias=false;for(var i=0;i<properties.length;i++){if(properties[i].alias==alias){foundAlias=true;break;}
index++;}
if(foundAlias){value=properties[index].value;}
return value;};function setPropertyValues(result){result.editPath=createEditUrlCallback(result);_.each($scope.options.includeProperties,function(e,i){var alias=e.alias;var value=result[alias];if(value===Object(value)){value=value['name'];}
if(typeof value==='undefined'){value=getCustomPropertyValue(alias,result.properties);}
if(isDate(value)){value=value.substring(0,value.length-3);}
result[alias]=value;});};function isDate(val){if(angular.isString(val)){return val.match(/^(\d{4})\-(\d{2})\-(\d{2})\ (\d{2})\:(\d{2})\:(\d{2})$/);}
return false;};function initView(){if($routeParams.id){$scope.listViewAllowedTypes=getContentTypesCallback($routeParams.id);$scope.contentId=$routeParams.id;$scope.isTrashed=$routeParams.id==="-20"||$routeParams.id==="-21";$scope.reloadView($scope.contentId);}};function getLocalizedKey(alias){switch(alias){case"sortOrder":return"general_sort";case"updateDate":return"content_updateDate";case"updater":return"content_updatedBy";case"createDate":return"content_createDate";case"owner":return"content_createBy";case"published":return"content_isPublished";case"contentTypeAlias":return $scope.entityType==="content"?"content_documentType":"content_mediatype";case"email":return"general_email";case"username":return"general_username";}
return alias;}
initView();}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ListViewController",listViewController);function sortByPreValsController($rootScope,$scope,localizationService){$scope.sortByFields=[{value:"SortOrder",key:"general_sort"},{value:"Name",key:"general_name"},{value:"VersionDate",key:"content_updateDate"},{value:"Updater",key:"content_updatedBy"},{value:"CreateDate",key:"content_createDate"},{value:"Owner",key:"content_createBy"},{value:"ContentTypeAlias",key:"content_documentType"},{value:"Published",key:"content_isPublished"},{value:"Email",key:"general_email"},{value:"Username",key:"general_username"}];_.each($scope.sortByFields,function(e,i){localizationService.localize(e.key).then(function(v){e.name=v;switch(e.value){case"Updater":e.name+=" (Content only)";break;case"Published":e.name+=" (Content only)";break;case"Email":e.name+=" (Members only)";break;case"Username":e.name+=" (Members only)";break;}});});}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.SortByListViewController",sortByPreValsController);angular.module('umbraco').controller("Umbraco.PropertyEditors.MacroContainerController",function($scope,dialogService,entityResource,macroService){$scope.renderModel=[];if($scope.model.value){var macros=$scope.model.value.split('>');angular.forEach(macros,function(syntax,key){if(syntax&&syntax.length>10){syntax=syntax+">";var parsed=macroService.parseMacroSyntax(syntax);if(!parsed){parsed={};}
parsed.syntax=syntax;collectDetails(parsed);$scope.renderModel.push(parsed);}});}
function collectDetails(macro){macro.details="";if(macro.macroParamsDictionary){angular.forEach((macro.macroParamsDictionary),function(value,key){macro.details+=key+": "+value+" ";});}}
function openDialog(index){var dialogData={allowedMacros:$scope.model.config.allowed};if(index!==null&&$scope.renderModel[index]){var macro=$scope.renderModel[index];dialogData["macroData"]=macro;}
dialogService.macroPicker({dialogData:dialogData,callback:function(data){collectDetails(data);if(index!==null&&$scope.renderModel[index]){$scope.renderModel[index]=data;}else{$scope.renderModel.push(data);}}});}
$scope.edit=function(index){openDialog(index);};$scope.add=function(){if($scope.model.config.max&&$scope.model.config.max>0&&$scope.renderModel.length>=$scope.model.config.max){return;}
openDialog();};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.clear=function(){$scope.model.value="";$scope.renderModel=[];};$scope.$on("formSubmitting",function(ev,args){var syntax=[];angular.forEach($scope.renderModel,function(value,key){syntax.push(value.syntax);});$scope.model.value=syntax.join("");});function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}});function MacroListController($scope,entityResource){$scope.items=[];entityResource.getAll("Macro").then(function(items){_.each(items,function(i){$scope.items.push({name:i.name,alias:i.alias});});});}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.MacroList",MacroListController);angular.module("umbraco").controller("Umbraco.PropertyEditors.MarkdownEditorController",function($scope,assetsService,dialogService,$timeout){if($scope.model.value===null||$scope.model.value===""){$scope.model.value=$scope.model.config.defaultValue;}
assetsService.load(["lib/markdown/markdown.converter.js","lib/markdown/markdown.sanitizer.js","lib/markdown/markdown.editor.js"]).then(function(){$timeout(function(){var converter2=new Markdown.Converter();var editor2=new Markdown.Editor(converter2,"-"+$scope.model.alias);editor2.run();editor2.hooks.set("insertImageDialog",function(callback){dialogService.mediaPicker({callback:function(data){callback(data.image);}});return true;});});});assetsService.loadCss("lib/markdown/markdown.css");});angular.module('umbraco').controller("Umbraco.PropertyEditors.MediaPickerController",function($rootScope,$scope,dialogService,entityResource,mediaResource,mediaHelper,$timeout,userService){var multiPicker=$scope.model.config.multiPicker&&$scope.model.config.multiPicker!=='0'?true:false;if(!$scope.model.config.startNodeId){userService.getCurrentUser().then(function(userData){$scope.model.config.startNodeId=userData.startMediaId;});}
function setupViewModel(){$scope.images=[];$scope.ids=[];if($scope.model.value){var ids=$scope.model.value.split(',');entityResource.getByIds(ids,"Media").then(function(medias){_.each(medias,function(media,i){if(media.parentId>=-1){if(!media.thumbnail){media.thumbnail=mediaHelper.resolveFileFromEntity(media,true);}
$scope.images.push(media);$scope.ids.push(media.id);}});$scope.sync();});}}
setupViewModel();$scope.remove=function(index){$scope.images.splice(index,1);$scope.ids.splice(index,1);$scope.sync();};$scope.add=function(){dialogService.mediaPicker({startNodeId:$scope.model.config.startNodeId,multiPicker:multiPicker,callback:function(data){if(!multiPicker){data=[data];}
_.each(data,function(media,i){if(!media.thumbnail){media.thumbnail=mediaHelper.resolveFileFromEntity(media,true);}
$scope.images.push(media);$scope.ids.push(media.id);});$scope.sync();}});};$scope.sortableOptions={update:function(e,ui){var r=[];$timeout(function(){angular.forEach($scope.images,function(value,key){r.push(value.id);});$scope.ids=r;$scope.sync();},500,false);}};$scope.sync=function(){$scope.model.value=$scope.ids.join();};$scope.showAdd=function(){if(!multiPicker){if($scope.model.value&&$scope.model.value!==""){return false;}}
return true;};$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};});function memberGroupPicker($scope,dialogService){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];if($scope.model.value){var modelIds=$scope.model.value.split(',');_.each(modelIds,function(item,i){$scope.renderModel.push({name:item,id:item,icon:'icon-users'});});}
var dialogOptions={multiPicker:true,entityType:"MemberGroup",section:"membergroup",treeAlias:"memberGroup",filter:"",filterCssClass:"not-allowed",callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}}};if($scope.model.config){angular.extend(dialogOptions,$scope.model.config);}
$scope.openMemberGroupPicker=function(){var d=dialogService.memberGroupPicker(dialogOptions);};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item)<0){$scope.renderModel.push({name:item,id:item,icon:'icon-users'});}};$scope.clear=function(){$scope.renderModel=[];};$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberGroupPickerController",memberGroupPicker);function memberGroupController($rootScope,$scope,dialogService,mediaResource,imageHelper,$log){$scope.getAvailable=function(){var available=[];for(var n in $scope.model.value){if($scope.model.value[n]===false){available.push(n);}}
return available;};$scope.getSelected=function(){var selected=[];for(var n in $scope.model.value){if($scope.model.value[n]===true){selected.push(n);}}
return selected;};$scope.addItem=function(item){$scope.model.value[item]=true;};$scope.removeItem=function(item){$scope.model.value[item]=false;};}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberGroupController",memberGroupController);function memberPickerController($scope,dialogService,entityResource,$log,iconHelper){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];var dialogOptions={multiPicker:false,entityType:"Member",section:"member",treeAlias:"member",filter:function(i){return i.metaData.isContainer==true;},filterCssClass:"not-allowed",callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}}};if($scope.model.config){angular.extend(dialogOptions,$scope.model.config);}
$scope.openMemberPicker=function(){var d=dialogService.memberPicker(dialogOptions);};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});}};$scope.clear=function(){$scope.renderModel=[];};$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,"Member").then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberPickerController",memberPickerController);function MultipleTextBoxController($scope){if(!$scope.model.value){$scope.model.value=[];}
if($scope.model.config.min>0){for(var i=0;i<$scope.model.config.min;i++){if((i+1)>$scope.model.value.length){$scope.model.value.push({value:""});}}}
$scope.add=function(){if($scope.model.config.max<=0||$scope.model.value.length<$scope.model.config.max){$scope.model.value.push({value:""});}};$scope.remove=function(index){var remainder=[];for(var x=0;x<$scope.model.value.length;x++){if(x!==index){remainder.push($scope.model.value[x]);}}
$scope.model.value=remainder;};}
angular.module("umbraco").controller("Umbraco.PropertyEditors.MultipleTextBoxController",MultipleTextBoxController);angular.module("umbraco").controller("Umbraco.PropertyEditors.RadioButtonsController",function($scope){if(angular.isObject($scope.model.config.items)){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:vals[i].value});}
newItems.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.config.items=newItems;}});function ReadOnlyValueController($rootScope,$scope,$filter){function formatDisplayValue(){if($scope.model.config&&angular.isArray($scope.model.config)&&$scope.model.config.length>0&&$scope.model.config[0]&&$scope.model.config.filter){if($scope.model.config.format){$scope.displayvalue=$filter($scope.model.config.filter)($scope.model.value,$scope.model.config.format);}else{$scope.displayvalue=$filter($scope.model.config.filter)($scope.model.value);}}else{$scope.displayvalue=$scope.model.value;}}
formatDisplayValue();$scope.$watch("model.value",function(newVal,oldVal){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){formatDisplayValue();}});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.ReadOnlyValueController",ReadOnlyValueController);angular.module("umbraco").controller("Umbraco.PropertyEditors.RelatedLinksController",function($rootScope,$scope,dialogService){if(!$scope.model.value){$scope.model.value=[];}
$scope.newCaption='';$scope.newLink='http://';$scope.newNewWindow=false;$scope.newInternal=null;$scope.newInternalName='';$scope.addExternal=true;$scope.currentEditLink=null;$scope.hasError=false;$scope.internal=function($event){$scope.currentEditLink=null;var d=dialogService.contentPicker({multipicker:false,callback:select});$event.preventDefault();};$scope.selectInternal=function($event,link){$scope.currentEditLink=link;var d=dialogService.contentPicker({multipicker:false,callback:select});$event.preventDefault();};$scope.edit=function(idx){for(var i=0;i<$scope.model.value.length;i++){$scope.model.value[i].edit=false;}
$scope.model.value[idx].edit=true;};$scope.saveEdit=function(idx){$scope.model.value[idx].title=$scope.model.value[idx].caption;$scope.model.value[idx].edit=false;};$scope.delete=function(idx){$scope.model.value.splice(idx,1);};$scope.add=function($event){if($scope.newCaption==""){$scope.hasError=true;}else{if($scope.addExternal){var newExtLink=new function(){this.caption=$scope.newCaption;this.link=$scope.newLink;this.newWindow=$scope.newNewWindow;this.edit=false;this.isInternal=false;this.type="external";this.title=$scope.newCaption;};$scope.model.value.push(newExtLink);}else{var newIntLink=new function(){this.caption=$scope.newCaption;this.link=$scope.newInternal;this.newWindow=$scope.newNewWindow;this.internal=$scope.newInternal;this.edit=false;this.isInternal=true;this.internalName=$scope.newInternalName;this.type="internal";this.title=$scope.newCaption;};$scope.model.value.push(newIntLink);}
$scope.newCaption='';$scope.newLink='http://';$scope.newNewWindow=false;$scope.newInternal=null;$scope.newInternalName='';}
$event.preventDefault();};$scope.switch=function($event){$scope.addExternal=!$scope.addExternal;$event.preventDefault();};$scope.switchLinkType=function($event,link){link.isInternal=!link.isInternal;link.type=link.isInternal?"internal":"external";if(!link.isInternal)
link.link=$scope.newLink;$event.preventDefault();};$scope.move=function(index,direction){var temp=$scope.model.value[index];$scope.model.value[index]=$scope.model.value[index+direction];$scope.model.value[index+direction]=temp;};$scope.sortableOptions={containment:'parent',cursor:'move',helper:function(e,ui){ui.children().each(function(){$(this).width($(this).width());});return ui;},items:'> tr',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedLinkUrl=ui.item.attr('data-link');var originalIndex=getElementIndexByUrl(movedLinkUrl);var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);}};function getElementIndexByUrl(url){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].link==url){return i;}}
return-1;}
function select(data){if($scope.currentEditLink!=null){$scope.currentEditLink.internal=data.id;$scope.currentEditLink.internalName=data.name;$scope.currentEditLink.link=data.id;}else{$scope.newInternal=data.id;$scope.newInternalName=data.name;}}});angular.module("umbraco").controller("Umbraco.PropertyEditors.RTEController",function($rootScope,$scope,$q,dialogService,$log,imageHelper,assetsService,$timeout,tinyMceService,angularHelper,stylesheetResource){$scope.isLoading=true;var d=new Date();var n=d.getTime();$scope.textAreaHtmlId=$scope.model.alias+"_"+n+"_rte";var alreadyDirty=false;function syncContent(editor){editor.save();angularHelper.safeApply($scope,function(){$scope.model.value=editor.getContent();});if(!alreadyDirty){var currForm=angularHelper.getCurrentForm($scope);currForm.$setDirty();alreadyDirty=true;}}
tinyMceService.configuration().then(function(tinyMceConfig){var validElements=tinyMceConfig.validElements;var extendedValidElements="@[id|class|style],-div[id|dir|class|align|style],ins[datetime|cite],-ul[class|style],-li[class|style]";var invalidElements=tinyMceConfig.inValidElements;var plugins=_.map(tinyMceConfig.plugins,function(plugin){if(plugin.useOnFrontend){return plugin.name;}}).join(" ");var editorConfig=$scope.model.config.editor;if(!editorConfig||angular.isString(editorConfig)){editorConfig=tinyMceService.defaultPrevalues();}
var toolbar=editorConfig.toolbar.join(" | ");var stylesheets=[];var styleFormats=[];var await=[];if(!editorConfig.maxImageSize&&editorConfig.maxImageSize!=0){editorConfig.maxImageSize=tinyMceService.defaultPrevalues().maxImageSize;}
if(typeof tinymce==="undefined"){await.push(assetsService.loadJs("lib/tinymce/tinymce.min.js",$scope));}
angular.forEach(editorConfig.stylesheets,function(val,key){stylesheets.push("../css/"+val+".css?"+new Date().getTime());await.push(stylesheetResource.getRulesByName(val).then(function(rules){angular.forEach(rules,function(rule){var r={};r.title=rule.name;if(rule.selector[0]=="."){r.inline="span";r.classes=rule.selector.substring(1);}
else if(rule.selector[0]=="#"){r.inline="span";r.attributes={id:rule.selector.substring(1)};}
else if(rule.selector[0]!="."&&rule.selector.indexOf(".")>-1){var split=rule.selector.split(".");r.block=split[0];r.classes=rule.selector.substring(rule.selector.indexOf(".")+1).replace("."," ");}
else if(rule.selector[0]!="#"&&rule.selector.indexOf("#")>-1){var split=rule.selector.split("#");r.block=split[0];r.classes=rule.selector.substring(rule.selector.indexOf("#")+1);}
else{r.block=rule.selector;}
styleFormats.push(r);});}));});var tinyMceEditor=null;$q.all(await).then(function(){var baseLineConfigObj={mode:"exact",skin:"umbraco",plugins:plugins,valid_elements:validElements,invalid_elements:invalidElements,extended_valid_elements:extendedValidElements,menubar:false,statusbar:false,height:editorConfig.dimensions.height,width:editorConfig.dimensions.width,maxImageSize:editorConfig.maxImageSize,toolbar:toolbar,content_css:stylesheets.join(','),relative_urls:false,style_formats:styleFormats};if(tinyMceConfig.customConfig){angular.extend(baseLineConfigObj,tinyMceConfig.customConfig);}
baseLineConfigObj.elements=$scope.textAreaHtmlId;baseLineConfigObj.setup=function(editor){tinyMceEditor=editor;editor.on('init',function(e){editor.getBody().setAttribute('spellcheck',true);});editor.on('blur',function(e){editor.save();angularHelper.safeApply($scope,function(){$scope.model.value=editor.getContent();});});editor.on('ExecCommand',function(e){syncContent(editor);});editor.on('KeyUp',function(e){syncContent(editor);});editor.on('SetContent',function(e){if(!e.initial){syncContent(editor);}});editor.on('ObjectResized',function(e){var qs="?width="+e.width+"px&height="+e.height+"px";var srcAttr=$(e.target).attr("src");var path=srcAttr.split("?")[0];$(e.target).attr("data-mce-src",path+qs);syncContent(editor);});tinyMceService.createMediaPicker(editor,$scope);tinyMceService.createInsertEmbeddedMedia(editor,$scope);tinyMceService.createInsertMacro(editor,$scope);};function loadTinyMce(){$timeout(function(){tinymce.DOM.events.domLoaded=true;tinymce.init(baseLineConfigObj);$scope.isLoading=false;},200,false);}
loadTinyMce();$scope.model.onValueChanged=function(newVal,oldVal){tinyMceEditor.setContent(newVal,{format:'raw'});tinyMceEditor.fire('LoadContent',null);};var unsubscribe=$scope.$on("formSubmitting",function(){$scope.model.value=tinyMceEditor.getContent();});$scope.$on('$destroy',function(){unsubscribe();});});});});angular.module("umbraco").controller("Umbraco.PrevalueEditors.RteController",function($scope,$timeout,$log,tinyMceService,stylesheetResource){var cfg=tinyMceService.defaultPrevalues();if($scope.model.value){if(angular.isString($scope.model.value)){$scope.model.value=cfg;}}else{$scope.model.value=cfg;}
if(!$scope.model.value.stylesheets){$scope.model.value.stylesheets=[];}
if(!$scope.model.value.toolbar){$scope.model.value.toolbar=[];}
if(!$scope.model.value.maxImageSize&&$scope.model.value.maxImageSize!=0){$scope.model.value.maxImageSize=cfg.maxImageSize;}
tinyMceService.configuration().then(function(config){$scope.tinyMceConfig=config;});stylesheetResource.getAll().then(function(stylesheets){$scope.stylesheets=stylesheets;});$scope.selected=function(cmd,alias,lookup){if(lookup&&angular.isArray(lookup)){cmd.selected=lookup.indexOf(alias)>=0;return cmd.selected;}
return false;};$scope.selectCommand=function(command){var index=$scope.model.value.toolbar.indexOf(command.frontEndCommand);if(command.selected&&index===-1){$scope.model.value.toolbar.push(command.frontEndCommand);}else if(index>=0){$scope.model.value.toolbar.splice(index,1);}};$scope.selectStylesheet=function(css){var index=$scope.model.value.stylesheets.indexOf(css.name);if(css.selected&&index===-1){$scope.model.value.stylesheets.push(css.name);}else if(index>=0){$scope.model.value.stylesheets.splice(index,1);}};$scope.$on("formSubmitting",function(ev,args){var commands=_.where($scope.tinyMceConfig.commands,{selected:true});$scope.model.value.toolbar=_.pluck(commands,"frontEndCommand");});});function sliderController($scope,$log,$element,assetsService,angularHelper){if(!$scope.model.config.orientation){$scope.model.config.orientation="horizontal";}
if(!$scope.model.config.initVal1){$scope.model.config.initVal1=0;}
else{$scope.model.config.initVal1=parseFloat($scope.model.config.initVal1);}
if(!$scope.model.config.initVal2){$scope.model.config.initVal2=0;}
else{$scope.model.config.initVal2=parseFloat($scope.model.config.initVal2);}
if(!$scope.model.config.minVal){$scope.model.config.minVal=0;}
else{$scope.model.config.minVal=parseFloat($scope.model.config.minVal);}
if(!$scope.model.config.maxVal){$scope.model.config.maxVal=100;}
else{$scope.model.config.maxVal=parseFloat($scope.model.config.maxVal);}
if(!$scope.model.config.step){$scope.model.config.step=1;}
else{$scope.model.config.step=parseFloat($scope.model.config.step);}
function createSlider(){var sliderVal=null;if($scope.model.config.enableRange==="1"){if(!$scope.model.value){var i1=parseFloat($scope.model.config.initVal1);var i2=parseFloat($scope.model.config.initVal2);sliderVal=[isNaN(i1)?$scope.model.config.minVal:(i1>=$scope.model.config.minVal?i1:$scope.model.config.minVal),isNaN(i2)?$scope.model.config.maxVal:(i2>i1?(i2<=$scope.model.config.maxVal?i2:$scope.model.config.maxVal):$scope.model.config.maxVal)];}
else{sliderVal=_.map($scope.model.value.split(','),function(item){return parseFloat(item);});}}
else{if($scope.model.value){sliderVal=parseFloat($scope.model.value);}
else{sliderVal=$scope.model.config.initVal1;}}
if(!$scope.model.value){setModelValueFromSlider(sliderVal);}
var slider=$element.find('.slider-item').slider({max:$scope.model.config.maxVal,min:$scope.model.config.minVal,orientation:$scope.model.config.orientation,selection:"after",step:$scope.model.config.step,tooltip:"show",value:sliderVal}).on('slideStop',function(){angularHelper.safeApply($scope,function(){setModelValueFromSlider(slider.getValue());});}).data('slider');}
function setModelValueFromSlider(sliderVal){if($scope.model.config.enableRange==="1"){$scope.model.value=sliderVal.join(",");}
else{$scope.model.value=sliderVal.toString();}}
assetsService.loadJs("lib/slider/js/bootstrap-slider.js").then(function(){createSlider();$scope.model.onValueChanged=function(newVal,oldVal){if(newVal!=oldVal){createSlider();}};});assetsService.loadCss("lib/slider/slider.css");}
angular.module("umbraco").controller("Umbraco.PropertyEditors.SliderController",sliderController);angular.module("umbraco").controller("Umbraco.PropertyEditors.TagsController",function($rootScope,$scope,$log,assetsService,umbRequestHelper,angularHelper,$timeout,$element){var $typeahead;$scope.isLoading=true;$scope.tagToAdd="";assetsService.loadJs("lib/typeahead-js/typeahead.bundle.min.js").then(function(){$scope.isLoading=false;if($scope.model.value){if(!$scope.model.config.storageType||$scope.model.config.storageType!=="Json"){if(!$scope.model.value){$scope.model.value=[];}
else{$scope.model.value=$scope.model.value.split(",");}}}
else{$scope.model.value=[];}
$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||($scope.model.value!=null&&$scope.model.value.length>0),errorMsg:"Value cannot be empty",errorKey:"required"};}
function addTag(tagToAdd){if(tagToAdd!=null&&tagToAdd.length>0){if($scope.model.value.indexOf(tagToAdd)<0){$scope.model.value.push(tagToAdd);$scope.propertyForm.tagCount.$setViewValue($scope.model.value.length);}}}
$scope.addTagOnEnter=function(e){var code=e.keyCode||e.which;if(code==13){if($element.find('.tags-'+$scope.model.alias).parent().find(".tt-dropdown-menu .tt-cursor").length===0){e.preventDefault();$scope.addTag();}}};$scope.addTag=function(){addTag($scope.tagToAdd);$scope.tagToAdd="";$typeahead.typeahead('val','');};$scope.removeTag=function(tag){var i=$scope.model.value.indexOf(tag);if(i>=0){$scope.model.value.splice(i,1);$scope.propertyForm.tagCount.$setViewValue($scope.model.value.length);}};$scope.model.onValueChanged=function(newVal,oldVal){$scope.model.value=newVal;if(!$scope.model.config.storageType||$scope.model.config.storageType!=="Json"){if(!$scope.model.value){$scope.model.value=[];}
else{$scope.model.value=$scope.model.value.split(",");}}};function dataTransform(list){var tagList=_.map(list,function(i){return{value:i.text};});return $.grep(tagList,function(tag){return($.inArray(tag.value,$scope.model.value)===-1);});}
function removeCurrentTagsFromSuggestions(suggestions){return $.grep(suggestions,function(suggestion){return($.inArray(suggestion.value,$scope.model.value)===-1);});}
var tagsHound=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),queryTokenizer:Bloodhound.tokenizers.whitespace,dupDetector:function(remoteMatch,localMatch){return(remoteMatch["value"]==localMatch["value"]);},prefetch:{url:umbRequestHelper.getApiUrl("tagsDataBaseUrl","GetTags",[{tagGroup:$scope.model.config.group}]),ttl:300000,filter:dataTransform},remote:{url:umbRequestHelper.getApiUrl("tagsDataBaseUrl","GetTags",[{tagGroup:$scope.model.config.group}]),filter:dataTransform}});tagsHound.initialize(true);$timeout(function(){$typeahead=$element.find('.tags-'+$scope.model.alias).typeahead({hint:false,highlight:true,cacheKey:new Date(),minLength:1},{name:$scope.model.config.group,displayKey:"value",source:function(query,cb){tagsHound.get(query,function(suggestions){cb(removeCurrentTagsFromSuggestions(suggestions));});},}).bind("typeahead:selected",function(obj,datum,name){angularHelper.safeApply($scope,function(){addTag(datum["value"]);$scope.tagToAdd="";$typeahead.typeahead('val','');});}).bind("typeahead:autocompleted",function(obj,datum,name){angularHelper.safeApply($scope,function(){addTag(datum["value"]);$scope.tagToAdd="";});}).bind("typeahead:opened",function(obj){});});$scope.$on('$destroy',function(){tagsHound.clearPrefetchCache();tagsHound.clearRemoteCache();$element.find('.tags-'+$scope.model.alias).typeahead('destroy');delete tagsHound;});});});angular.module('umbraco').controller("Umbraco.PropertyEditors.EmbeddedContentController",function($rootScope,$scope,$log){$scope.showForm=false;$scope.fakeData=[];$scope.create=function(){$scope.showForm=true;$scope.fakeData=angular.copy($scope.model.config.fields);};$scope.show=function(){$scope.showCode=true;};$scope.add=function(){$scope.showForm=false;if(!($scope.model.value instanceof Array)){$scope.model.value=[];}
$scope.model.value.push(angular.copy($scope.fakeData));$scope.fakeData=[];};});angular.module('umbraco').controller("Umbraco.PropertyEditors.UrlListController",function($rootScope,$scope,$filter){function formatDisplayValue(){$scope.renderModel=_.map($scope.model.value.split(","),function(item){return{url:item,urlTarget:($scope.config&&$scope.config.target)?$scope.config.target:"_blank"};});}
$scope.getUrl=function(valueUrl){if(valueUrl.indexOf("/")>=0){return valueUrl;}
return"#";};formatDisplayValue();$scope.model.onValueChanged=function(newVal,oldVal){formatDisplayValue();};});})();
;;;
app.config(function($routeProvider){var canRoute=function(isRequired){return{isAuthenticatedAndReady:function($q,userService,$route,assetsService,appState){var deferred=$q.defer();if(!$route.current.params.section&&($route.current.params.check===false||$route.current.params.check==="false")){deferred.resolve(true);return deferred.promise;}
userService.isAuthenticated().then(function(){assetsService._loadInitAssets().then(function(){var broadcast=appState.getGlobalState("isReady")!==true;userService.getCurrentUser({broadcastEvent:broadcast}).then(function(user){if(isRequired){if(user.allowedSections.indexOf($route.current.params.section)>-1){deferred.resolve(true);}else{deferred.reject({path:"/"+user.allowedSections[0]});}}
else{deferred.reject({path:"/"});}});});},function(){if(isRequired){deferred.reject({path:"/login/false"});}
else{deferred.resolve(true);}});return deferred.promise;}};};var doLogout=function(){return{isLoggedOut:function($q,userService){var deferred=$q.defer();userService.logout().then(function(){deferred.resolve(true);},function(){deferred.reject({path:"/login/false"});});return deferred.promise;}}}
$routeProvider.when('/login',{templateUrl:'views/common/login.html',resolve:canRoute(false)}).when('/login/:check',{templateUrl:'views/common/login.html',resolve:canRoute(false)}).when('/logout',{redirectTo:'/login/false',resolve:doLogout()}).when('/:section',{templateUrl:function(rp){if(rp.section.toLowerCase()==="default"||rp.section.toLowerCase()==="umbraco"||rp.section==="")
{rp.section="content";}
rp.url="dashboard.aspx?app="+rp.section;return'views/common/dashboard.html';},resolve:canRoute(true)}).when('/:section/framed/:url',{templateUrl:function(rp){if(!rp.url)
throw"A framed resource must have a url route parameter";return'views/common/legacy.html';},resolve:canRoute(true)}).when('/:section/:tree/:method',{templateUrl:function(rp){if(!rp.method)
return"views/common/dashboard.html";return'views/'+rp.tree+'/'+rp.method+'.html';},resolve:canRoute(true)}).when('/:section/:tree/:method/:id',{template:"<div ng-include='templateUrl'></div>",controller:function($scope,$route,$routeParams,treeService){if(!$routeParams.tree||!$routeParams.method){$scope.templateUrl="views/common/dashboard.html";}
var packageTreeFolder=treeService.getTreePackageFolder($routeParams.tree);if(packageTreeFolder){$scope.templateUrl=Umbraco.Sys.ServerVariables.umbracoSettings.appPluginsPath+"/"+packageTreeFolder+"/backoffice/"+$routeParams.tree+"/"+$routeParams.method+".html";}
else{$scope.templateUrl='views/'+$routeParams.tree+'/'+$routeParams.method+'.html';}},resolve:canRoute(true)}).otherwise({redirectTo:'/login'});}).config(function($locationProvider){});
;;;
app.run(['userService','$log','$rootScope','$location','navigationService','appState','editorState','fileManager','assetsService','eventsService','$cookies','$templateCache',function(userService,$log,$rootScope,$location,navigationService,appState,editorState,fileManager,assetsService,eventsService,$cookies,$templateCache){$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader("X-XSRF-TOKEN",$cookies["XSRF-TOKEN"]);}});eventsService.on("app.authenticated",function(evt,data){assetsService._loadInitAssets().then(function(){appState.setGlobalState("isReady",true);eventsService.emit("app.ready",data);});});$rootScope.$on('$routeChangeSuccess',function(event,current,previous){if(current.params.section){$rootScope.locationTitle=current.params.section+" - "+$location.$$host;}
else{$rootScope.locationTitle="Umbraco - "+$location.$$host;}
editorState.reset();fileManager.clearFiles();});$rootScope.$on('$routeChangeError',function(event,current,previous,rejection){event.preventDefault();$location.path(rejection.path).search(rejection.search);});if(Umbraco.Sys.ServerVariables.isDebuggingEnabled){$rootScope.$on('$viewContentLoaded',function(){$templateCache.removeAll();});}
navigationService.init();var touchDevice=/android|webos|iphone|ipad|ipod|blackberry|iemobile|touch/i.test(navigator.userAgent.toLowerCase());appState.setGlobalState("touchDevice",touchDevice);}]);
;;;
function actionDeleteRelationType(relationTypeId,relationTypeName){if(confirm('Are you sure you want to delete "'+relationTypeName+'"?')){$.ajax({type:"POST",url:"/umbraco/developer/RelationTypes/RelationTypesWebService.asmx/DeleteRelationType",data:"{ 'relationTypeId' : '"+relationTypeId+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(data){UmbClientMgr.mainTree().refreshTree('relationTypes');UmbClientMgr.appActions().openDashboard('developer');},error:function(data){}});}}
;;;
function actionNewRelationType(){UmbClientMgr.openModalWindow('developer/RelationTypes/NewRelationType.aspx','Create New RelationType',true,400,300,0,0);}
;;;